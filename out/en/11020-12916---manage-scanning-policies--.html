<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="no"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>**Manage Scanning Policies**</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d40bfcded91c.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="11020-12915---scan-images--.html" title="**Scan Images**"></link><link rel="next" href="11020-12920---manage-scanning-alerts--.html" title="**Manage Scanning Alerts**"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
				$(document).ready(function(){
				var lang = hljs.listLanguages();
				$('pre:not(.embedcode)').each(function(){
				if ($(this).data('language') && $.inArray($(this).data('language'), lang) > -1) {
					var code = hljs.highlight($(this).data('language'), $(this).text());
						$(this).empty().append(code.value).addClass("hljs").addClass(code.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="https://478h5m1yrfsa3bbe262u7muv-wpengine.netdna-ssl.com/wp-content/themes/sysdig/assets/images/logo-sysdig-black.svg" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="https://478h5m1yrfsa3bbe262u7muv-wpengine.netdna-ssl.com/wp-content/themes/sysdig/assets/images/logo-sysdig-black.svg" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><ul class="toc nav nav-site-sidebar"><li><a href="11020-12893-getting-started.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-51fd0fe9-8f5e-9ef1-511b-e7ac7bc034c9" data-permalink="11020-12893-getting-started.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Getting Started</a><ul></ul></li><li><a href="11020-12895-policy-events.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-f81df7d9-49bc-c129-25c1-538f24065287" data-permalink="11020-12895-policy-events.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Policy Events</a><ul><li><a href="11020-12896-configure-groupings-in-sysdig-secure.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5474d071-6c4d-d4d5-ec08-5880cea7bc97" data-permalink="11020-12896-configure-groupings-in-sysdig-secure.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Configure Groupings in Sysdig Secure</a><ul></ul></li><li><a href="11020-12897-identify-false-positives.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-18edc6fd-576c-b883-4f95-338239e1ea9a" data-permalink="11020-12897-identify-false-positives.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Identify False Positives</a><ul></ul></li><li><a href="11020-12899-event-forwarding.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-558ea33f-168d-bbb5-0c62-34c587351f8e" data-permalink="11020-12899-event-forwarding.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Event Forwarding</a><ul></ul></li><li><a href="11020-12900-kubernetes-audit-logging.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-01478946-aa02-fe5b-d28e-68c71020aac1" data-permalink="11020-12900-kubernetes-audit-logging.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Kubernetes Audit Logging</a><ul></ul></li></ul></li><li><a href="11020-12901-policies.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e3922a03-c2c2-6759-c71c-8dc4611ade9b" data-permalink="11020-12901-policies.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Policies</a><ul><li><a href="11020-12903-policy-creation-walkthrough.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-d42ef2c9-b2d9-ad09-adc2-c3b9511ccbde" data-permalink="11020-12903-policy-creation-walkthrough.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Policy Creation Walkthrough</a><ul></ul></li></ul></li><li><a href="11020-12904-commands-audit.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-659b609f-a499-28d5-3d26-a58b38dfd24b" data-permalink="11020-12904-commands-audit.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Commands Audit</a><ul></ul></li><li><a href="11020-12906-captures.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2f5bb2d3-0ec1-3344-966e-e97fe75edf2e" data-permalink="11020-12906-captures.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Captures</a><ul></ul></li><li><a href="11020-12907-image-scanning.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-d4e9a33a-67d6-9e42-c278-9f0af6a84fcb" data-permalink="11020-12907-image-scanning.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Image Scanning</a><ul><li><a href="11020-12909-global-whitelisting.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e60747f0-e181-ce37-b91b-6dffd93d9a0e" data-permalink="11020-12909-global-whitelisting.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Global Whitelisting</a><ul></ul></li><li><a href="11020-12910-empty-or-missing-topic.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-8be6d3fb-e895-2476-dc9a-7ba4a246ff68" data-permalink="11020-12910-empty-or-missing-topic.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Empty or missing topic</a></li><li><a href="11020-12911---image-scanning-and-vulnerability-management--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ec42cd90-0a32-d922-5541-3906277f03bc" data-permalink="11020-12911---image-scanning-and-vulnerability-management--.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> **Image Scanning and Vulnerability Management**</a><ul><li><a href="11020-12912---integrate-image-scanning-into-development-pipeline--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-c759bfb5-c565-4f18-72d7-a5789684d14b" data-permalink="11020-12912---integrate-image-scanning-into-development-pipeline--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Integrate Image Scanning into Development Pipeline**</a></li><li><a href="11020-12914---manage-registry-credentials--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-0cdf5df6-0c42-93d2-ecfb-41db27fb9b53" data-permalink="11020-12914---manage-registry-credentials--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Manage Registry Credentials**</a></li><li><a href="11020-12915---scan-images--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-8ef64ca6-53fb-4c76-00e6-7c40c9e7681b" data-permalink="11020-12915---scan-images--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Scan Images**</a></li><li><a href="11020-12916---manage-scanning-policies--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2c995d98-24ad-f299-18bc-a7b9f635473a" data-permalink="11020-12916---manage-scanning-policies--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Manage Scanning Policies**</a></li><li><a href="11020-12920---manage-scanning-alerts--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-dba5229a-a2fc-75b5-33d4-32e3aa41e9b0" data-permalink="11020-12920---manage-scanning-alerts--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Manage Scanning Alerts**</a></li><li><a href="11020-12922---review-scan-results--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-20860cb0-d60b-8d6d-7b2f-1e7b3de0d639" data-permalink="11020-12922---review-scan-results--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Review Scan Results**</a></li></ul></li></ul></li><li><a href="11020-12923-compliance.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1f4a153f-25e8-24ea-0496-353ee764e467" data-permalink="11020-12923-compliance.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Compliance</a><ul><li><a href="11020-12924---copy-of-compliance--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-7e6446a1-d7b5-4005-c601-6ef478b2a35f" data-permalink="11020-12924---copy-of-compliance--.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> **Copy of Compliance**</a><ul><li><a href="11020-12926---configure-compliance-tasks--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-b56311ce-82b4-7eda-49c6-336844cd8ad4" data-permalink="11020-12926---configure-compliance-tasks--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Configure Compliance Tasks**</a></li><li><a href="11020-12927---review-compliance-results--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-667cf16b-6199-b788-3b8d-613fea316d7f" data-permalink="11020-12927---review-compliance-results--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Review Compliance Results**</a></li><li><a href="11020-12928---use-compliance-dashboards-and-metrics--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-19256268-3996-1573-c1fc-5103f2ebbc2f" data-permalink="11020-12928---use-compliance-dashboards-and-metrics--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Use Compliance Dashboards and Metrics**</a></li></ul></li></ul></li><li><a href="11020-12930-documentation-feedback.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-91c2f2ab-e762-afaa-20fe-ae288892cbec" data-permalink="11020-12930-documentation-feedback.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Documentation Feedback</a><ul><li><a href="11020-12931-terms-of-use.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-725fd7a1-23b8-bd1f-b5a0-40543369033a" data-permalink="11020-12931-terms-of-use.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Terms of Use</a></li></ul></li></ul></aside><div class="site-content"><h1 class="publication-title">Sysdig Secure</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="11020-12915---scan-images--.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="11020-12920---manage-scanning-alerts--.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <span class="current-category">Sysdig Secure</span></li><li class="breadcrumb-link"><a href="11020-12907-image-scanning.html">Image Scanning</a></li><li class="breadcrumb-link"><a href="11020-12911---image-scanning-and-vulnerability-management--.html">**Image Scanning and Vulnerability Management**</a></li><li class="breadcrumb-node">**Manage Scanning Policies**</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-2c995d98-24ad-f299-18bc-a7b9f635473a" data-permalink="11020-12916---manage-scanning-policies--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae"><div class="titlepage"><div><div class="title"><h4 class="title">**Manage Scanning Policies**</h4></div></div></div><p>Image scanning policies define the scenarios in which:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The build process may be stopped, or</p></li><li class="listitem"><p>Administrators may be alerted to potential risks within container images.</p></li></ul></div><p>Each scanning policy is comprised of <span class="italic italic">rules</span> built of <span class="italic italic">gates</span> and <span class="italic italic">triggers</span>. Sysdig includes default policies that can be used to run scans as soon as <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/341770245/Manage+Registry+Credentials" target="_blank">registry credentials</a> have been configured. Users can create additional rules or policies from the available <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a" title="**Scanning Policy Gates and Triggers**">**Scanning Policy Gates and Triggers**</a>.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredPolicies" title="Preconfigured Policies">Preconfigured Policies </a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DefaultPolicy" title="Default Policy">Default Policy</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredCompliancePolicies" title="Preconfigured Compliance Policies">Preconfigured Compliance Policies</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ConfigurationPolicy-DockerfileBestPractices" title="Configuration Policy - Dockerfile Best Practices"> Configuration Policy - Dockerfile Best Practices </a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-NIST800-190" title="Audit Policy - NIST 800-190">Audit Policy - NIST 800-190</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-PCI" title="Audit Policy - PCI">Audit Policy - PCI </a> </p></li></ul></div></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CustomizedPolicies" title="Customized Policies">Customized Policies </a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CreateaNewPolicy" title="Create a New Policy">Create a New Policy</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-EditanExistingPolicy" title="Edit an Existing Policy">Edit an Existing Policy</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DeleteanExistingPolicy" title="Delete an Existing Policy">Delete an Existing Policy</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-WhitelistBlacklist" title="Whitelist/Blacklist">Whitelist/Blacklist</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ManagePolicyAssignments" title="Manage Policy Assignments">Manage Policy Assignments</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AssignaPolicy" title="Assign a Policy">Assign a Policy</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ExampleUseCases" title="Example Use Cases">Example Use Cases</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-UsingPriorities" title="Using Priorities">Using Priorities</a> </p></li></ul></div></li></ul></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredPolicies" class="bridgehead">Preconfigured Policies</h6><p>Sysdig provides four baseline policies that can be used as-is or as templates on which to build.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="700px"><tr><td><img src="image/uuid-77f54c9f-be26-0753-180e-80ae44084881-en.png" style="max-width: 700px; " alt="342327309.png"></img></td></tr></table></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DefaultPolicy" class="bridgehead">Default Policy</h5><p>This policy covers the most common image scanning cases, such as:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>checking for medium and high vulnerabilities</p></li><li class="listitem"><p>checking configuration items (e.g., ensuring health checks in an image or disallowing exposed ports)</p></li><li class="listitem"><p>validating that the vulnerability feed data is up-to-date.</p></li></ul></div><p>This policy is a basic catch-all that cannot be deleted. If no other policy assignments are made, the Default policy is automatically used.</p><div dir="ltr" class="tip tip"><h3 class="title">Tip</h3><p>You can edit the Default policy and edits will be retained even when you upgrade Sysdig Secure.</p></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredCompliancePolicies" class="bridgehead">Preconfigured Compliance Policies</h5><p>The three other preconfigured policies deal with compliance rules. To use them, you must <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ManagePolicyAssignments" title="Manage Policy Assignments">add them to the Policy Assignments list</a>.</p><div dir="ltr" class="warning warning"><h3 class="title">Warning</h3><p>If you want to edit a preconfigured compliance policy, create a new policy with matching rules and edit that.</p><p>Otherwise, your customizations may be overwritten and lost during Sysdig Secure upgrades.</p></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ConfigurationPolicy-DockerfileBestPractices" class="bridgehead">Configuration Policy - Dockerfile Best Practices</h5><p>This policy provides out-of-the-box rules around <a class="link" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/" target="_blank">Dockerfile best practices</a>, such as disallowing:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>secrets baked in as environment variables</p></li><li class="listitem"><p> <code class="code">root</code> user configuration</p></li><li class="listitem"><p>exposed ports</p></li><li class="listitem"><p>run instructions that include <code class="code">.yum</code> upgrades.</p></li></ul></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-NIST800-190" class="bridgehead">Audit Policy - NIST 800-190</h5><p>This policy maps <a class="link" href="https://www.nist.gov/publications/application-container-security-guide" target="_blank">NIST 800-190</a> controls to a Sysdig Secure scanning policy, such as disallowing:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>non-official node or Ruby packages</p></li><li class="listitem"><p> <code class="code">add</code> instructions in a Docker file</p></li><li class="listitem"><p>the use of base distributions outside of expected values.</p></li></ul></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-PCI" class="bridgehead">Audit Policy - PCI</h5><p>This policy maps <a class="link" href="https://www.pcisecuritystandards.org/pci_security/maintaining_payment_security" target="_blank">PCI</a> (Payment Card Industry) controls to a Sysdig Secure scanning policy, such as disallowing vulnerabilities or credentials to be included in the image.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CustomizedPolicies" class="bridgehead">Customized Policies</h6><p>Remember not to edit preconfigured compliance scanning policies directly. Create a matching policy and edit that one.</p><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CreateaNewPolicy" class="bridgehead">Create a New Policy</h5><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Scanning Policies</code> and click <code class="code">Add Policy(+)</code>.</p><p>The New Policy page is displayed.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d69ac321-d5f8-508a-83ea-e90d62e7dc33-en.png" style="max-width: 600px; " alt="342261767.png"></img></td></tr></table></div></li><li class="step"><p>Define a <code class="code">Name</code> and an optional <code class="code">Description </code>for the new policy.</p></li><li class="step"><p>Add a <code class="code">Rule</code>:</p><ol type="a" class="substeps"><li class="step"><p>Select the <code class="code">Gate</code> and then the <code class="code">Trigger </code>from the drop-down menus.</p></li><li class="step"><p>Configure relevant parameters. (Some triggers do not require parameters to be set.)</p><p>See <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a" title="**Scanning Policy Gates and Triggers**">**Scanning Policy Gates and Triggers**</a> for details on each option.</p><p>The example below uses the <code class="code"> <a class="link" href="">vulnerabilities</a> </code> gate with the <code class="code"> <a class="link" href="">package</a> </code> trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-9badfb97-ee63-9ade-7537-87f7da550081-en.png" style="max-width: 600px; " alt="341770259.png"></img></td></tr></table></div></li></ol></li></ol></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p> <span class="bold bold"><strong>Optional:</strong></span> Repeat step 5 to add rules as necessary.</p></li><li class="step"><p>Click <code class="code">Save</code>.</p></li></ol></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-EditanExistingPolicy" class="bridgehead">Edit an Existing Policy</h5><p>To edit an existing scanning policy:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Select the desired policy from the list.</p></li><li class="step"><p>Edit the policy rules as required, and click <code class="code">Save Policy</code>.</p></li></ol></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DeleteanExistingPolicy" class="bridgehead">Delete an Existing Policy</h5><p>To delete an existing scanning policy:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Select the desired policy from the list.</p></li><li class="step"><p>Click the <code class="code">Delete</code> (trash can) icon and choose <code class="code">Yes</code> to confirm the change.</p></li></ol></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-WhitelistBlacklist" class="bridgehead">Whitelist/Blacklist</h5><p>You can globally whitelist or blacklist particular images or CVEs, if desired. See <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc" title="**Whitelist | Blacklist CVEs and Images**">**Whitelist | Blacklist CVEs and Images**</a>. This does not affect the policy evaluation order.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ManagePolicyAssignments" class="bridgehead">Manage Policy Assignments</h6><p>Unless you use a very simple, single-policy approach to scanning, you will probably assign particular policies to particular registries, repos, or tags. Use the Policy Assignments page to do so.</p><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AssignaPolicy" class="bridgehead">Assign a Policy</h5><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <span class="bold bold"><strong> <code class="code">Scanning Policies</code> </strong></span> and choose <span class="bold bold"><strong> <code class="code">Policy Assignments</code> </strong></span>.</p><p>The previously defined assignments are listed in priority order.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 177px"><td><img src="image/uuid-cf1c7545-206f-c307-f983-8dcbc2dfddeb-en.png" style="max-width: 600px; max-height: 177px; " alt="342196241.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">+Add Policy Assignment</code>.</p><p>A new entry line appears at the top of the Assignment page. Enter the desired assignment details:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p> <span class="bold bold"><strong> <code class="code">Priority</code>: </strong></span>Priority is the order of evaluation against the assigned policy. Each new assignment is auto-placed at Priority 1. Once a policy assignment is created and saved, you can change its priority order by dragging it into a new position on the list. See also <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-UsingPriorities" title="Using Priorities">Using Priorities</a>.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Registry</code>:</strong></span>Any registry domain (e.g. quay.io). Wildcards are supported; an asterisk * specifies any registry.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Repository</code>:</strong></span>Any repository (typically = name of the image). Wildcards are supported; an asterisk * specifies any repository.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Tag</code>:</strong></span> Any tag. Wildcards are supported; an asterisk * specifies any tag.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Assigned Policy</code>:</strong></span> Name of policy to use for evaluation. Select from the drop-down menu.</p></li></ol></div></li><li class="step"><p>Click <code class="code">Save</code>.</p></li><li class="step"><p> <span class="bold bold"><strong>Optional: </strong></span>Reorganize the Priority order by clicking the drag handle (the four dots to the left of a line) and dragging the assignment to a different spot on the list.</p></li></ol></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ExampleUseCases" class="bridgehead">Example Use Cases</h5><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>To prevent developers from pulling unknown images from a Docker hub, you may want to design a rule for the <code class="code"> <a class="link" href="http://docker.io" target="_blank">docker.io</a> registry,</code> (including all repos and tags), and assign an appropriate policy. &lt;Which gate/ trigger/policuy checks for unknown images?&gt;</p><pre class="programlisting">
registry = docker.io repository = * tags = * assigned policy = ?</pre></li><li class="step"><p>Organizations commonly tag images as <code class="code">dev</code> or <code class="code">prod</code>. You can apply a tag assignment to <code class="code">dev</code> images by using wildcard.wildcard.dev.</p></li></ol></div><h5 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-UsingPriorities" class="bridgehead">Using Priorities</h5><p>When you use more than one scanning policy, the Anchore engine evaluates them in top-down order, starting from Priority 1 in the Policy Assignment list. The first policy assignment rule that matches an input image will be evaluated, and all subsequent rules ignored. Therefore, the priority order is important.</p><div dir="ltr" class="tip tip"><h3 class="title">Tip</h3><p>For example, imagine a list with two defined policy assignments:</p><p> <code class="code">Priority 1 Registry = <a class="link" href="http://quay.io" target="_blank">quay.io</a> Repository = sysdig/* </code> </p><p> <code class="code">Priority 2 Registry = <a class="link" href="http://quay.io" target="_blank">quay.io</a> Repository = sysdig/myrepo</code> </p><p>Since the first rule uses a wild card, the evaluation applies to all repos beginning with <code class="code">sysdig/</code> and will stop before evaluating <code class="code">sysdig/myrepo</code>.</p><p>Reverse the priority order to get the behavior you want.</p></div><p>There is a catch-all entry at the bottom of the Policy Assignment list that cannot be removed. It has the format :</p><pre class="programlisting">
registry = * repository = * tag = * assigned policy = default </pre><p> <code class="code"></code>(You can change the <code class="code">assigned policy</code>, but other fields cannot be edited.)</p><p>The purpose of this row is to ensure that any registries that do not fall under another policy evaluation will at least be evaluated against the system-configured Default policy.</p><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-d9882b5d-bb6f-bb77-986a-4f1de0b707cf" data-publication-date="" id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc"><div class="titlepage"><div><div class="title"><h5 class="title">**Whitelist | Blacklist CVEs and Images**</h5></div></div></div><p>Sysdig Secure allows users to define <span class="bold bold"><strong>CVEs and images as globally trusted or blacklisted.</strong></span> For example, a low-risk CVE can be globally approved to prevent it from impacting builds that include more critical fixes. Alternatively, specific images can be marked as globally approved or not to ensure they always/never pass a scan.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>Blacklist options for other entities, such as users, ports, packages, etc., are listed in <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a" title="**Scanning Policy Gates and Triggers**">**Scanning Policy Gates and Triggers**</a>.</p></div><h6 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-ReviewtheWhitelistedBlacklistedCVEsandImages" title="Review the Whitelisted/Blacklisted CVEs and Images"> Review the Whitelisted/Blacklisted CVEs and Images</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistaCVE" title="Whitelist a CVE">Whitelist a CVE</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistBlacklistanImage" title="Whitelist / Blacklist an Image"> Whitelist / Blacklist an Image</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-RemoveaCVEorImagefromtheWhitelistBlacklist" title="Remove a CVE or Image from the Whitelist/Blacklist"> Remove a CVE or Image from the Whitelist/Blacklist</a> </p></li></ul></div><h6 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-ReviewtheWhitelistedBlacklistedCVEsandImages" class="bridgehead">Review the Whitelisted/Blacklisted CVEs and Images</h6><p>To review the current list of whitelisted/blacklisted CVEs and images:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Click the <code class="code">Whitelists and Blacklists</code> button.</p></li><li class="step"><p>Choose the relevant tab (<span class="bold bold"><strong> <code class="code">CVE Whitelist</code> </strong></span>, <span class="bold bold"><strong> <code class="code">Global Trusted Images</code> </strong></span>, or <span class="bold bold"><strong> <code class="code">Global Blacklisted Images</code> </strong></span>).</p></li></ol></div><h6 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistaCVE" class="bridgehead">Whitelist a CVE</h6><p>There are two ways to whitelist a CVE - from the <code class="code">Scanning Policies</code> tab, and from the <code class="code">Repositories</code> tab.</p><p> <span class="bold bold"><strong>From the Scanning Policies Tab:</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-e022fb91-de24-7daf-6751-5d62773a2961-en.png" style="max-width: 600px; " alt="341966907.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">Whitelists and Blacklists</code>.</p></li><li class="step"><p>Click <code class="code">Add CVE,</code> add each CVE in a comma-separated list, then click <code class="code">Ok</code> to save.</p><p>Each item in the list must follow the CVE naming format (<code class="code">CVE-YEAR-ID</code>).</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="400px"><tr><td><img src="image/uuid-10f0337d-c6b9-4656-37de-5485d448cede-en.png" style="max-width: 400px; " alt="341966904.png"></img></td></tr></table></div></li></ol></div><p> <span class="bold bold"><strong>From the Repositories Tab</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, choose <code class="code">Repositories</code> and select one of the listed repos.</p><p>If there is a policy result related to a vulnerability, you can whitelist that CVE.</p></li><li class="step"><p>Click the <code class="code">More Options</code> (<span class="bold bold"><strong>+</strong></span>) icon beside the relevant CVE.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-07b957e8-93ab-22f4-662c-448b6a20be01-en.png" style="max-width: 600px; " alt="343638168.png"></img></td></tr></table></div></li><li class="step"><p>Select <code class="code">Add CVE to Global Whitelist</code>.</p></li></ol></div><p>The CVE will now be listed in the <code class="code">CVE Whitelist</code> tab.</p><h6 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistBlacklistanImage" class="bridgehead">Whitelist / Blacklist an Image</h6><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>If an image is added both in the "Trusted Images" list and in the "Blacklisted Image" list, the blacklisted one takes precedence.</p></div><p>There are two ways to whitelist or blacklist an image - from the <code class="code">Scanning Policies</code> tab, and from the <code class="code">Repositories</code> tab.</p><p> <span class="bold bold"><strong>From the <code class="code">Scanning Policies</code> tab:</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Click <code class="code">Whitelists and Blacklists</code>.</p></li><li class="step"><p>Choose the relevant tab (<span class="bold bold"><strong> <code class="code">Global Trusted Images</code> </strong></span>, or <span class="bold bold"><strong> <code class="code">Global Blacklisted Images</code> </strong></span>) and click the <code class="code">Add Image</code> button.</p></li><li class="step"><p>Add each image in a comma-separated list, then click <code class="code">Ok</code>.</p><p>A tag name must be valid ASCII and may contain lowercase and uppercase letters, digits, underscores, periods and dashes.</p><p>A tag name may not start with a period or a dash and may contain a maximum of 128 characters.</p></li></ol></div><p> <span class="bold bold"><strong>From the <code class="code">Repositories</code> tab:</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, choose the <code class="code">Repositories</code> tab.</p></li><li class="step"><p>Select the relevant repository from the list and open the relevant image.</p></li><li class="step"><p>Click the <code class="code">More Options</code> (<span class="bold bold"><strong>+</strong></span>) icon at the top of the page:</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 222px"><td><img src="image/uuid-b2b10bb1-1440-2a98-126b-b6c14c110ba1-en.png" style="max-width: 600px; max-height: 222px; " alt="343441579.png"></img></td></tr></table></div></li><li class="step"><p>Select either <code class="code">Add Image to Trusted Images</code> or <code class="code">Add Image to Blacklisted Images</code> as needed.</p></li></ol></div><p>The CVE will now be listed in the <code class="code">Global Trusted Images</code> tab or <code class="code">Global Blacklisted Images</code> tab, as appropriate.</p><h6 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-RemoveaCVEorImagefromtheWhitelistBlacklist" class="bridgehead">Remove a CVE or Image from the Whitelist/Blacklist</h6><p>To remove one or more CVEs or Images from the various lists:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Click <code class="code">Whitelists and Blacklists</code>.</p></li><li class="step"><p>Navigate to the relevant tab (<span class="bold bold"><strong> <code class="code">CVE Whitelist</code> </strong></span>, <span class="bold bold"><strong> <code class="code">Global Trusted Images</code> </strong></span>, or <span class="bold bold"><strong> <code class="code">Global Blacklisted Images</code> </strong></span>).</p></li><li class="step"><p>Click the <code class="code">Delete</code> <span class="bold bold"><strong>(X</strong></span>) icon beside the relevant CVEs/images</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 127px"><td><img src="image/uuid-bf17c1da-715c-86dd-1789-1aa071d14a9a-en.png" style="max-width: 600px; max-height: 127px; " alt="341966898.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">Save</code> .</p></li></ol></div></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-2b331aa9-b0bf-6ec6-8a68-06e060c80ee9" data-publication-date="" id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a"><div class="titlepage"><div><div class="title"><h5 class="title">**Scanning Policy Gates and Triggers**</h5></div></div></div><p>This document described the current <span class="bold bold"><strong>gates</strong></span> and their respective <span class="bold bold"><strong>triggers</strong></span>/parameters in Sysdig Secure scanning policies.</p><p>These policy gates, triggers, and parameters can be used to build in-depth scanning policies, from whitelisting / blacklisting partial file names to defining what login shells are approved.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>This information can also be obtained using the CLI:</p><pre class="programlisting">
user@host:~$ anchore-cli policy describe (--gate &lt;gatename&gt; (--trigger &lt;triggername))</pre></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Always" title="Always">Always</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-always" title="always">always</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Dockerfile" title="Dockerfile">Dockerfile</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-effective_user" title="effective_user">effective_user</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-exposed_ports" title="exposed_ports">exposed_ports</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-instruction" title="instruction">instruction</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-no_dockerfile_provided" title="no_dockerfile_provided">no_dockerfile_provided</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Files" title="Files">Files</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_match" title="content_regex_match">content_regex_match</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-name_match" title="name_match">name_match</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-suid_or_guid_set" title="suid_or_guid_set">suid_or_guid_set</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Licenses" title="Licenses">Licenses</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_exact_match" title="blacklist_exact_match">blacklist_exact_match</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_partial_match" title="blacklist_partial_match">blacklist_partial_match</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Metadata" title="Metadata">Metadata</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-attribute" title="attribute">attribute</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-NPMs" title="NPMs">NPMs</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklisted_name_version" title="blacklisted_name_version">blacklisted_name_version</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable" title="feed_data_unavailable">feed_data_unavailable</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_in_feed" title="newer_version_in_feed">newer_version_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-unknown_in_feeds" title="unknown_in_feeds">unknown_in_feeds</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_in_feeds" title="version_not_in_feeds">version_not_in_feeds</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Packages" title="Packages">Packages</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist" title="blacklist">blacklist</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-required_package" title="required_package">required_package</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-verify" title="verify">verify</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-PasswdFile" title="Passwd File">Passwd File</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_full_entry" title="blacklist_full_entry">blacklist_full_entry</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_groupids" title="blacklist_groupids">blacklist_groupids</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_shells" title="blacklist_shells">blacklist_shells</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_userids" title="blacklist_userids">blacklist_userids</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_usernames" title="blacklist_usernames">blacklist_usernames</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_not_available" title="content_not_available">content_not_available</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-RubyGems" title="Ruby Gems">Ruby Gems</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist1" title="blacklist">blacklist</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable1" title="feed_data_unavailable">feed_data_unavailable</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_found_in_feed" title="newer_version_found_in_feed"> newer_version_found_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-not_found_in_feed" title="not_found_in_feed">not_found_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_found_in_feed" title="version_not_found_in_feed">version_not_found_in_feed</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-SecretScans" title="Secret Scans">Secret Scans</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_checks" title="content_regex_checks">content_regex_checks</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Vulnerabilities" title="Vulnerabilities">Vulnerabilities</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-package" title="package">package</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-stale_feed_data" title="stale_feed_data">stale_feed_data</a> </p></li><li class="listitem"><p> <a class="link" href="11020-12916---manage-scanning-policies--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-vulnerability_data_unavailable" title="vulnerability_data_unavailable"> vulnerability_data_unavailable</a> </p></li></ul></div></li></ul></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Always" class="bridgehead">Always</h6><p>This gate provides users with a valuable testing resource, as it will be triggered unconditionally.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-always" class="bridgehead">always</h6><p>The <code class="code">always</code> trigger / gate will trip if it is present in the policy.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The Always gate is useful for testing whether the image blacklist/whitelist is working as expected.</p></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-95d4a924-546a-0dd1-e84c-b86717864a7a-en.png" style="max-width: 600px; " alt="342196463.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Dockerfile" class="bridgehead">Dockerfile</h6><p>The dockerfile gate reviews the contents of a dockerfile, or the assumed contents of a dockerfile if one is not provided, for exposed ports and instructions that do not follow best practices.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The gate assumes what the contents would be based on the docker layer history.</p></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-effective_user" class="bridgehead">effective_user</h6><p>This trigger reviews whether the effective user matches the user provided, and will fire based on the configured type.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">type</code> </p></td><td class="td"><p>Determines whether the user should be whitelisted or blacklisted.</p></td><td class="td"><p>N/A</p></td></tr><tr><td class="td"><p> <code class="code">user</code> </p></td><td class="td"><p>The name of the user.</p></td><td class="td"><p>root,docker</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-745ce90d-feec-952a-c93d-7119abd75fc5-en.png" style="max-width: 600px; " alt="342196460.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-exposed_ports" class="bridgehead">exposed_ports</h6><p>This trigger evaluates the set of exposed ports to determine whether they should be whitelisted or blacklisted.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">actual_dockerfile_only</code> </p></td><td class="td"><p>Defines whether the evaluation should skip inferred or guessed dockerfiles, and only evaluate user-provided dockerfiles. The default value is <code class="code">false</code>.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">ports</code> </p></td><td class="td"><p>A comma-separated list of port numbers.</p></td><td class="td"><p>80,8080,8088</p></td></tr><tr><td class="td"><p> <code class="code">type</code> </p></td><td class="td"><p>Defines whether the ports should be whitelisted or blacklisted.</p></td><td class="td"><p>N/A</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 250px"><td><img src="image/uuid-ef50bc39-5dc7-f679-74d5-907ac369e0e2-en.png" style="max-width: 600px; max-height: 250px; " alt="342196457.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-instruction" class="bridgehead">instruction</h6><p>This trigger evaluates whether any directives / instructions in the list match the conditions in the dockerfile.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">actual_dockerfile_only</code> </p></td><td class="td"><p>Defines whether the evaluation should skip inferred or guessed dockerfiles, and only evaluate user-provided dockerfiles. The default value is <code class="code">false</code>.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>The type of check to perform.</p></td><td class="td"><p>=</p></td></tr><tr><td class="td"><p> <code class="code">instruction</code> </p></td><td class="td"><p>The dockerfile instruction to check.</p></td><td class="td"><p>FROM</p></td></tr><tr><td class="td"><p> <code class="code">value</code> </p></td><td class="td"><p>The value to check the dockerfile instruction against.</p></td><td class="td"><p>scratch</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-04248785-c9cb-abc7-c887-0af96600cada-en.png" style="max-width: 600px; " alt="342196454.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-no_dockerfile_provided" class="bridgehead">no_dockerfile_provided</h6><p>This trigger will trip if there is no dockerfile supplied with the image. No parameters are required for this trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-5fc18f7d-5c8a-0414-690c-abbf0ef0d916-en.png" style="max-width: 600px; " alt="342196451.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Files" class="bridgehead">Files</h6><p>The Files gate reviews files within the analyzed image. This evaluation covers file content, names, and filesystem attributes.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_match" class="bridgehead">content_regex_match</h6><p>This trigger is tripped for each file where a match has been found using the configured regex in the <code class="code">analyzer_config.yaml</code> <code class="code">content_search</code> section.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>For more information regarding the regex values, refer to the <code class="code">analyzer_config.yaml</code> file.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">regex_name</code> </p></td><td class="td"><p>The regex string that appears in the <code class="code">FILECHECK_CONTENTMATCH</code> analyzer parameter.</p></td><td class="td"><p>.*password.*</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-56b12c39-36af-0ee5-b8f0-03f1379e6824-en.png" style="max-width: 600px; " alt="342196448.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-name_match" class="bridgehead">name_match</h6><p>This trigger is tripped if the name of a file in the container matches the provided regex.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>This trigger has a performance impact on policy evaluation.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">regex</code> </p></td><td class="td"><p>The regex to search for.</p></td><td class="td"><p>.*\.pem</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0078968e-2da9-07d9-9d5e-d379786c2f7b-en.png" style="max-width: 600px; " alt="342196445.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-suid_or_guid_set" class="bridgehead">suid_or_guid_set</h6><p>This trigger is tripped for each file that has a set-user identification (SUID) or set-group identification (SGID) configured. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-581b7b6b-c2d8-040f-7359-c54ffe0b5608-en.png" style="max-width: 600px; " alt="342196442.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Licenses" class="bridgehead">Licenses</h6><p>This gate is used to review software licenses found in the container image, to ensure, for example, that packages that violate internal company policy are not being used.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_exact_match" class="bridgehead">blacklist_exact_match</h6><p>This trigger will be tripped if the image contains packages distributed under the exact license specified.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">licenses</code> </p></td><td class="td"><p>A comma-separated list of license names to blacklist.</p></td><td class="td"><p>GPLv2+,GPL-3+,BSD-2-clause</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-1cef9d9c-4a9b-64cd-bbdc-689489c0a7c8-en.png" style="max-width: 600px; " alt="342196439.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_partial_match" class="bridgehead">blacklist_partial_match</h6><p>This trigger will be tripped if the image contains packages distributed under a license that includes the partial strings provided.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">licenses</code> </p></td><td class="td"><p>A comma-separated list of strings to blacklist for licenses.</p></td><td class="td"><p>LGPL,BSD</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-e08f734a-e8ef-1743-eef5-e15e6098375b-en.png" style="max-width: 600px; " alt="342196436.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Metadata" class="bridgehead">Metadata</h6><p>This gate reviews image metadata, including the size, operating system, and architecture.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-attribute" class="bridgehead">attribute</h6><p>The attribute trigger is tripped if a named image metadata value matches the given condition.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">attribute</code> </p></td><td class="td"><p>The attribute name to check.</p></td><td class="td"><p>size</p></td></tr><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>The operation to perform for the evaluation.</p></td><td class="td"><p>&gt;</p></td></tr><tr><td class="td"><p> <code class="code">value</code> </p></td><td class="td"><p>The value used for the evaluation.</p></td><td class="td"><p>1073741824</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-807afe45-e133-ee27-231b-6eae9260a3e3-en.png" style="max-width: 600px; " alt="342196433.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-NPMs" class="bridgehead">NPMs</h6><p>The NPMs gate reviews any images that have <a class="link" href="https://docs.npmjs.com/cli/npm" target="_blank">NPM</a> packages installed.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklisted_name_version" class="bridgehead">blacklisted_name_version</h6><p>This trigger is tripped if the evaluated image has an NPM package installed that has been blacklisted, either by name or optionally by name and version.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the blacklisted NPM package.</p></td><td class="td"><p>time_diff</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The specific version of the NPM package to blacklist.</p></td><td class="td"><p>0.2.9</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-6c4f1ff8-fd1c-a671-48b7-b20744335639-en.png" style="max-width: 600px; " alt="342196430.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable" class="bridgehead">feed_data_unavailable</h6><p>This trigger is tripped if the engine does not have access to the NPM data feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-85d6a16e-aa84-71fb-8f48-7fb83daf76a7-en.png" style="max-width: 600px; " alt="342196427.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_in_feed" class="bridgehead">newer_version_in_feed</h6><p>This trigger is tripped if the NPM data feed lists a newer version of the package. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-b0ed070c-e70f-248a-b020-6fc985bce929-en.png" style="max-width: 600px; " alt="342196424.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-unknown_in_feeds" class="bridgehead">unknown_in_feeds</h6><p>This trigger is tripped if the NPM installed is not in the official NPM database. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-18beb41f-be18-63d9-1abd-29ced2ae8e35-en.png" style="max-width: 600px; " alt="342196418.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_in_feeds" class="bridgehead">version_not_in_feeds</h6><p>This trigger is tripped if the NPM version is not listed as a valid version in the official NPM feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7fada5cc-fa05-be8d-60a2-7e14587326ec-en.png" style="max-width: 600px; " alt="342196415.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Packages" class="bridgehead">Packages</h6><p>The Packages gate reviews all packages within the image, verifying names, versions, and whitelisted / blacklisted packages.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist" class="bridgehead">blacklist</h6><p>This trigger is tripped if the image contains packages that have been blacklisted by either name, or name and version.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of blacklisted package/s.</p></td><td class="td"><p>openssh-server</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The exact version of the package that should be blacklisted.</p></td><td class="td"><p>1.0.1</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d57f3d6d-fa0f-caa3-0f77-fcf3e247eacd-en.png" style="max-width: 600px; " alt="342196412.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-required_package" class="bridgehead">required_package</h6><p>The <code class="code">required_package</code> trigger is tripped if the specified package / version is not found in the image.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the required package.</p></td><td class="td"><p>libssl</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The required package version.</p></td><td class="td"><p>1.10.3rc3</p></td></tr><tr><td class="td"><p> <code class="code">version_match_type</code> </p></td><td class="td"><p>Defines whether the trigger should require the exact package and version (exact), or just a version of the package (minimum). This is only relevant if the version is defined.</p></td><td class="td"><p>exact</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7ebe4e0e-6a2a-cd28-4324-b34948a1049e-en.png" style="max-width: 600px; " alt="342196409.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-verify" class="bridgehead">verify</h6><p>This trigger reviews the package integrity against the package database in the image, and is tripped for change or removal of content in either all or a defined list of directories provided.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>Defines whether the check should focus on missing packages, changed packages, or all.</p></td><td class="td"><p>changed</p></td></tr><tr><td class="td"><p> <code class="code">only_directories</code> </p></td><td class="td"><p>Defines the list of directories the check should be limited to.</p></td><td class="td"><p>/usr,/var/lib</p></td></tr><tr><td class="td"><p> <code class="code">only_packages</code> </p></td><td class="td"><p>Defines the list of packages that should be verified.</p></td><td class="td"><p>libssl,openssl</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d63dcd2c-a625-1f33-f552-6c20edd6c367-en.png" style="max-width: 600px; " alt="342196406.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-PasswdFile" class="bridgehead">Passwd File</h6><p>This gate reviews <code class="code">/etc/passwd</code> for blacklisted users, groups, and shells.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_full_entry" class="bridgehead">blacklist_full_entry</h6><p>This trigger trips if the whole password is found in the <code class="code">/etc/password</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">entry</code> </p></td><td class="td"><p>The full entry to match in <code class="code">/etc/passwd</code>.</p></td><td class="td"><p>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-9084ffef-adbc-ee51-031a-73441a629c92-en.png" style="max-width: 600px; " alt="342196481.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_groupids" class="bridgehead">blacklist_groupids</h6><p>This trigger is tripped if the designated group id/s are found in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">group_ids</code> </p></td><td class="td"><p>A numeric, comma separated list of group ids that will cause the trigger to trip.</p></td><td class="td"><p>999,20</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-180ccfac-484c-b0fb-e937-bf203a6b45b3-en.png" style="max-width: 600px; " alt="342196478.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_shells" class="bridgehead">blacklist_shells</h6><p>This trigger will trip if a designated login shell is found under any user in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">shells</code> </p></td><td class="td"><p>The list of shell commands to blacklist.</p></td><td class="td"><p>/bin/bash,/bin/zsh</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-95f842b5-74bf-f177-979a-4aad4d2e3b3e-en.png" style="max-width: 600px; " alt="342196475.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_userids" class="bridgehead">blacklist_userids</h6><p>This trigger will be tripped if the specified user ID is present in /<code class="code">etc/passwd</code>.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">user_ids</code> </p></td><td class="td"><p>The numerical, comma-separated list of user IDs to blacklist.</p></td><td class="td"><p>0,1</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-8f2836a4-ab10-431f-b7a7-72e93d435392-en.png" style="max-width: 600px; " alt="342196472.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_usernames" class="bridgehead">blacklist_usernames</h6><p>The <code class="code">blacklist_usernames</code> trigger will trip if the specified username is found in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">user_names</code> </p></td><td class="td"><p>A comma-separated list of usernames to blacklist.</p></td><td class="td"><p>daemon,ftp</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-83666e00-67cb-4a7c-f43a-724628eb8079-en.png" style="max-width: 600px; " alt="342196469.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_not_available" class="bridgehead">content_not_available</h6><p>The <code class="code">content_not_available</code> trigger will trip if the <code class="code">/etc/passwd</code> file is not present in the image. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-149246aa-2fa8-74e0-3448-8fb86d5117f7-en.png" style="max-width: 600px; " alt="342196466.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-RubyGems" class="bridgehead">Ruby Gems</h6><p>The Ruby Gems gate ensures that developers are using official packages from the official GEM database, and are not using versions of packages that are no longer supported.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist1" class="bridgehead">blacklist</h6><p>The <code class="code">blacklist</code> trigger trips if a GEM package that matches the configured name and version is found in the evaluated image.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the gem.</p></td><td class="td"><p>time_diff</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The version of the gem to blacklist.</p></td><td class="td"><p>0.2.9</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-6b9fd69f-a720-3ef0-aa86-6620cba90025-en.png" style="max-width: 600px; " alt="342196496.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable1" class="bridgehead">feed_data_unavailable</h6><p>This trigger will trip if Sysdig does not have access to the GEM data feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ee8523d6-f1b3-e411-9298-d547caf60396-en.png" style="max-width: 600px; " alt="342196493.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_found_in_feed" class="bridgehead">newer_version_found_in_feed</h6><p>This trigger will trip if an installed GEM package is not the latest version. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-4b52bc8c-5cc9-0d2a-d7bb-d3aafd3fa85f-en.png" style="max-width: 600px; " alt="342196490.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-not_found_in_feed" class="bridgehead">not_found_in_feed</h6><p>This trigger will trip if an installed GEM is not in the official GEM database. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ec5aa454-1dcf-6e18-8837-5c0a81b9a565-en.png" style="max-width: 600px; " alt="342196487.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_found_in_feed" class="bridgehead">version_not_found_in_feed</h6><p>This trigger will trip if the GEM is not listed in the official GEM feed as a valid / supported version. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0c9bd2e4-b0cb-4169-3dd8-8a921bd299c9-en.png" style="max-width: 600px; " alt="342196484.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-SecretScans" class="bridgehead">Secret Scans</h6><p>Secret scans determine, based on configured regex, whether secrets that could be available if an image was compromised have been baked into the image.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_checks" class="bridgehead">content_regex_checks</h6><p>The <code class="code">content_regex_checks</code> trigger trips if the content search analyzer finds a match with the configured and named regexes. Matches are filtered by the <code class="code">content_regex_name</code>, and the <code class="code">filename_regex</code>, if either are set.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The <code class="code">content_regex_name</code> should be a value from the secret_search section of <code class="code">analyzer_config.yaml</code>.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">content_regex_name</code> </p></td><td class="td"><p>The name of the variable / content. If found in the image, this should trip the trigger.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The names available by default are <code class="code">AWS_ACCESS_KEY</code>, <code class="code">AWS_SECRET_KEY</code>, <code class="code">PRIV_KEY</code>, <code class="code">DOCKER_AUTH</code>, and <code class="code">API_KEY</code>.</p></div></td><td class="td"><p>AWS_ACCESS_KEY</p></td></tr><tr><td class="td"><p> <code class="code">filename_regex</code> </p></td><td class="td"><p>Filters the files that should be analyzed for the presence of the <code class="code">content_regex_name</code>.</p></td><td class="td"><p>/etc/.*</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-358de109-329d-0289-f1cd-514b496bb380-en.png" style="max-width: 600px; " alt="342196499.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Vulnerabilities" class="bridgehead">Vulnerabilities</h6><p>CVE / vulnerability checks can be used to ensure the included packages don't have vulnerabilities above a set level, are older than a designated period, or if data is unavailable.</p><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-package" class="bridgehead">package</h6><p>The package trigger is tripped if a vulnerability in an image matches the configured comparison criteria. The table below outlines the available parameters and criteria:</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">fix_available</code> </p></td><td class="td"><p>If present, the fix availability for the vulnerability record must match the value of the parameter.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">package_type</code> </p></td><td class="td"><p>The specific type of package.</p></td><td class="td"><p>all</p></td></tr><tr><td class="td"><p> <code class="code">severity</code> </p></td><td class="td"><p>The vulnerability severity.</p></td><td class="td"><p>high</p></td></tr><tr><td class="td"><p> <code class="code">severity_comparison</code> </p></td><td class="td"><p>The type of comparison to perform for the security evaluation.</p></td><td class="td"><p>&gt;</p></td></tr><tr><td class="td"><p> <code class="code">vendor_only</code> </p></td><td class="td"><p>If true, an available fix for this CVE must not be explicitly marked as "Won't be addressed by the vendor".</p></td><td class="td"><p>true</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-19be8723-5fd0-245a-5252-69a58642aa83-en.png" style="max-width: 600px; " alt="342196502.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-stale_feed_data" class="bridgehead">stale_feed_data</h6><p>The <code class="code">stale_feed_data</code> trigger will be tripped if the CVE data is older than the window specified.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">max_days_since_sync</code> </p></td><td class="td"><p>Determines how old in days sync data can be before the trigger is tripped.</p></td><td class="td"><p>10</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-5458ae20-5dbd-e997-3f95-67daf88ed5fb-en.png" style="max-width: 600px; " alt="342196505.png"></img></td></tr></table></div><h6 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-vulnerability_data_unavailable" class="bridgehead">vulnerability_data_unavailable</h6><p>If no vulnerability data is available, the <code class="code">vulnerability_data_unavailable</code> trigger will trip. No parameters are required for this trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 175px"><td><img src="image/uuid-f1d69621-01ba-2178-21e3-955bfa26dafc-en.png" style="max-width: 600px; max-height: 175px; " alt="342196508.png"></img></td></tr></table></div></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae">**Manage Scanning Policies**</a></li><li><a href="#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc">**Whitelist | Blacklist CVEs and Images**</a></li><li><a href="#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a">**Scanning Policy Gates and Triggers**</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="11020-12915---scan-images--.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="11020-12920---manage-scanning-alerts--.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
