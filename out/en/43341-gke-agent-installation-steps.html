<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="no"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>GKE Agent Installation Steps</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d6593bb1e613.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="43329-kubernetes-agent-installation-steps.html#UUID-d41b3f19-62b8-1875-8309-85cf7d9fe133_UUID-b83dbad6-3ce5-73de-9e4c-68bfbcda28f2" title="Additional Options"></link><link rel="next" href="43341-gke-agent-installation-steps.html#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-e6e09fd0-4d0b-674a-a552-de9149817ed6" title="Preparation"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
			$(document).ready(function() {
				/**
				 * @type {array}
				 */
				var supported = hljs.listLanguages();

				$('pre:not(.embedcode)').each(function() {
					/**
					 * @type {string}
					 */
					var language = $(this).data('language');

					if (language === 'plaintext' || language === 'text') {
						$(this).addClass(language).addClass('hljs');
						return true;
					}

					if (language && $.inArray(language, supported) > -1) {
						var c = hljs.highlight(language, $(this).text());
						$(this)
							.empty()
							.append(c.value)
							.addClass("hljs")
							.addClass(c.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><ul class="toc nav nav-site-sidebar"><li><a href="43019-sysdig-platform.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2aec11a7-27eb-167a-dfc2-d868c58604cd" data-permalink="43019-sysdig-platform.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Sysdig Platform</a><ul><li><a href="43026-on-premises-deployments.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-3967fd02-70a8-134b-394b-cace7214ff6d" data-permalink="43026-on-premises-deployments.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> On-Premises Deployments</a><ul><li><a href="43027-architecture---system-requirements.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-dec254a6-b961-0e73-3f01-20f689cf90e3" data-permalink="43027-architecture---system-requirements.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Architecture &amp; System Requirements</a></li><li><a href="43049-on-premises-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-db1188d3-a7ec-15df-c6cf-67e07a21b18b" data-permalink="43049-on-premises-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">On-Premises Installation</a></li><li><a href="43140-on-premises-upgrades.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5d758c36-dfff-2452-850d-9ed2a4371f81" data-permalink="43140-on-premises-upgrades.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">On-Premises Upgrades</a></li><li><a href="43209-find-the-super-admin-credentials-and-api-token.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-8dab9961-ec84-3db6-d190-6869ea677fc0" data-permalink="43209-find-the-super-admin-credentials-and-api-token.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Find the Super Admin Credentials and API Token</a></li><li><a href="43212-upgrade-an-on-premises-license.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-7887f7e8-616a-7c82-1e15-4faca9d5c58f" data-permalink="43212-upgrade-an-on-premises-license.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Upgrade an On-Premises License</a></li><li><a href="43217-securing-elasticsearch.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-98444088-953d-f9e0-cccd-ae3d2cabdc82" data-permalink="43217-securing-elasticsearch.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Securing Elasticsearch</a></li><li><a href="43222-securing-cassandra.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-d6bd8eba-9fca-4113-e123-10a2f1a3a374" data-permalink="43222-securing-cassandra.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Securing Cassandra</a></li><li><a href="43230-authentication-and-authorization--on-prem-options-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-648140d5-4cd3-49eb-c672-21e00ae3296c" data-permalink="43230-authentication-and-authorization--on-prem-options-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Authentication and Authorization (On-Prem Options)</a></li></ul></li><li><a href="43297-sysdig-agent.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2b34ba9d-6b45-4d57-a133-ae54d956ee58" data-permalink="43297-sysdig-agent.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Sysdig Agent</a><ul><li><a href="43298-host-requirements-for-agent-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-cc64bfae-70f3-b2d6-42d6-cf84ccf5abaf" data-permalink="43298-host-requirements-for-agent-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Host Requirements for Agent Installation</a></li><li><a href="43317-agent-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ef0cd1a8-cec3-1ed9-65b7-d2b61ce9d78f" data-permalink="43317-agent-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Installation</a></li><li><a href="43391-agent-configuration.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-07369059-d819-881f-183c-902f87b1b917" data-permalink="43391-agent-configuration.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Configuration</a></li><li><a href="43450-agent-upgrade.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-551eb1f0-de5e-9917-527e-ed2d7183b2b5" data-permalink="43450-agent-upgrade.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Upgrade</a></li><li><a href="43457---agent-stop---start---disable---remove.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-3031a485-9dec-0547-24e6-5f1e9967311f" data-permalink="43457---agent-stop---start---disable---remove.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Agent Stop | Start | Disable | Remove</a></li><li><a href="43467-agent-uninstall.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-3ccccaf4-45c2-3331-6fad-0829e683559c" data-permalink="43467-agent-uninstall.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Uninstall</a></li><li><a href="43470-troubleshooting-agent-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-442c725a-6fb0-c992-9d42-1e253ac3d09d" data-permalink="43470-troubleshooting-agent-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Troubleshooting Agent Installation</a></li></ul></li><li><a href="43478-administration-settings.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1fced76a-c05c-a3dd-6965-ac6271a0c4b0" data-permalink="43478-administration-settings.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Administration Settings</a><ul><li><a href="43481-user-profile-and-password.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-68bae3d5-4e67-564d-a56f-36849de2841e" data-permalink="43481-user-profile-and-password.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">User Profile and Password</a></li><li><a href="43489-user-and-team-administration.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-00849bf9-2afa-6f2d-7293-ccb78c36cded" data-permalink="43489-user-and-team-administration.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">User and Team Administration</a></li><li><a href="43512-notifications-management.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-53d9d5a5-68f8-e49a-3dd2-ec0444ad3597" data-permalink="43512-notifications-management.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Notifications Management</a></li><li><a href="43548-aws--integrate-aws-account-and-cloudwatch-metrics--optional-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5c2df7a4-a53f-28fd-1303-29a41a587a6f" data-permalink="43548-aws--integrate-aws-account-and-cloudwatch-metrics--optional-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">AWS: Integrate AWS Account and CloudWatch Metrics (Optional)</a></li><li><a href="43563-storage--configure-aws-capture-file-storage--optional-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-bdc495d5-e851-5fb6-ed62-07eb12e45024" data-permalink="43563-storage--configure-aws-capture-file-storage--optional-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Storage: Configure AWS Capture File Storage (Optional)</a></li><li><a href="43568-find-your-customer-number.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-7e5c73de-e0be-9643-6660-81ee98d1dee6" data-permalink="43568-find-your-customer-number.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Find Your Customer Number</a></li><li><a href="43569-agent-installation--overview-and-key.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-8abc0bd0-5c58-5ddf-3912-b84f3e85b884" data-permalink="43569-agent-installation--overview-and-key.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Installation: Overview and Key</a></li><li><a href="43571-subscription--change-number-of-licensed-agents.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-aa6b5487-52a8-155d-a66f-bb4123d2a4fe" data-permalink="43571-subscription--change-number-of-licensed-agents.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Subscription: Change Number of Licensed Agents</a></li><li><a href="43579-authentication-and-authorization--saas-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a01b3e9a-2bed-30ad-b321-61f47790c80e" data-permalink="43579-authentication-and-authorization--saas-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Authentication and Authorization (SaaS)</a></li></ul></li><li><a href="43623-get-help---using-sysdig-support.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-cfa5bd5d-97db-98f6-7a2f-e76376c865d7" data-permalink="43623-get-help---using-sysdig-support.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Get Help | Using Sysdig Support</a><ul><li><a href="43624-self-help.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2a9e92b7-a64a-9fe3-9ee7-cc7e463c590a" data-permalink="43624-self-help.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Self-Help</a></li><li><a href="43638-contact-support.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-716a9a89-2ea4-0e43-8643-902620732467" data-permalink="43638-contact-support.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Contact Support</a></li><li><a href="43658-terms-of-use.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-8f7aed46-3390-e0a1-5227-8b693b2c9acb" data-permalink="43658-terms-of-use.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Terms of Use</a></li></ul></li></ul></li></ul></aside><div class="site-content"><h1 class="publication-title">Sysdig Platform</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="43329-kubernetes-agent-installation-steps.html#UUID-d41b3f19-62b8-1875-8309-85cf7d9fe133_UUID-b83dbad6-3ce5-73de-9e4c-68bfbcda28f2">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="43341-gke-agent-installation-steps.html#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-e6e09fd0-4d0b-674a-a552-de9149817ed6">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <span class="current-category">Sysdig Platform</span></li><li class="breadcrumb-link"><a href="43019-sysdig-platform.html">Sysdig Platform</a></li><li class="breadcrumb-link"><a href="43297-sysdig-agent.html">Sysdig Agent</a></li><li class="breadcrumb-link"><a href="43317-agent-installation.html">Agent Installation</a></li><li class="breadcrumb-link"><a href="43318-agent-install--kubernetes---gke---openshift---ibm.html">Agent Install: Kubernetes | GKE | OpenShift | IBM</a></li><li class="breadcrumb-node">GKE Agent Installation Steps</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-36b2c41a-9d43-194a-801e-992a77456505" data-permalink="43341-gke-agent-installation-steps.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e"><div class="titlepage"><div><div class="title"><h1 class="title" style="clear: both">GKE Agent Installation Steps</h1></div></div></div><p> <a class="link" href="https://cloud.google.com/kubernetes-engine/" target="_blank">Google Kubernetes Engine (GKE)</a> is a managed environment for running Kubernetes in Google Cloud, in order to deploy containerized applications. As of <span class="bold bold"><strong>Sysdig agent version 0.88</strong></span>, Sysdig supports all flavors of GKE, including <span class="bold bold"><strong>Ubuntu</strong></span> and GKE's default <span class="bold bold"><strong>Container-Optimized OS (<a class="link" href="https://cloud.google.com/container-optimized-os/docs/" target="_blank">COS</a>)</strong></span>.</p><p>Note that the standard Sysdig agent cannot be installed on GKE COS because Sysdig relies on a kernel module that COS does not allow. To accommodate this limitation <span class="bold bold"><strong>Sysdig has developed an alternate probe built on <a class="link" href="https://prototype-kernel.readthedocs.io/en/latest/bpf/" target="_blank">eBPF</a>,</strong></span> a "universal in-kernel virtual machine."</p><p>The instructions below describe a standard GKE agent install and call out the special steps needed to install the eBPF probe if you are using COS.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="550px"><tr style="height: 369px"><td><img src="image/image-missing.png" style="max-width: 550px; max-height: 369px; " alt=""></img></td></tr></table></div><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-e6e09fd0-4d0b-674a-a552-de9149817ed6"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Preparation</h2></div></div></div><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-a3540191-0250-b9c0-6ddc-1df6a2cc4497"><div class="titlepage"><div><div class="title"><h3 class="title">Open Port 6443 for Agent Ingress and Egress</h3></div></div></div><p>Because GKE uses stateful firewalls, you must actively open port 6443 for the Sysdig agent, for both inbound and outbound traffic.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>In earlier versions, the Sysdig Agent connected to port 6666. This behavior has been deprecated, as the Sysdig agent now connects to port 6443.</p></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="1000px"><tr><td><img src="image/uuid-42d4c47c-df4f-b623-a569-d6a753d71223-en.png" style="max-width: 1000px; " alt="373574744.png"></img></td></tr></table></div></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-aa29923d-8138-5b16-12a1-9d77adee7885"><div class="titlepage"><div><div class="title"><h3 class="title">GKE COS/eBPF-Specific Requirements</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Linux kernel version &gt;= 4.14.</p></li><li class="listitem"><p>When performing the installation steps, you will add one additional parameter to install the eBPF probe. See Step 7, below.</p></li></ul></div></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-97c0e6bb-f6a4-f5c4-ecf5-5c5d64016c49"><div class="titlepage"><div><div class="title"><h3 class="title">Background Info</h3></div></div></div><p>You can review <a class="link" href="43318-agent-install--kubernetes---gke---openshift---ibm.html" title="Agent Install: Kubernetes | GKE | OpenShift | IBM">Agent Install: Kubernetes | GKE | OpenShift | IBM</a> and the <a class="link" href="43298-host-requirements-for-agent-installation.html" title="Host Requirements for Agent Installation">Host Requirements for Agent Installation</a> for additional context, if desired.</p></section></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-24588722-5f50-9ace-218b-bb27bdfa6ff6"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Installation Steps</h2></div></div></div><p>To deploy agents using Kubernetes daemonsets, you will <a class="link" href="https://github.com/draios/sysdig-cloud-scripts/tree/master/agent_deploy/kubernetes" target="_blank">download</a> the following configuration files, edit them as required, and deploy them.</p><p> <code class="code"> <a class="link" href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-clusterrole.yaml" target="_blank">sysdig-agent-clusterrole.yaml</a> </code> <code class="code"> <a class="link" href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-daemonset-v2.yaml" target="_blank">sysdig-agent-daemonset-v2.yaml</a> </code> </p><p> <code class="code"> <a class="link" href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-configmap.yaml" target="_blank">sysdig-agent-configmap.yaml</a> </code> </p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p> <span class="bold bold"><strong>HELM CHART OPTION</strong></span>Kubernetes also offers a package manager, <a class="link" href="https://helm.sh/" target="_blank">Helm</a>, which uses charts to simplify this process.</p><p>If you are using Helm charts in your K8s environment, we recommend using them to deploy Sysdig agents, as described <a class="link" href="https://github.com/helm/charts/blob/master/stable/sysdig/README.md" target="_blank">here</a>.</p></div><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-ad2c4052-ca35-33c7-5a97-d4cd51e0145e"><div class="titlepage"><div><div class="title"><h3 class="title">Deploy the Agents</h3></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p> <span class="bold bold"><strong> <a class="link" href="https://github.com/draios/sysdig-cloud-scripts/tree/master/agent_deploy/kubernetes" target="_blank">Download</a> the sample files</strong></span> <code class="code"> sysdig-agent-clusterrole.yaml</code>, <code class="code">sysdig-agent-daemonset-v2.yaml,</code> and <code class="code">sysdig-agent-configmap.yaml. </code> </p></li><li class="step"><p> <span class="bold bold"><strong>Create a namespace</strong></span> to use for the Sysdig agent.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>You can use whatever name you want. In this document, we used <code class="code">sysdig-agent</code> for both the namespace and the service account.</p></div><pre class="programlisting">kubectl create ns sysdig-agent</pre></li><li class="step"><p> <span class="bold bold"><strong>Create a secret key</strong></span> using the command:</p><pre class="programlisting">
kubectl create secret generic sysdig-agent --from-literal=access-key=&lt;your sysdig access key&gt; -n sysdig-agent</pre></li><li class="step"><p> <span class="bold bold"><strong>If you are running Kubernetes 1.6 or higher,</strong></span> you must</p><ol type="a" class="substeps"><li class="step"><p> <span class="bold bold"><strong>Grant your user the ability to create roles in Kubernetes</strong></span> by running the following command (see <a class="link" href="https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control" target="_blank">Google documentation</a> for more):</p><pre class="programlisting">
kubectl create clusterrolebinding your-user-cluster-admin-binding --clusterrole=cluster-admin --user=your.google.cloud.email@example.org</pre></li><li class="step"><p> <span class="bold bold"><strong>Create a service account for the Sysdig agent</strong></span> using the <code class="code"> <a class="link" href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-clusterrole.yaml" target="_blank">clusterrole.yaml</a> </code> file.</p><p>The Sysdig agent must be granted read-only access to certain Kubernetes APIs, which the agent uses to populate metadata and provide component metrics.</p><p>Sysdig provides a config file in GitHub. Deploying this file creates a cluster role and service account in Kubernetes, and defines cluster role binding that grants the Sysdig agent rules in the cluster role.</p><p>Run the following commands (using whatever namespace you defined in Step 2):</p><pre class="programlisting">
kubectl apply -f sysdig-agent-clusterrole.yaml -n sysdig-agent
kubectl create serviceaccount sysdig-agent -n sysdig-agent
kubectl create clusterrolebinding sysdig-agent --clusterrole=sysdig-agent --serviceaccount=sysdig-agent:sysdig-agent  </pre></li></ol></li><li class="step"><p> <span class="bold bold"><strong>FOR ON-PREM INSTALLATIONS ONLY: </strong></span> <span class="bold bold"><strong>Edit <code class="code">configmap.yaml </code> </strong></span>to add the <code class="code">collector</code> <code class="code">address</code> and <code class="code">port</code>, and <code class="code">SSL/TLS</code> information :</p><pre class="programlisting">collector: 
    collector_port: 
    ssl: #true or false
    ssl_verify_certificate: #true or false</pre><div dir="ltr" class="note note"><h3 class="title">Note</h3><p> <code class="code">ssl_verify_certificate</code> should be set to fa<code class="code">l</code>se if a self-signed certificate or private, CA-signed cert is used. See information about SSL in on-premises <a class="link" href="">here</a>.</p></div></li><li class="step"><p> <span class="bold bold"><strong>(ALL INSTALLS): Apply the <code class="code">configmap.yaml</code> file</strong></span> using the command:</p><pre class="programlisting">
kubectl apply -f sysdig-agent-configmap.yaml -n sysdig-agent</pre></li><li class="step"><p> <span class="bold bold"><strong> <span class="bold bold"><strong>FOR GKE COS ONLY:</strong></span> <span class="bold bold"><strong>To enable the eBPF probe required for COS: </strong></span>Uncomment the following parameters in <span class="bold bold"><strong> <code class="code">s</code> </strong></span> <span class="bold bold"><strong> <code class="code">ysdig-agent-daemonset-v2.yaml</code> </strong></span> under the env section:</strong></span> </p><pre class="programlisting">env:
  - name: SYSDIG_BPF_PROBE
    value: ""</pre></li><li class="step"><p> <span class="bold bold"><strong> <span class="bold bold"><strong>(ALL INSTALLS): </strong></span>Apply the <code class="code">daemonset-v2.yaml</code> file</strong></span> using the command:</p><pre class="programlisting">
kubectl apply -f sysdig-agent-daemonset-v2.yaml -n sysdig-agent</pre></li></ol></div><p>The agents will be deployed and you can check the Monitor UI to see some metrics. You can make further edits to the <code class="code">configmap</code> as described below.</p></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-a25ac8d0-d44d-65c6-5bd1-7d8324d4e337"><div class="titlepage"><div><div class="title"><h3 class="title">Enable Kube State Metrics and Cluster Name</h3></div></div></div><p>These steps are optional but recommended.</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p> <span class="bold bold"><strong>Edit <code class="code">sysdig-agent-configmap.yaml</code> </strong></span> to <span class="bold bold"><strong>uncomment </strong></span> the line: <span class="bold bold"><strong> <code class="code">new_k8s: true</code> </strong></span> </p><p>This allows kube state metrics to be automatically detected, monitored, and displayed in Sysdig Monitor.</p><p>For more information, see the <a class="link" href="https://sysdig.com/blog/introducing-kube-state-metrics/" target="_blank">Kube State Metrics</a> entry in the Sysdig blog.</p></li><li class="step"><p> <span class="bold bold"><strong>Edit <code class="code">sysdig-agent-configmap.yaml</code> </strong></span> to <span class="bold bold"><strong>uncomment </strong></span> the line: <span class="bold bold"><strong> <code class="code">k8s_cluster_name: </code> </strong></span>and add your cluster name.</p><p>Setting cluster name here allows you to view, scope, and segment metrics in the Sysdig Monitor UI by Kubernetes cluster.</p><p> <span class="bold bold"><strong>Note:</strong></span> Alternatively, if you assign a tag with "<code class="code">cluster</code>" in the tag name, Sysdig Monitor will display that as the Kubernetes cluster name.</p></li><li class="step"><p> <span class="bold bold"><strong>Apply the configmap changes</strong></span> using the command:</p><pre class="programlisting">
kubectl apply -f sysdig-agent-configmap.yaml -n sysdig-agent</pre></li><li class="step"><p>Proceed to verify the metrics in the Sysdig Monitor UI.</p></li></ol></div><div dir="ltr" class="note note"><h3 class="title">Note</h3><p> <span class="bold bold"><strong>There are two ways to <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Platform/pages/189726885/Agent+Configuration" target="_blank">update the agent configuration</a>:</strong></span> </p><p> <span class="bold bold"><strong>Option 1:</strong></span> Edit the files locally and apply the changes with <code class="code">kubectl apply -f</code>:</p><p> <code class="code">kubectl apply -f sysdig-agent-configmap.yaml -n sysdig-agent</code> </p><p> <span class="bold bold"><strong>Option 2:</strong></span> Use <code class="code">kubectl edit</code> to edit files on the fly:</p><p> <code class="code">kubectl edit configmap sysdig-agent </code>-n sysdig-agent</p><p>Running agents will automatically pick the new configuration after Kubernetes pushes the changes across all the nodes in the cluster.</p></div></section></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-25af3058-f373-5343-df64-ca8a92ffdb7f"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Verify Metrics in Sysdig Monitor UI</h2></div></div></div><p>Log in to Sysdig Monitor to verify that the agent deployed and the metrics are detected and collected appropriately.</p><p>The steps below give one way to do the check.</p><p>(See also <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/MON/pages/373555252/Getting+Started" target="_blank">Sysdig Monitor Documentation</a>.)</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Access Sysdig Monitor:</p><p> <span class="bold bold"><strong>SaaS:</strong></span> <a class="link" href="https://app.sysdigcloud.com/" target="_blank">https://app.sysdigcloud.com</a> </p><p>Log in with your Sysdig user name and password.</p></li><li class="step"><p>Select the <code class="code">Explore</code> tab to see if metrics are displayed.</p></li><li class="step"><p>(Once you have enabled <code class="code">new_k8s:true</code>)</p><p>To verify that kube state metrics and cluster name are working correctly: Select the <code class="code">Explore</code> tab and create a grouping by <code class="code"> <a class="link" href="http://kubernetes.cluster.name" target="_blank">kubernetes.cluster.name</a> </code> and <code class="code"> <a class="link" href="http://kubernetes.pod.name" target="_blank">kubernetes.pod.name</a> </code>.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="1064px"><tr style="height: 250px"><td><img src="image/uuid-7bf33192-0102-dc5f-d499-5f5d028272cb-en.png" style="max-width: 1064px; max-height: 250px; " alt="373574807.png"></img></td></tr></table></div></li><li class="step"><p>Select an individual container or pod to see details.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="706px"><tr style="height: 250px"><td><img src="image/uuid-71481fe7-0eca-43be-2bd9-9f8ceb1b34d4-en.png" style="max-width: 706px; max-height: 250px; " alt="373574813.png"></img></td></tr></table></div></li></ol></div><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>Kubernetes metadata (pods, deployments etc.) appear a minute or two later than the nodes/containers themselves; if pod names do not appear immediately, wait and retry the Explore view.</p><p>If agents are disconnecting, there could be an issue with your MAC addresses. See <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/SP/pages/373575015/Troubleshooting+Agent+Installation" target="_blank">Troubleshooting Agent Installation</a> for tips.</p></div></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-6ecb2064-c67a-2315-94e5-35a8136f3f83"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Additional Options</h2></div></div></div><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-1916db33-a36c-762d-37dc-d7b44617c55d"><div class="titlepage"><div><div class="title"><h3 class="title">Connect to the Sysdig Backend via Static IPs (SaaS only)</h3></div></div></div><p>Sysdig provides a list of static IP addresses that can be whitelisted in a Sysdig environment, allowing users to establish a network connection to the Sysdig backend without opening complete network connectivity. This is done by setting the Collector IP to <code class="code"> <a class="link" href="http://collector-static.sysdigcloud.com" target="_blank">collector-static.sysdigcloud.com</a> </code>.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The <code class="code">sysdig-agent-configmap.yaml</code> file can be edited either locally or using the edit command in Kubernetes. refer to the section above for more information.</p></div><p>To configure the collector IP in a Kubernetes SaaS instance:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Open <code class="code">sysdig-agent-configmap.yaml</code> in a text editor.</p></li><li class="step"><p>Uncomment the following lines:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>collector:</p></li><li class="listitem"><p>collector_port</p></li></ul></div></li><li class="step"><p>Set the collector: value to <a class="link" href="http://collector-static.sysdigcloud.com" target="_blank">collector-static.sysdigcloud.com</a> </p></li><li class="step"><p>Set the collector_port: value to 6443</p></li><li class="step"><p>Save the file.</p></li></ol></div><p>The example file below shows how the <code class="code">sysdig-agent-configmap.yaml</code> file should look after configuration:</p><pre class="programlisting">apiVersion: v1
kind: ConfigMap
metadata:
  name: sysdig-agent
data:
  dragent.yaml: |
    ### Agent tags
    # tags: linux:ubuntu,dept:dev,local:nyc

    #### Sysdig Software related config ####

    # Sysdig collector address
    collector: collector-static.sysdigcloud.com

    # Collector TCP port
    collector_port: 6443

    # Whether collector accepts ssl/TLS
    ssl: true

    # collector certificate validation
    ssl_verify_certificate: true

    # Sysdig Secure
    security:
                enabled: true

    #######################################
    # new_k8s: true
    # k8s_cluster_name: production</pre></section></section></section><div class="footer-content"><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e">GKE Agent Installation Steps</a></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-e6e09fd0-4d0b-674a-a552-de9149817ed6">Preparation</a><ul class="nav"><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-a3540191-0250-b9c0-6ddc-1df6a2cc4497">Open Port 6443 for Agent Ingress and Egress</a></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-aa29923d-8138-5b16-12a1-9d77adee7885">GKE COS/eBPF-Specific Requirements</a></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-97c0e6bb-f6a4-f5c4-ecf5-5c5d64016c49">Background Info</a></li></ul></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-24588722-5f50-9ace-218b-bb27bdfa6ff6">Installation Steps</a><ul class="nav"><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-ad2c4052-ca35-33c7-5a97-d4cd51e0145e">Deploy the Agents</a></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-a25ac8d0-d44d-65c6-5bd1-7d8324d4e337">Enable Kube State Metrics and Cluster Name</a></li></ul></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-25af3058-f373-5343-df64-ca8a92ffdb7f">Verify Metrics in Sysdig Monitor UI</a></li><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-6ecb2064-c67a-2315-94e5-35a8136f3f83">Additional Options</a><ul class="nav"><li><a href="#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-1916db33-a36c-762d-37dc-d7b44617c55d">Connect to the Sysdig Backend via Static IPs (SaaS only)</a></li></ul></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div class="voting-title">Was this helpful?</div><div class="btn-group btn-group-toggle" data-toggle="buttons"><button id="feedback-yes-btn" class="btn toggle-yes">Yes</button><button id="feedback-no-btn" class="btn">No</button></div><div id="email-feedback" class=" toggle-feedback"><p><a href='mailto:radhika@sysdig.com?subject=Feedback for help topic "GKE Agent Installation Steps"&amp;body=%0D%0A_______________________%0D%0A%0D%0A
			
			Please add your feedback above for topic "GKE Agent Installation Steps" in the publication "Sysdig Platform".'><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon voting-feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="43329-kubernetes-agent-installation-steps.html#UUID-d41b3f19-62b8-1875-8309-85cf7d9fe133_UUID-b83dbad6-3ce5-73de-9e4c-68bfbcda28f2">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="43341-gke-agent-installation-steps.html#UUID-3920253a-8524-6980-2c44-974ee19ac79e_UUID-e6e09fd0-4d0b-674a-a552-de9149817ed6">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
