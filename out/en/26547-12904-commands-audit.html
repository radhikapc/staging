<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Commands Audit</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d40bfcded91c.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="26547-12903-policy-creation-walkthrough.html" title="Policy Creation Walkthrough"></link><link rel="next" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Contents" title="Contents"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
				$(document).ready(function(){
				var lang = hljs.listLanguages();
				$('pre:not(.embedcode)').each(function(){
				if ($(this).data('language') && $.inArray($(this).data('language'), lang) > -1) {
					var code = hljs.highlight($(this).data('language'), $(this).text());
						$(this).empty().append(code.value).addClass("hljs").addClass(code.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="https://478h5m1yrfsa3bbe262u7muv-wpengine.netdna-ssl.com/wp-content/themes/sysdig/assets/images/logo-sysdig-black.svg" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="https://478h5m1yrfsa3bbe262u7muv-wpengine.netdna-ssl.com/wp-content/themes/sysdig/assets/images/logo-sysdig-black.svg" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Sysdig Documentation</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="26547-12903-policy-creation-walkthrough.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Contents">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <span class="current-category">Sysdig Documentation</span></li><li class="breadcrumb-link"><a href="26547-11020-sysdig-secure.html">Sysdig Secure</a></li><li class="breadcrumb-node">Commands Audit</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-659b609f-a499-28d5-3d26-a58b38dfd24b" data-permalink="26547-12904-commands-audit.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b"><div class="titlepage"><div><div class="title"><h3 class="title">Commands Audit</h3></div></div></div><p>The Commands Audit module provides Sysdig Secure users with a searchable and sortable audit trail of user commands executed within the infrastructure.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>While policy events are inherently suspicious activity that warrant investigation, commands are not themselves considered suspicious.</p></div><p>The Sysdig Agent examines all execve events. Information about commands that meet the following criteria is saved by the Sysdig backend, and made available for review as a command entry in the Commands Audit module table:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A program was launched by a shell associated with a terminal (i.e. is related to a user-entered command).</p></li><li class="listitem"><p>The parent process was launched in a running container (i.e. the result of a <code class="code">docker exec &lt;container&gt;</code> command).</p></li></ul></div><div dir="ltr" class="warning warning"><h3 class="title">Warning</h3><p>If an excessive volume of commands occur in a given second, some commands may be excluded from the information sent from the agent to the Sysdig backend.</p></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="867px"><tr style="height: 250px"><td><img src="image/uuid-c2280e41-cfcb-3037-7354-98dc95b4e1d1-en.png" style="max-width: 867px; max-height: 250px; " alt="261980237.png"></img></td></tr></table></div><p>The table below outlines the information displayed in the Command Audits module:</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col></colgroup><thead><tr><th class="th"><p>Data</p></th><th class="th"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p>Time</p></td><td class="td"><p>The date and time the command was executed.</p></td></tr><tr><td class="td"><p>Shell</p></td><td class="td"><p>The terminal shell the command was executed in.</p></td></tr><tr><td class="td"><p>Command Line</p></td><td class="td"><p>The full command executed, including flags/variables.</p></td></tr><tr><td class="td"><p>Scope</p></td><td class="td"><p>The affected scope within the infrastructure.</p></td></tr></tbody></table></div><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Contents"><div class="titlepage"><div><div class="title"><h4 class="title">Contents</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-ReviewaCommand" title="Review a Command">Review a Command</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-FilteringtheCommandsTable" title="Filtering the Commands Table">Filtering the Commands Table</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Groupings" title="Groupings">Groupings</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-TimeNavigation" title="Time Navigation">Time Navigation</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-SearchFilters" title="Search Filters">Search Filters</a> </p></li></ul></div></li></ul></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-ReviewaCommand"><div class="titlepage"><div><div class="title"><h4 class="title">Review a Command</h4></div></div></div><p>Individual commands can be reviewed by selecting the line item in the Commands Audit module table. This opens the <code class="code">Command Details</code> window:</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="500px"><tr style="height: 585px"><td><img src="image/uuid-a246aad8-b378-a35f-99f3-f7d907614572-en.png" style="max-width: 500px; max-height: 585px; " alt="269090817.png"></img></td></tr></table></div><p>The table below outlines the information displayed in the <code class="code">Command Details</code> window:</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col></colgroup><thead><tr><th class="th"><p>Name</p></th><th class="th"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p>When</p></td><td class="td"><p>The date and time the command was executed.</p></td></tr><tr><td class="td"><p>Command</p></td><td class="td"><p>The command executed.</p></td></tr><tr><td class="td"><p>Full Command Line</p></td><td class="td"><p>The complete command, including all variables/options.</p></td></tr><tr><td class="td"><p>Working Directory</p></td><td class="td"><p>The directory the command was executed in.</p></td></tr><tr><td class="td"><p>Scope</p></td><td class="td"><p>The entities within the infrastructure impacted by the command.</p></td></tr><tr><td class="td"><p>Host</p></td><td class="td"><p>The hostname and MAC address of the host the command was executed on.</p></td></tr><tr><td class="td"><p>Container</p></td><td class="td"><p>The container ID, container name, and image that the command was executed on.</p></td></tr><tr><td class="td"><p>Additional Details</p></td><td class="td"><p>Detailed user/host information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The Process ID (PID) of the command.</p></li><li class="listitem"><p>The Parent Process ID (PPID) of the command.</p></li><li class="listitem"><p>The user ID of the user that executed the command.</p></li><li class="listitem"><p>The Shell ID.</p></li><li class="listitem"><p>The distance from the root of the process hierarchy.</p></li></ul></div></td></tr></tbody></table></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-FilteringtheCommandsTable"><div class="titlepage"><div><div class="title"><h4 class="title">Filtering the Commands Table</h4></div></div></div><p>The Commands Audit module's table can be filtered to display only the most relevant commands for a particular issue, or to provide greater visibility of a more targeted scope within the infrastructure. There are three ways to filter the table, which can be used in tandem to refine the information presented.</p><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Groupings"><div class="titlepage"><div><div class="title"><h5 class="title">Groupings</h5></div></div></div><p>Groupings are hierarchical organizations of labels, allowing users to organize their infrastructure views in a logical hierarchy. Users can switch between pre-configured groupings via the <code class="code">Browse By</code> menu, or configure custom groupings, and then dive deeper into the infrastructure. For more information about groupings, refer to the <a class="link" href="26547-12896-configure-groupings-in-sysdig-secure.html" title="Configure Groupings in Sysdig Secure">Configure Groupings in Sysdig Secure</a> documentation</p></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-TimeNavigation"><div class="titlepage"><div><div class="title"><h5 class="title">Time Navigation</h5></div></div></div><p>The time window navigation bar provides users with quick links to common time windows, filtering the table to only show commands run within that window. For more information on time windows, refer to the <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Monitor/pages/239337526/Time+Windows" target="_blank">Time Windows</a> documentation.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>Sysdig Secure does not currently provide functionality to configure a custom time window.</p></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-SearchFilters"><div class="titlepage"><div><div class="title"><h5 class="title">Search Filters</h5></div></div></div><p>Search filters can be applied by either using the search bar directly, or by adding pre-configured search strings via the Command Details panel. The search bar example below displays only table items that include <code class="code">apt-get</code>:</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="1000px"><tr style="height: 143px"><td><img src="image/uuid-7753a002-c566-3fe4-013e-67ba96a626de-en.png" style="max-width: 1000px; max-height: 143px; " alt="269025305.png"></img></td></tr></table></div><p>To use a pre-configured search string:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Commands Audit</code> module, select a command from the table to open the <code class="code">Command Details</code> window.</p></li><li class="step"><p>Add a filter by click the <code class="code">Add</code> link beside one of the available options:</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="400px"><tr><td><img src="image/uuid-2af70612-2fc8-02d3-8e14-3ce614627437-en.png" style="max-width: 400px; " alt="269254693.png"></img></td></tr></table></div></li></ol></div><p>The example below shows the table filtered by the working directory:</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="1000px"><tr style="height: 201px"><td><img src="image/uuid-5ada70af-fe5f-bef1-0255-4d6c1ff0892c-en.png" style="max-width: 1000px; max-height: 201px; " alt="269025313.png"></img></td></tr></table></div><p>Pre-configured filters exist for the following information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Command</p></li><li class="listitem"><p>Working Directory</p></li><li class="listitem"><p>Process ID</p></li><li class="listitem"><p>Parent Process ID</p></li><li class="listitem"><p>User ID</p></li><li class="listitem"><p>Shell ID</p></li><li class="listitem"><p>Shell Distance</p></li></ul></div><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>Search filters can be deleted by either deleting the text in the search bar, or clicking the <code class="code">Remove</code> link beside the filter in the <code class="code">Command Details</code> window.</p></div></section></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b">Commands Audit</a></li><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Contents">Contents</a></li><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-ReviewaCommand">Review a Command</a></li><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-FilteringtheCommandsTable">Filtering the Commands Table</a><ul class="nav"><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Groupings">Groupings</a></li><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-TimeNavigation">Time Navigation</a></li><li><a href="#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-SearchFilters">Search Filters</a></li></ul></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="26547-12903-policy-creation-walkthrough.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="26547-12904-commands-audit.html#UUID-32b22eab-acf1-f629-979a-49322085bc3b_id_CommandsAudit-Contents">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
