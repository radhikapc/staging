<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="no"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Scanning Policy Gates and Triggers</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d6593bb1e613.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="31937-whitelist---blacklist-cves-and-images.html" title="Whitelist | Blacklist CVEs and Images"></link><link rel="next" href="31939-manage-scanning-alerts.html" title="Manage Scanning Alerts"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
			$(document).ready(function() {
				/**
				 * @type {array}
				 */
				var supported = hljs.listLanguages();

				$('pre:not(.embedcode)').each(function() {
					/**
					 * @type {string}
					 */
					var language = $(this).data('language');

					if (language === 'plaintext' || language === 'text') {
						$(this).addClass(language).addClass('hljs');
						return true;
					}

					if (language && $.inArray(language, supported) > -1) {
						var c = hljs.highlight(language, $(this).text());
						$(this)
							.empty()
							.append(c.value)
							.addClass("hljs")
							.addClass(c.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><ul class="toc nav nav-site-sidebar"><li><a href="31918-sysdig-secure.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a4e13476-09e2-0efc-ae18-7955d3e4e07f" data-permalink="31918-sysdig-secure.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Sysdig Secure</a><ul><li><a href="31919-getting-started-with-sysdig-secure.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-34b1cd4b-0b04-382d-958d-c37e8514fd79" data-permalink="31919-getting-started-with-sysdig-secure.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Getting Started with Sysdig Secure</a><ul></ul></li><li><a href="31920-policies.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a6f83873-7719-6a0c-4355-512ead6227e9" data-permalink="31920-policies.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Policies</a><ul><li><a href="31921-policy-creation-walkthrough.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-fe01ee81-3dc7-d812-dbcb-fc3f462440a6" data-permalink="31921-policy-creation-walkthrough.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Policy Creation Walkthrough</a></li><li><a href="31922---policies----new-editor-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-05db0b74-abb6-10be-4585-9f7ff6c4b611" data-permalink="31922---policies----new-editor-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Policies** (New Editor)</a></li></ul></li><li><a href="31925-policy-events.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a0c9d18f-6753-34fe-5537-e841a0c7ebc7" data-permalink="31925-policy-events.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Policy Events</a><ul><li><a href="31926-configure-groupings-in-sysdig-secure.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-0672c2b1-d759-e19c-7391-bdbef0b03c67" data-permalink="31926-configure-groupings-in-sysdig-secure.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Configure Groupings in Sysdig Secure</a></li><li><a href="31927-identify-false-positives.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-68b213e2-d3d2-2445-0125-544754d1bde5" data-permalink="31927-identify-false-positives.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Identify False Positives</a></li><li><a href="31928-event-forwarding.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e7b134a5-6dff-ab99-77da-36828caa2b49" data-permalink="31928-event-forwarding.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Event Forwarding</a></li><li><a href="31929-kubernetes-audit-logging.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-f335c462-5c1e-ca62-9991-a32ccd555304" data-permalink="31929-kubernetes-audit-logging.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Kubernetes Audit Logging</a></li></ul></li><li><a href="31930-commands-audit.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e607ad4e-4aff-6808-d2da-124d665c2935" data-permalink="31930-commands-audit.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Commands Audit</a><ul></ul></li><li><a href="31931-captures.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-c330d73e-7372-4819-7660-e9c3ebe57377" data-permalink="31931-captures.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Captures</a><ul></ul></li><li><a href="31932-image-scanning.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-138616ae-4150-ab6a-92c5-cda4c1b29469" data-permalink="31932-image-scanning.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Image Scanning</a><ul><li><a href="31933-integrate-image-scanning-into-development-pipeline.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-7ead976f-99be-8b45-5694-31341002ac83" data-permalink="31933-integrate-image-scanning-into-development-pipeline.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Integrate Image Scanning into Development Pipeline</a></li><li><a href="31934-manage-registry-credentials.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-3080ac12-2d01-d27b-4041-8a40b4a5efed" data-permalink="31934-manage-registry-credentials.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Manage Registry Credentials</a></li><li><a href="31935-scan-images.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2e7426a1-7293-6e1f-498d-32b73ef6f9dc" data-permalink="31935-scan-images.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Scan Images</a></li><li><a href="31936-manage-scanning-policies.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-b40a18e2-159f-f146-13f8-27fc6146cb83" data-permalink="31936-manage-scanning-policies.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Manage Scanning Policies</a></li><li><a href="31939-manage-scanning-alerts.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1cb38d40-635b-166e-efc5-3c5c84c85dc2" data-permalink="31939-manage-scanning-alerts.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Manage Scanning Alerts</a></li><li><a href="31940-review-scan-results.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a7899a60-3723-f6d6-cab2-0ce221e77570" data-permalink="31940-review-scan-results.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Review Scan Results</a></li></ul></li><li><a href="31943-compliance.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-b790f1cd-3616-783f-4854-d3561cef37f0" data-permalink="31943-compliance.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Compliance</a><ul><li><a href="31944-configure-compliance-tasks.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-75c0b4a6-947c-f7fd-e10f-168deb5e2980" data-permalink="31944-configure-compliance-tasks.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Configure Compliance Tasks</a></li><li><a href="31945-review-compliance-test-results.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-341d89bd-c5f7-6f95-99fe-1f6fe5c6bac7" data-permalink="31945-review-compliance-test-results.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Review Compliance Test Results</a></li><li><a href="31946-use-compliance-dashboards-and-metrics.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-99bffd0a-2092-7dde-3a05-a231789b43e1" data-permalink="31946-use-compliance-dashboards-and-metrics.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Use Compliance Dashboards and Metrics</a></li></ul></li></ul></li></ul></aside><div class="site-content"><h1 class="publication-title">SS (Sysdig Secure)</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="31937-whitelist---blacklist-cves-and-images.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="31939-manage-scanning-alerts.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <span class="current-category">SS (Sysdig Secure)</span></li><li class="breadcrumb-link"><a href="31918-sysdig-secure.html">Sysdig Secure</a></li><li class="breadcrumb-link"><a href="31932-image-scanning.html">Image Scanning</a></li><li class="breadcrumb-link"><a href="31936-manage-scanning-policies.html">Manage Scanning Policies</a></li><li class="breadcrumb-node">Scanning Policy Gates and Triggers</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-99e66797-f650-f761-7752-e7a4e6f54e97" data-permalink="31938-scanning-policy-gates-and-triggers.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac"><div class="titlepage"><div><div class="title"><h1 class="title" style="clear: both">Scanning Policy Gates and Triggers</h1></div></div></div><p>This document describes the gates (and their respective triggers / parameters) that are supported within Sysdig Secure policy bundles. Use these policy gates, triggers, and parameters to build in-depth scanning policies, from whitelisting / blacklisting partial file names to defining what login shells are approved.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>This information can also be obtained using the CLI:</p><pre class="programlisting">user@host:~$ anchore-cli policy describe (--gate &lt;gatename&gt; (--trigger &lt;triggername))</pre></div><p>For more information, see <a class="link" href="31936-manage-scanning-policies.html" title="Manage Scanning Policies">Manage Scanning Policies</a>.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Always" class="bridgehead">Always</h6><p>This gate provides users with a valuable testing resource, as it will be triggered unconditionally.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-always" class="bridgehead">always</h6><p>The <code class="code">always</code> trigger / gate will trip if it is present in the policy.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The Always gate is useful for testing whether the image blacklist/whitelist is working as expected.</p></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-113071d6-c662-be89-726b-c3bb8097b90c-en.png" style="max-width: 600px; " alt="374670949.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Dockerfile" class="bridgehead">Dockerfile</h6><p>The dockerfile gate reviews the contents of a dockerfile, or the assumed contents of a dockerfile if one is not provided, for exposed ports and instructions that do not follow best practices.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The gate assumes what the contents would be based on the docker layer history.</p></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-effective_user" class="bridgehead">effective_user</h6><p>This trigger reviews whether the effective user matches the user provided, and will fire based on the configured type.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">type</code> </p></td><td class="td"><p>Determines whether the user should be whitelisted or blacklisted.</p></td><td class="td"><p>N/A</p></td></tr><tr><td class="td"><p> <code class="code">user</code> </p></td><td class="td"><p>The name of the user.</p></td><td class="td"><p>root,docker</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-4927af91-38f9-e1b7-261c-1297e6b714e3-en.png" style="max-width: 600px; " alt="374670942.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-exposed_ports" class="bridgehead">exposed_ports</h6><p>This trigger evaluates the set of exposed ports to determine whether they should be whitelisted or blacklisted.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">actual_dockerfile_only</code> </p></td><td class="td"><p>Defines whether the evaluation should skip inferred or guessed dockerfiles, and only evaluate user-provided dockerfiles. The default value is <code class="code">false</code>.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">ports</code> </p></td><td class="td"><p>A comma-separated list of port numbers.</p></td><td class="td"><p>80,8080,8088</p></td></tr><tr><td class="td"><p> <code class="code">type</code> </p></td><td class="td"><p>Defines whether the ports should be whitelisted or blacklisted.</p></td><td class="td"><p>N/A</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 250px"><td><img src="image/uuid-8c8858a7-a8d1-c801-829b-db3135965ff8-en.png" style="max-width: 600px; max-height: 250px; " alt="374670935.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-instruction" class="bridgehead">instruction</h6><p>This trigger evaluates whether any directives / instructions in the list match the conditions in the dockerfile.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">actual_dockerfile_only</code> </p></td><td class="td"><p>Defines whether the evaluation should skip inferred or guessed dockerfiles, and only evaluate user-provided dockerfiles. The default value is <code class="code">false</code>.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>The type of check to perform.</p></td><td class="td"><p>=</p></td></tr><tr><td class="td"><p> <code class="code">instruction</code> </p></td><td class="td"><p>The dockerfile instruction to check.</p></td><td class="td"><p>FROM</p></td></tr><tr><td class="td"><p> <code class="code">value</code> </p></td><td class="td"><p>The value to check the dockerfile instruction against.</p></td><td class="td"><p>scratch</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-e4072b74-742a-766f-9255-bc1676e5ffa5-en.png" style="max-width: 600px; " alt="374670928.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-no_dockerfile_provided" class="bridgehead">no_dockerfile_provided</h6><p>This trigger will trip if there is no dockerfile supplied with the image. No parameters are required for this trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ca2d99f4-9dcb-1dcd-d688-48c2a54a4b57-en.png" style="max-width: 600px; " alt="374670921.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Files" class="bridgehead">Files</h6><p>The Files gate reviews files within the analyzed image. This evaluation covers file content, names, and filesystem attributes.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-content_regex_match" class="bridgehead">content_regex_match</h6><p>This trigger is tripped for each file where a match has been found using the configured regex in the <code class="code">analyzer_config.yaml</code> <code class="code">content_search</code> section.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>For more information regarding the regex values, refer to the <code class="code">analyzer_config.yaml</code> file.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">regex_name</code> </p></td><td class="td"><p>The regex string that appears in the <code class="code">FILECHECK_CONTENTMATCH</code> analyzer parameter.</p></td><td class="td"><p>.*password.*</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-05489f4d-6462-a2e5-4a5a-47b5ce56ac9f-en.png" style="max-width: 600px; " alt="374670914.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-name_match" class="bridgehead">name_match</h6><p>This trigger is tripped if the name of a file in the container matches the provided regex.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>This trigger has a performance impact on policy evaluation.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">regex</code> </p></td><td class="td"><p>The regex to search for.</p></td><td class="td"><p>.*\.pem</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-8f66612a-a519-d30e-8339-aee3722743a8-en.png" style="max-width: 600px; " alt="374670907.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-suid_or_guid_set" class="bridgehead">suid_or_guid_set</h6><p>This trigger is tripped for each file that has a set-user identification (SUID) or set-group identification (SGID) configured. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7aa199d5-6a91-630a-3cca-cae6f392f4b6-en.png" style="max-width: 600px; " alt="374670900.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Licenses" class="bridgehead">Licenses</h6><p>This gate is used to review software licenses found in the container image, to ensure, for example, that packages that violate internal company policy are not being used.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_exact_match" class="bridgehead">blacklist_exact_match</h6><p>This trigger will be tripped if the image contains packages distributed under the exact license specified.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">licenses</code> </p></td><td class="td"><p>A comma-separated list of license names to blacklist.</p></td><td class="td"><p>GPLv2+,GPL-3+,BSD-2-clause</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-341b4a79-fdba-52a1-fa52-14f7e63286d3-en.png" style="max-width: 600px; " alt="374670893.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_partial_match" class="bridgehead">blacklist_partial_match</h6><p>This trigger will be tripped if the image contains packages distributed under a license that includes the partial strings provided.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">licenses</code> </p></td><td class="td"><p>A comma-separated list of strings to blacklist for licenses.</p></td><td class="td"><p>LGPL,BSD</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0a711729-e924-85d5-ffb7-5dc1bc592710-en.png" style="max-width: 600px; " alt="374670886.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Metadata" class="bridgehead">Metadata</h6><p>This gate reviews image metadata, including the size, operating system, and architecture.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-attribute" class="bridgehead">attribute</h6><p>The attribute trigger is tripped if a named image metadata value matches the given condition.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">attribute</code> </p></td><td class="td"><p>The attribute name to check.</p></td><td class="td"><p>size</p></td></tr><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>The operation to perform for the evaluation.</p></td><td class="td"><p>&gt;</p></td></tr><tr><td class="td"><p> <code class="code">value</code> </p></td><td class="td"><p>The value used for the evaluation.</p></td><td class="td"><p>1073741824</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-8f9f72a7-486f-c0db-3e8b-78aa5f9c52c2-en.png" style="max-width: 600px; " alt="374670879.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-NPMs" class="bridgehead">NPMs</h6><p>The NPMs gate reviews any images that have NPM packages installed.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklisted_name_version" class="bridgehead">blacklisted_name_version</h6><p>This trigger is tripped if the evaluated image has an NPM package installed that has been blacklisted, either by name or optionally by name and version.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the blacklisted NPM package.</p></td><td class="td"><p>time_diff</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The specific version of the NPM package to blacklist.</p></td><td class="td"><p>0.2.9</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-97d91ce2-df4b-a89b-c689-3f2468280495-en.png" style="max-width: 600px; " alt="374670872.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-feed_data_unavailable" class="bridgehead">feed_data_unavailable</h6><p>This trigger is tripped if the engine does not have access to the NPM data feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-b404e9e1-d153-d4bd-22b7-c46e9a434464-en.png" style="max-width: 600px; " alt="374670865.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-newer_version_in_feed" class="bridgehead">newer_version_in_feed</h6><p>This trigger is tripped if the NPM data feed lists a newer version of the package. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-cb912d5f-e9fb-0c29-da4d-c6174e0be710-en.png" style="max-width: 600px; " alt="374670858.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-unknown_in_feeds" class="bridgehead">unknown_in_feeds</h6><p>This trigger is tripped if the NPM installed is not in the official NPM database. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-72089cf9-c2e0-60dd-2851-839d02035401-en.png" style="max-width: 600px; " alt="374670845.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-version_not_in_feeds" class="bridgehead">version_not_in_feeds</h6><p>This trigger is tripped if the NPM version is not listed as a valid version in the official NPM feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-caf91b83-fe04-7d4f-97b1-2ada64039ec1-en.png" style="max-width: 600px; " alt="374670838.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Packages" class="bridgehead">Packages</h6><p>The Packages gate reviews all packages within the image, verifying names, versions, and whitelisted / blacklisted packages.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist" class="bridgehead">blacklist</h6><p>This trigger is tripped if the image contains packages that have been blacklisted by either name, or name and version.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of blacklisted package/s.</p></td><td class="td"><p>openssh-server</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The exact version of the package that should be blacklisted.</p></td><td class="td"><p>1.0.1</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-e1b90a3d-4197-a3e3-d3c9-6cdaecdaabcb-en.png" style="max-width: 600px; " alt="374670831.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-required_package" class="bridgehead">required_package</h6><p>The <code class="code">required_package</code> trigger is tripped if the specified package / version is not found in the image.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the required package.</p></td><td class="td"><p>libssl</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The required package version.</p></td><td class="td"><p>1.10.3rc3</p></td></tr><tr><td class="td"><p> <code class="code">version_match_type</code> </p></td><td class="td"><p>Defines whether the trigger should require the exact package and version (exact), or just a version of the package (minimum). This is only relevant if the version is defined.</p></td><td class="td"><p>exact</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-2186ca1d-710d-a1d1-9cc1-61f8dcef8e0b-en.png" style="max-width: 600px; " alt="374670824.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-verify" class="bridgehead">verify</h6><p>This trigger reviews the package integrity against the package database in the image, and is tripped for change or removal of content in either all or a defined list of directories provided.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>Defines whether the check should focus on missing packages, changed packages, or all.</p></td><td class="td"><p>changed</p></td></tr><tr><td class="td"><p> <code class="code">only_directories</code> </p></td><td class="td"><p>Defines the list of directories the check should be limited to.</p></td><td class="td"><p>/usr,/var/lib</p></td></tr><tr><td class="td"><p> <code class="code">only_packages</code> </p></td><td class="td"><p>Defines the list of packages that should be verified.</p></td><td class="td"><p>libssl,openssl</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0d2b2f1c-9842-e30f-7e0e-baefc661ed71-en.png" style="max-width: 600px; " alt="374670817.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-PasswdFile" class="bridgehead">Passwd File</h6><p>This gate reviews <code class="code">/etc/passwd</code> for blacklisted users, groups, and shells.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_full_entry" class="bridgehead">blacklist_full_entry</h6><p>This trigger trips if the whole password is found in the <code class="code">/etc/password</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">entry</code> </p></td><td class="td"><p>The full entry to match in <code class="code">/etc/passwd</code>.</p></td><td class="td"><p>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7a7c0857-2d49-694d-ccd2-620167ce24ab-en.png" style="max-width: 600px; " alt="374670991.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_groupids" class="bridgehead">blacklist_groupids</h6><p>This trigger is tripped if the designated group id/s are found in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">group_ids</code> </p></td><td class="td"><p>A numeric, comma separated list of group ids that will cause the trigger to trip.</p></td><td class="td"><p>999,20</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-892a6fa4-5830-5c58-27c1-ac313a5cb6f4-en.png" style="max-width: 600px; " alt="374670984.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_shells" class="bridgehead">blacklist_shells</h6><p>This trigger will trip if a designated login shell is found under any user in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">shells</code> </p></td><td class="td"><p>The list of shell commands to blacklist.</p></td><td class="td"><p>/bin/bash,/bin/zsh</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-3c66eea8-7aff-7d6a-7903-9462fc30e845-en.png" style="max-width: 600px; " alt="374670977.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_userids" class="bridgehead">blacklist_userids</h6><p>This trigger will be tripped if the specified user ID is present in /<code class="code">etc/passwd</code>.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">user_ids</code> </p></td><td class="td"><p>The numerical, comma-separated list of user IDs to blacklist.</p></td><td class="td"><p>0,1</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-439e9f88-d115-f72e-49b7-5b9c3e316e97-en.png" style="max-width: 600px; " alt="374670970.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_usernames" class="bridgehead">blacklist_usernames</h6><p>The <code class="code">blacklist_usernames</code> trigger will trip if the specified username is found in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">user_names</code> </p></td><td class="td"><p>A comma-separated list of usernames to blacklist.</p></td><td class="td"><p>daemon,ftp</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d4ff8b96-8cfd-28e9-4e9f-278dbb862b85-en.png" style="max-width: 600px; " alt="374670963.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-content_not_available" class="bridgehead">content_not_available</h6><p>The <code class="code">content_not_available</code> trigger will trip if the <code class="code">/etc/passwd</code> file is not present in the image. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0878ca35-fa70-f6f9-9527-5d9987c0b04e-en.png" style="max-width: 600px; " alt="374670956.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-RubyGems" class="bridgehead">Ruby Gems</h6><p>The Ruby Gems gate ensures that developers are using official packages from the official GEM database, and are not using versions of packages that are no longer supported.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist1" class="bridgehead">blacklist</h6><p>The <code class="code">blacklist</code> trigger trips if a GEM package that matches the configured name and version is found in the evaluated image.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the gem.</p></td><td class="td"><p>time_diff</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The version of the gem to blacklist.</p></td><td class="td"><p>0.2.9</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-16eaf7f4-1357-e18c-03e8-e64544f5df4d-en.png" style="max-width: 600px; " alt="374671026.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-feed_data_unavailable1" class="bridgehead">feed_data_unavailable</h6><p>This trigger will trip if Sysdig does not have access to the GEM data feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-6e274ccb-de4b-5aa6-1f0f-f0aaf9e222e1-en.png" style="max-width: 600px; " alt="374671019.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-newer_version_found_in_feed" class="bridgehead">newer_version_found_in_feed</h6><p>This trigger will trip if an installed GEM package is not the latest version. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-6995a036-f98c-4369-886c-71deb7c9c980-en.png" style="max-width: 600px; " alt="374671012.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-not_found_in_feed" class="bridgehead">not_found_in_feed</h6><p>This trigger will trip if an installed GEM is not in the official GEM database. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ee5ed788-7c4b-5707-ca74-1658a598cd84-en.png" style="max-width: 600px; " alt="374671005.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-version_not_found_in_feed" class="bridgehead">version_not_found_in_feed</h6><p>This trigger will trip if the GEM is not listed in the official GEM feed as a valid / supported version. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-2f174d7d-7bb8-592b-b5c2-c55d8b008fd6-en.png" style="max-width: 600px; " alt="374670998.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-SecretScans" class="bridgehead">Secret Scans</h6><p>Secret scans determine, based on configured regex, whether secrets that could be available if an image was compromised have been baked into the image.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-content_regex_checks" class="bridgehead">content_regex_checks</h6><p>The <code class="code">content_regex_checks</code> trigger trips if the content search analyzer finds a match with the configured and named regexes. Matches are filtered by the <code class="code">content_regex_name</code>, and the <code class="code">filename_regex</code>, if either are set.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The <code class="code">content_regex_name</code> should be a value from the secret_search section of <code class="code">analyzer_config.yaml</code>.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">content_regex_name</code> </p></td><td class="td"><p>The name of the variable / content. If found in the image, this should trip the trigger.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The names available by default are <code class="code">AWS_ACCESS_KEY</code>, <code class="code">AWS_SECRET_KEY</code>, <code class="code">PRIV_KEY</code>, <code class="code">DOCKER_AUTH</code>, and <code class="code">API_KEY</code>.</p></div></td><td class="td"><p>AWS_ACCESS_KEY</p></td></tr><tr><td class="td"><p> <code class="code">filename_regex</code> </p></td><td class="td"><p>Filters the files that should be analyzed for the presence of the <code class="code">content_regex_name</code>.</p></td><td class="td"><p>/etc/.*</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-26e7eb12-a6eb-69cf-150a-c8090b8318e4-en.png" style="max-width: 600px; " alt="374671033.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Vulnerabilities" class="bridgehead">Vulnerabilities</h6><p>CVE / vulnerability checks can be used to ensure the included packages don't have vulnerabilities above a set level, are older than a designated period, or if data is unavailable.</p><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-package" class="bridgehead">package</h6><p>The package trigger is tripped if a vulnerability in an image matches the configured comparison criteria. The table below outlines the available parameters and criteria:</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">fix_available</code> </p></td><td class="td"><p>If present, the fix availability for the vulnerability record must match the value of the parameter.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">package_type</code> </p></td><td class="td"><p>The specific type of package.</p></td><td class="td"><p>all</p></td></tr><tr><td class="td"><p> <code class="code">severity</code> </p></td><td class="td"><p>The vulnerability severity.</p></td><td class="td"><p>high</p></td></tr><tr><td class="td"><p> <code class="code">severity_comparison</code> </p></td><td class="td"><p>The type of comparison to perform for the security evaluation.</p></td><td class="td"><p>&gt;</p></td></tr><tr><td class="td"><p> <code class="code">vendor_only</code> </p></td><td class="td"><p>If true, an available fix for this CVE must not be explicitly marked as "Won't be addressed by the vendor".</p></td><td class="td"><p>true</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7f0af41d-7d40-496a-2b2f-542648e64aa7-en.png" style="max-width: 600px; " alt="374671040.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-stale_feed_data" class="bridgehead">stale_feed_data</h6><p>The <code class="code">stale_feed_data</code> trigger will be tripped if the CVE data is older than the window specified.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">max_days_since_sync</code> </p></td><td class="td"><p>Determines how old in days sync data can be before the trigger is tripped.</p></td><td class="td"><p>10</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-a9e64080-33c4-d2a1-1396-50fce20c3280-en.png" style="max-width: 600px; " alt="374671047.png"></img></td></tr></table></div><h6 id="UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-vulnerability_data_unavailable" class="bridgehead">vulnerability_data_unavailable</h6><p>If no vulnerability data is available, the <code class="code">vulnerability_data_unavailable</code> trigger will trip. No parameters are required for this trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 175px"><td><img src="image/uuid-ebf96f6a-d66d-56c3-0138-2a520de71d3c-en.png" style="max-width: 600px; max-height: 175px; " alt="374671054.png"></img></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Always" title="Always">Always</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-always" title="always">always</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Dockerfile" title="Dockerfile">Dockerfile</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-effective_user" title="effective_user">effective_user</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-exposed_ports" title="exposed_ports">exposed_ports</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-instruction" title="instruction">instruction</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-no_dockerfile_provided" title="no_dockerfile_provided">no_dockerfile_provided</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Files" title="Files">Files</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-content_regex_match" title="content_regex_match">content_regex_match</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-name_match" title="name_match">name_match</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-suid_or_guid_set" title="suid_or_guid_set">suid_or_guid_set</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Licenses" title="Licenses">Licenses</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_exact_match" title="blacklist_exact_match">blacklist_exact_match</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_partial_match" title="blacklist_partial_match">blacklist_partial_match</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Metadata" title="Metadata">Metadata</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-attribute" title="attribute">attribute</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-NPMs" title="NPMs">NPMs</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklisted_name_version" title="blacklisted_name_version">blacklisted_name_version</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-feed_data_unavailable" title="feed_data_unavailable">feed_data_unavailable</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-newer_version_in_feed" title="newer_version_in_feed">newer_version_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-unknown_in_feeds" title="unknown_in_feeds">unknown_in_feeds</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-version_not_in_feeds" title="version_not_in_feeds">version_not_in_feeds</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Packages" title="Packages">Packages</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist" title="blacklist">blacklist</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-required_package" title="required_package">required_package</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-verify" title="verify">verify</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-PasswdFile" title="Passwd File">Passwd File</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_full_entry" title="blacklist_full_entry">blacklist_full_entry</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_groupids" title="blacklist_groupids">blacklist_groupids</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_shells" title="blacklist_shells">blacklist_shells</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_userids" title="blacklist_userids">blacklist_userids</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist_usernames" title="blacklist_usernames">blacklist_usernames</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-content_not_available" title="content_not_available">content_not_available</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-RubyGems" title="Ruby Gems">Ruby Gems</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-blacklist1" title="blacklist">blacklist</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-feed_data_unavailable1" title="feed_data_unavailable">feed_data_unavailable</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-newer_version_found_in_feed" title="newer_version_found_in_feed">newer_version_found_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-not_found_in_feed" title="not_found_in_feed">not_found_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-version_not_found_in_feed" title="version_not_found_in_feed">version_not_found_in_feed</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-SecretScans" title="Secret Scans">Secret Scans</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-content_regex_checks" title="content_regex_checks">content_regex_checks</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-Vulnerabilities" title="Vulnerabilities">Vulnerabilities</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-package" title="package">package</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-stale_feed_data" title="stale_feed_data">stale_feed_data</a> </p></li><li class="listitem"><p> <a class="link" href="31938-scanning-policy-gates-and-triggers.html#UUID-37804453-9605-aa45-c0b7-6a8f1912cdac_id_ScanningPolicyGatesandTriggers-vulnerability_data_unavailable" title="vulnerability_data_unavailable">vulnerability_data_unavailable</a> </p></li></ul></div></li></ul></div></section><div class="footer-content"><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div class="voting-title">Was this helpful?</div><div class="btn-group btn-group-toggle" data-toggle="buttons"><button id="feedback-yes-btn" class="btn toggle-yes">Yes</button><button id="feedback-no-btn" class="btn">No</button></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="31937-whitelist---blacklist-cves-and-images.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="31939-manage-scanning-alerts.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
