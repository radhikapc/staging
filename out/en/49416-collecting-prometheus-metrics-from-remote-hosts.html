<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="no"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Collecting Prometheus Metrics from Remote Hosts</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d6593bb1e613.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="49413-logging-and-troubleshooting.html#UUID-5752b7fe-d51d-819a-3270-d8db55f4c7a6_UUID-a7ba61ef-cf4e-105d-1b3a-8d442f5a254a" title="Troubleshooting"></link><link rel="next" href="49416-collecting-prometheus-metrics-from-remote-hosts.html#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-59094113-ccae-3e4e-38a2-ca3ca5a7a4bd" title="Preparing the Configuration File"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
			$(document).ready(function() {
				/**
				 * @type {array}
				 */
				var supported = hljs.listLanguages();

				$('pre:not(.embedcode)').each(function() {
					/**
					 * @type {string}
					 */
					var language = $(this).data('language');

					if (language === 'plaintext' || language === 'text') {
						$(this).addClass(language).addClass('hljs');
						return true;
					}

					if (language && $.inArray(language, supported) > -1) {
						var c = hljs.highlight(language, $(this).text());
						$(this)
							.empty()
							.append(c.value)
							.addClass("hljs")
							.addClass(c.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><ul class="toc nav nav-site-sidebar"><li><a href="49387-sysdig-integrations.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-771c811c-f772-2895-0741-68cd41629f51" data-permalink="49387-sysdig-integrations.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Sysdig Integrations</a><ul><li><a href="49396-integrate-prometheus-metrics.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-eceb826a-fec5-c5a6-90ca-7d8efe82c6a9" data-permalink="49396-integrate-prometheus-metrics.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Integrate Prometheus Metrics</a><ul><li><a href="49397-working-with-prometheus-metrics.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-9890919d-b271-70ab-ccea-70fda7c2503b" data-permalink="49397-working-with-prometheus-metrics.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Working with Prometheus Metrics</a></li><li><a href="49398-setting-up-the-environment.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-6d27eb71-2cb2-7670-1d73-02e793be68a0" data-permalink="49398-setting-up-the-environment.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Setting up the Environment</a></li><li><a href="49401-configuring-sysdig-agent.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2a0c1a18-dc5d-dac5-7edd-af52f7df1328" data-permalink="49401-configuring-sysdig-agent.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Configuring Sysdig Agent</a></li><li><a href="49408-example-configuration.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-15b88975-68d5-e178-d3fa-12b04f124426" data-permalink="49408-example-configuration.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Example Configuration</a></li><li><a href="49412-enabling-histogram-metrics.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-f5c3670e-6e64-9895-a7f3-b05e3728fff9" data-permalink="49412-enabling-histogram-metrics.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Enabling Histogram Metrics</a></li><li><a href="49413-logging-and-troubleshooting.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-446a3083-f7b7-c1a2-783b-f2f4c0c4f85f" data-permalink="49413-logging-and-troubleshooting.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Logging and Troubleshooting</a></li><li><a href="49416-collecting-prometheus-metrics-from-remote-hosts.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1d67064d-ba70-4ddb-a167-35bf16277748" data-permalink="49416-collecting-prometheus-metrics-from-remote-hosts.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Collecting Prometheus Metrics from Remote Hosts</a></li><li><a href="49422-legacy-prometheus-application-check.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-843ab086-ea68-a4eb-2e92-ab871fe34b86" data-permalink="49422-legacy-prometheus-application-check.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Legacy Prometheus Application Check</a></li></ul></li><li><a href="49423-integrate-jmx-metrics-from-java-virtual-machines.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a1941192-cc8f-86cf-9da4-cadefc8ec1c8" data-permalink="49423-integrate-jmx-metrics-from-java-virtual-machines.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Integrate JMX Metrics from Java Virtual Machines</a><ul></ul></li><li><a href="49432-integrate-statsd-metrics.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-555ca243-c443-cfe3-fc3b-c48cb8ec956d" data-permalink="49432-integrate-statsd-metrics.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Integrate StatsD Metrics</a><ul></ul></li><li><a href="49448-integrate-node-js-application-metrics.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-f038566e-d006-d5ed-8fcd-62034e9a75ba" data-permalink="49448-integrate-node-js-application-metrics.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Integrate Node.js Application Metrics</a></li><li><a href="49449-integrate-applications--default-app-checks-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-14ec76d4-c245-74c1-d3c0-f8c9e2034bf5" data-permalink="49449-integrate-applications--default-app-checks-.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Integrate Applications (Default App Checks)</a><ul><li><a href="49457-apache.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-051e583a-52ce-2e57-a08e-225b6c813c63" data-permalink="49457-apache.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Apache</a></li><li><a href="49464-apache-kafka.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ea750fd9-c03d-5892-2844-0932823fbda6" data-permalink="49464-apache-kafka.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Apache Kafka</a></li><li><a href="49477-consul.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-bfc9629e-db4c-e03c-0feb-18841a290695" data-permalink="49477-consul.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Consul</a></li><li><a href="49487-couchbase.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-0de6bfdc-40dd-2822-2f26-7ef9638edb33" data-permalink="49487-couchbase.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Couchbase</a></li><li><a href="49495-elasticsearch.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-90906398-8dd5-28f8-2b7e-463cd12ceed8" data-permalink="49495-elasticsearch.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Elasticsearch</a></li><li><a href="49503-etcd.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ab94d8e5-39ac-7300-b638-e25f279025d4" data-permalink="49503-etcd.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">etcd</a></li><li><a href="49514-fluentd.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-9779a30d-430a-b8ad-b206-ea0790d726bf" data-permalink="49514-fluentd.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">fluentd</a></li><li><a href="49520-go.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-4d3ed5d1-f5b8-49bb-2296-c942a7c3526c" data-permalink="49520-go.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Go</a></li><li><a href="49526-haproxy.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ab2ec3e7-23cc-a9c4-2535-b7d330afddd1" data-permalink="49526-haproxy.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">HAProxy</a></li><li><a href="49534-http.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e65a8064-db50-e75f-31e0-ec8c42814ba1" data-permalink="49534-http.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">HTTP</a></li><li><a href="49543-jenkins.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2c0f2e98-f320-5d70-9ea2-8e61c49c36fb" data-permalink="49543-jenkins.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Jenkins</a></li><li><a href="49550-lighttpd.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1dca1b9a-75a4-87ef-7600-394418e20159" data-permalink="49550-lighttpd.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Lighttpd</a></li><li><a href="49556-memcached.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a20704c7-0876-6831-519c-32705be1e0f1" data-permalink="49556-memcached.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Memcached</a></li><li><a href="49564-mesos-marathon.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-cebfbd8b-3533-2c09-79c0-20effd1c6d19" data-permalink="49564-mesos-marathon.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Mesos/Marathon</a></li><li><a href="49569-mongodb.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-36f07cbd-f9a0-456a-e696-3415fec0d78c" data-permalink="49569-mongodb.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">MongoDB</a></li><li><a href="49577-mysql.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ba647525-1872-0708-1409-7422b76312e8" data-permalink="49577-mysql.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">MySQL</a></li><li><a href="49583-nginx-and-nginx-plus.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-d71ba74d-de1d-444b-9a34-1b299ab7f62b" data-permalink="49583-nginx-and-nginx-plus.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">NGINX and NGINX Plus</a></li><li><a href="49594-ntp.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-8f4f51fc-8867-9379-0e9d-f2ee4c9a60a9" data-permalink="49594-ntp.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">NTP</a></li><li><a href="49600-pgbouncer.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ee7304fa-0897-5666-ee93-b259921e42c3" data-permalink="49600-pgbouncer.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">PGBouncer</a></li><li><a href="49607-php-fpm.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-df0137ef-4ab7-9b2c-30be-7192eda05bda" data-permalink="49607-php-fpm.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">PHP-FPM</a></li><li><a href="49614-postgresql.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a219500f-9a13-acf0-3daf-55183b4fb9b0" data-permalink="49614-postgresql.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">PostgreSQL</a></li><li><a href="49621-rabbitmq.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1b040a88-619b-b4d1-75cd-a1678f3fb1a2" data-permalink="49621-rabbitmq.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">RabbitMQ</a></li><li><a href="49630-redisdb.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2494d53c-6905-09b6-2254-ba5ca1bc73eb" data-permalink="49630-redisdb.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">RedisDB</a></li><li><a href="49639-riak-cs.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-098e3387-d906-f296-9b4a-1d291a750359" data-permalink="49639-riak-cs.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Riak CS</a></li><li><a href="49640-snmp.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-47f983dd-9c71-c782-ada3-3e0bf7f29020" data-permalink="49640-snmp.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">SNMP</a></li><li><a href="49648-supervisord.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-93c21723-3a7f-77dc-af8b-3265650a52d1" data-permalink="49648-supervisord.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Supervisord</a></li><li><a href="49658-tcp.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-79ca22c6-85f2-9d80-64a8-f1b55f497f7e" data-permalink="49658-tcp.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">TCP</a></li><li><a href="49665-varnish.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-dffacdd9-76cc-03c0-33bb-3ebff5abda11" data-permalink="49665-varnish.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Varnish</a></li></ul></li><li><a href="49673-monitor-log-files.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5b87c99b-26bd-37d4-0c31-703e031da0dd" data-permalink="49673-monitor-log-files.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Monitor Log Files</a><ul></ul></li><li><a href="49679-create-a-custom-app-check.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-fb1a575f-231c-29d1-74a1-4bb89698ca51" data-permalink="49679-create-a-custom-app-check.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Create a Custom App Check</a><ul></ul></li><li><a href="49683-create-per-container-custom-app-checks.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-b48c4862-27bc-b5cb-0afb-112110b5a699" data-permalink="49683-create-per-container-custom-app-checks.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Create Per-Container Custom App Checks</a><ul></ul></li></ul></li></ul></aside><div class="site-content"><h1 class="publication-title">Sysdig Integrations</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="49413-logging-and-troubleshooting.html#UUID-5752b7fe-d51d-819a-3270-d8db55f4c7a6_UUID-a7ba61ef-cf4e-105d-1b3a-8d442f5a254a">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="49416-collecting-prometheus-metrics-from-remote-hosts.html#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-59094113-ccae-3e4e-38a2-ca3ca5a7a4bd">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <span class="current-category">Sysdig Integrations</span></li><li class="breadcrumb-link"><a href="49387-sysdig-integrations.html">Sysdig Integrations</a></li><li class="breadcrumb-link"><a href="49396-integrate-prometheus-metrics.html">Integrate Prometheus Metrics</a></li><li class="breadcrumb-node">Collecting Prometheus Metrics from Remote Hosts</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-1d67064d-ba70-4ddb-a167-35bf16277748" data-permalink="49416-collecting-prometheus-metrics-from-remote-hosts.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17"><div class="titlepage"><div><div class="title"><h1 class="title" style="clear: both">Collecting Prometheus Metrics from Remote Hosts</h1></div></div></div><p>Sysdig Monitor can collect Prometheus metrics from remote endpoints with minimum configuration. Remote endpoints (remote hosts) refer to hosts where Sysdig Agent cannot be deployed. For example, a Kubernetes master node on managed Kubernetes services such as GKE and EKS where user workload cannot be deployed, which in turn implies no Agents involved. Enabling remote scraping on such hosts is as simple as identifying an Agent to perform the scraping and declaring the endpoint configurations with a remote services section in the Agent configuration file.</p><p>The collected Prometheus metrics are reported under and associated with the Agent that performed the scraping as opposed to associating them with a process.</p><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-59094113-ccae-3e4e-38a2-ca3ca5a7a4bd"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Preparing the Configuration File</h2></div></div></div><p>Multiple Agents can share the same configuration. Therefore, determine which one of those Agents scrape the remote endpoints with the <span class="bold bold"><strong> <code class="code">dragent.yaml</code> </strong></span> file. This is applicable to both</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Create a separate configuration section for remote services in the Agent configuration file under the <code class="code">prometheus</code> configuration.</p></li><li class="listitem"><p>Include a configuration section for each remote endpoint, and add either a URL or host/port (and an optional path) parameter to each section to identify the endpoint to scrape. The optional path identifies the resource at the endpoint. An empty path parameter defaults to the <code class="code">"/metrics"</code> endpoint for scraping.</p></li><li class="listitem"><p>Optionally, add custom tags for each endpoint configuration for remote services. In the absence of tags, metric reporting might not work as expected when multiple endpoints are involved. Agents cannot distinguish similar metrics scraped from multiple endpoints unless those metrics are uniquely identified by tags.</p></li></ul></div><p>To help you get started, an example configuration for Kubernetes is given below:</p><pre class="programlisting">prometheus:
  remote_services:
        - prom_1:
            kubernetes.node.annotation.sysdig.com/region: europe
            kubernetes.node.annotation.sysdig.com/scraper: true
            conf:
                url: "https://xx.xxx.xxx.xy:5005/metrics"
                tags:
                    host: xx.xxx.xxx.xy
                    service: prom_1
                    scraping_node: "{kubernetes.node.name}"
        - prom_2:
            kubernetes.node.annotation.sysdig.com/region: india
            kubernetes.node.annotation.sysdig.com/scraper: true
            conf:
                host: xx.xxx.xxx.yx
                port: 5005
                use_https: true
                tags:
                    host: xx.xxx.xxx.yx
                    service: prom_2
                    scraping_node: "{kubernetes.node.name}"
        - prom_3:
            kubernetes.pod.annotation.sysdig.com/prom_3_scraper: true
            conf:
                url: "{kubernetes.pod.annotation.sysdig.com/prom_3_url}"
                tags:
                    service: prom_3
                    scraping_node: "{kubernetes.node.name}"
        - haproxy:
            kubernetes.node.annotation.yourhost.com/haproxy_scraper: true
            conf:
                host: "mymasternode"
                port: 1936
                path: "/metrics"
                username: "{kubernetes.node.annotation.yourhost.com/haproxy_username}"
                password: "{kubernetes.node.annotation.yourhost.com/haproxy_password}"
                tags:
                    service: router</pre><p>In the above example, scraping is triggered by node and pod annotations. You can add annotations to nodes and pods by using the <code class="code">kubectl annotate</code> command as follows:</p><pre class="programlisting">
kubectl annotate node mynode --overwrite sysdig.com/region=india sysdig.com/scraper=true haproxy_scraper=true yourhost.com/haproxy_username=admin yourhost.com/haproxy_password=admin</pre><p>In this example, you set annotation on a node to trigger scraping of the <code class="code">prom2</code> and <code class="code">haproxy</code> services as defined in the above configuration.</p></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-4a807cfa-00a7-9d60-245d-908a891c9741"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Preparing Container Environments</h2></div></div></div><p>An example configuration for Docker environment is given below:</p><pre class="programlisting">prometheus:
  remote_services:
        - prom_container:
            container.label.com.sysdig.scrape_xyz: true
            conf:
                url: "https://xyz:5005/metrics"
                tags:
                    host: xyz
                    service: xyz</pre><p>In order for remote scraping to work in a Docker-based container environment, set the <code class="code">com.sysdig.scrape_xyz=true</code> label to the Agent container. For example:</p><pre class="programlisting">
docker run -d --name sysdig-agent --restart always --privileged --net host --pid host -e ACCESS_KEY=&lt;KEY&gt; -e COLLECTOR=&lt;COLLECTOR&gt; -e SECURE=true -e TAGS=example_tag:example_value -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --shm-size=512m sysdig/agent</pre><p>Substitute &lt;<code class="code">KEY</code>&gt;, &lt;<code class="code">COLLECTOR</code>&gt;, <code class="code">TAGS</code> with your account key, collector, and tags respectively.</p></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-01e66e40-ee34-1ca9-a831-235ae3c2e28e"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Syntax of the Rules</h2></div></div></div><p>The syntax of the rules for the<code class="code">remote_services</code>is almost identical to those of<code class="code">process_filter</code>with an exception to the include/exclude rule. The<code class="code">remote_services</code>section does not use include/exclude rules. The<code class="code">process_filter</code>uses include and exclude rules of which only the first match against a process is applied, whereas, in the<code class="code">remote_services</code>section, each rule has a corresponding service name and all the matching rules are applied.</p></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-bfb18a6d-c945-ac76-ec13-ad6377a8f03b"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Rule Conditions</h2></div></div></div><p>The rule conditions work the same way as those for the <code class="code">process_filter</code>. The only caveat is that the rules will be matched against the Agent process and container because the remote process/context is unknown. Therefore, matches for container labels and annotations work as before but they must be applicable to the Agent container as well. For instance, node annotations will apply because the Agent container runs on a node.</p><p>For annotations, multiple patterns can be specified in a single rule, in which case all patterns must match for the rule to be a match (AND operator). In the following example, the endpoint will not be considered unless both the annotations match:</p><pre class="programlisting">
kubernetes.node.annotation.sysdig.com/region_scraper: europe
kubernetes.node.annotation.sysdig.com/scraper: true</pre><p>That is, Kubernetes nodes belonging to only the Europe region are considered for scraping.</p></section><section xml:lang="en" dir="ltr" class="section xinclude lang-en xinclude" data-origin-id="" data-publication-date="" id="UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-5310f161-849c-0d7e-9a96-8216e8422c54"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Authenticating Sysdig Agent</h2></div></div></div><p>Sysdig Agent requires necessary permissions on the remote host to scrape for metrics. The <a class="link" href="">authentication methods</a> for local scraping works for authenticating Agents on remote hosts as well, but the authorization parameters work only in the Agent context.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Authentication based on certificate-key pair requires it to be constructed into Kubernetes secret and mounted to the agent.</p></li><li class="listitem"><p>In token-based authentication, make sure the agent token has access rights on the remote endpoint to do the scraping.</p></li><li class="listitem"><p>Use annotation to retrieve username/password instead of passing them in plaintext. Any annotation enclosed in curly braces will be replaced by the value of the annotation. If the annotation doesn't exist the value will be an empty string. Token substitution is supported for all the authorization parameters. Because authorization works only in the Agent context, credentials cannot be automatically retrieved from the target pod. Therefore, use an annotation in the Agent pod to pass them. To do so, set the password into an annotation for the selected Kubernetes object.</p></li></ul></div><p>In the following example, an haproxy account is authenticated with the password supplied in the <code class="code"> <a class="link" href="http://yourhost.com/haproxy_password" target="_blank">yourhost.com/haproxy_password</a> </code> annotation on the Agent node.</p><pre class="programlisting">- haproxy:
            kubernetes.node.annotation.yourhost.com/haproxy_scraper: true
            conf:
                host: "mymasternode"
                port: 1936
                path: "/metrics"
                username: "{kubernetes.node.annotation.yourhost.com/haproxy_username}"
                password: "{kubernetes.node.annotation.yourhost.com/haproxy_password}"
                tags:
                    service: router</pre></section></section><div class="footer-content"><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17">Collecting Prometheus Metrics from Remote Hosts</a></li><li><a href="#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-59094113-ccae-3e4e-38a2-ca3ca5a7a4bd">Preparing the Configuration File</a></li><li><a href="#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-4a807cfa-00a7-9d60-245d-908a891c9741">Preparing Container Environments</a></li><li><a href="#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-01e66e40-ee34-1ca9-a831-235ae3c2e28e">Syntax of the Rules</a></li><li><a href="#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-bfb18a6d-c945-ac76-ec13-ad6377a8f03b">Rule Conditions</a></li><li><a href="#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-5310f161-849c-0d7e-9a96-8216e8422c54">Authenticating Sysdig Agent</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div class="voting-title">Was this helpful?</div><div class="btn-group btn-group-toggle" data-toggle="buttons"><button id="feedback-yes-btn" class="btn toggle-yes">Yes</button><button id="feedback-no-btn" class="btn">No</button></div><div id="email-feedback" class=" toggle-feedback"><p><a href='mailto:radhika@sysdig.com?subject=Feedback for help topic "Collecting Prometheus Metrics from Remote Hosts"&amp;body=%0D%0A_______________________%0D%0A%0D%0A
			
			Please add your feedback above for topic "Collecting Prometheus Metrics from Remote Hosts" in the publication "Sysdig Integrations".'><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon voting-feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="49413-logging-and-troubleshooting.html#UUID-5752b7fe-d51d-819a-3270-d8db55f4c7a6_UUID-a7ba61ef-cf4e-105d-1b3a-8d442f5a254a">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="49416-collecting-prometheus-metrics-from-remote-hosts.html#UUID-d8464a99-a7f9-bce3-b522-fb9686df1d17_UUID-59094113-ccae-3e4e-38a2-ca3ca5a7a4bd">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
