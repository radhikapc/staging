<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="no"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Expanded Upgrade Kubernetes Installations for Sysdig Platform v. 1765</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d6593bb1e613.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="17666-expanded-upgrade-kubernetes-installations-version-2-3-0.html" title="Expanded Upgrade Kubernetes Installations version 2.3.0"></link><link rel="next" href="17668-expanded-upgrade-kubernetes-installations-version-2304--2266,-2172-.html" title="Expanded Upgrade Kubernetes Installations version 2304 (2266, 2172)"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
			$(document).ready(function() {
				/**
				 * @type {array}
				 */
				var supported = hljs.listLanguages();

				$('pre:not(.embedcode)').each(function() {
					/**
					 * @type {string}
					 */
					var language = $(this).data('language');

					if (language === 'plaintext' || language === 'text') {
						$(this).addClass(language).addClass('hljs');
						return true;
					}

					if (language && $.inArray(language, supported) > -1) {
						var c = hljs.highlight(language, $(this).text());
						$(this)
							.empty()
							.append(c.value)
							.addClass("hljs")
							.addClass(c.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><ul class="toc nav nav-site-sidebar"><li><a href="17625-sysdig-platform.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-d7f578b2-c960-970c-a969-10cebb31d199" data-permalink="17625-sysdig-platform.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Sysdig Platform</a><ul><li><a href="17626-on-premises-deployments.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-b0fbda15-008f-f5ef-e82b-44edcdbddf2f" data-permalink="17626-on-premises-deployments.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> On-Premises Deployments</a><ul><li><a href="17627-architecture---system-requirements.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-cd539f11-f1ce-b46c-2e31-33817e7fbcfe" data-permalink="17627-architecture---system-requirements.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Architecture &amp; System Requirements</a></li><li><a href="17636-on-premises-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-f3f2b80c-ab17-0417-e900-5e28acb4e13d" data-permalink="17636-on-premises-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">On-Premises Installation</a></li><li><a href="17660-on-premises-upgrades.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-56e8e98a-2ab4-6b39-ba6e-35eee1e169cc" data-permalink="17660-on-premises-upgrades.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">On-Premises Upgrades</a></li><li><a href="17672-find-the-super-admin-credentials-and-api-token.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-cb40fc4f-b85a-8739-4a4e-0a9009419723" data-permalink="17672-find-the-super-admin-credentials-and-api-token.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Find the Super Admin Credentials and API Token</a></li><li><a href="17674-upgrade-an-on-premises-license.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ec730506-5804-f830-4a75-644e44406dff" data-permalink="17674-upgrade-an-on-premises-license.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Upgrade an On-Premises License</a></li><li><a href="17675-securing-elasticsearch.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e5a2a6fa-12cf-e145-8643-4d17b5e5e809" data-permalink="17675-securing-elasticsearch.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Securing Elasticsearch</a></li><li><a href="17677-securing-cassandra.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-e0ca8e47-108a-cdd2-9661-7a7a53b9da47" data-permalink="17677-securing-cassandra.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Securing Cassandra</a></li><li><a href="17678-authentication-and-authorization--on-prem-options-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-059259c5-41cc-52f1-27db-8692bce591a4" data-permalink="17678-authentication-and-authorization--on-prem-options-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Authentication and Authorization (On-Prem Options)</a></li><li><a href="17700---backup-and-restore-best-practices--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-86ef3d03-037d-7aac-2390-c43096ed0cde" data-permalink="17700---backup-and-restore-best-practices--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Backup and Restore Best Practices**</a></li></ul></li><li><a href="17701-sysdig-agent.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ee770b85-3c82-28cf-48e0-a38a6f973bc1" data-permalink="17701-sysdig-agent.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Sysdig Agent</a><ul><li><a href="17703-host-requirements-for-agent-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-813a9695-5e30-e72f-2e2c-26c84ddecb33" data-permalink="17703-host-requirements-for-agent-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Host Requirements for Agent Installation</a></li><li><a href="17705-agent-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-1bbdf1e4-3277-cf2c-d247-de7a1d067e70" data-permalink="17705-agent-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Installation</a></li><li><a href="17720-agent-configuration.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5595fb10-5c8e-1d38-1652-275b75d701cf" data-permalink="17720-agent-configuration.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Configuration</a></li><li><a href="17740-agent-upgrade.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-a2991ad8-39da-4686-6ca1-d0838e93e523" data-permalink="17740-agent-upgrade.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Upgrade</a></li><li><a href="17741---agent-stop---start---disable---remove.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-34276f78-88ad-274e-0736-c6ccf91b5aaa" data-permalink="17741---agent-stop---start---disable---remove.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Agent Stop | Start | Disable | Remove</a></li><li><a href="17742-agent-uninstall.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-ead96597-570b-8e87-7eef-ce217e0b7b3b" data-permalink="17742-agent-uninstall.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Uninstall</a></li><li><a href="17744-troubleshooting-agent-installation.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-4c9eb77e-478d-6fe5-84d3-3e8f86cd8cb7" data-permalink="17744-troubleshooting-agent-installation.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Troubleshooting Agent Installation</a></li><li><a href="17745---copy-of-host-requirements-for-agent-installation--.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5fed75f2-49db-93e2-69e1-12a3100c50c6" data-permalink="17745---copy-of-host-requirements-for-agent-installation--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">**Copy of Host Requirements for Agent Installation**</a></li></ul></li><li><a href="17746-administration-settings.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-79535d85-dcdb-4dfd-1b55-de1edacb346d" data-permalink="17746-administration-settings.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Administration Settings</a><ul><li><a href="17748-user-profile-and-password.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-07096ea3-1ed7-934f-683e-9d0000edc6f7" data-permalink="17748-user-profile-and-password.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">User Profile and Password</a></li><li><a href="17750-user-and-team-administration.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-c24fe2df-c073-159f-5ad6-cd18bc15c2d3" data-permalink="17750-user-and-team-administration.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">User and Team Administration</a></li><li><a href="17755-notifications-management.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-156d27b4-e0d2-ec69-bac9-5ec0500ca128" data-permalink="17755-notifications-management.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Notifications Management</a></li><li><a href="17768-aws--integrate-aws-account-and-cloudwatch-metrics--optional-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-6d00fdd3-1f49-e49e-bb0b-556c377d07ac" data-permalink="17768-aws--integrate-aws-account-and-cloudwatch-metrics--optional-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">AWS: Integrate AWS Account and CloudWatch Metrics (Optional)</a></li><li><a href="17771-storage--configure-aws-capture-file-storage--optional-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-d7ff24b5-cfc5-ac9d-767d-ef7dc9d2d9c5" data-permalink="17771-storage--configure-aws-capture-file-storage--optional-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Storage: Configure AWS Capture File Storage (Optional)</a></li><li><a href="17772-find-your-customer-number.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-703bf9f7-20e0-a6e2-cecc-f5a66cbcd977" data-permalink="17772-find-your-customer-number.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Find Your Customer Number</a></li><li><a href="17774-agent-installation--overview-and-key.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-2d64062a-c3ab-484f-5b45-3b0ef8b3b5b8" data-permalink="17774-agent-installation--overview-and-key.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Agent Installation: Overview and Key</a></li><li><a href="17775-subscription--change-number-of-licensed-agents.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-5d8a57ce-6bd9-b5f6-6460-17b233e4facc" data-permalink="17775-subscription--change-number-of-licensed-agents.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Subscription: Change Number of Licensed Agents</a></li><li><a href="17779-authentication-and-authorization--saas-.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-91fa12e3-2fc9-97ab-1bf8-6d9830e4ad84" data-permalink="17779-authentication-and-authorization--saas-.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Authentication and Authorization (SaaS)</a></li></ul></li><li><a href="17794-get-help---using-sysdig-support.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-712b3b75-2584-30e3-5bd9-e1e57d3d8756" data-permalink="17794-get-help---using-sysdig-support.html" data-topic-level="1" data-relative-prefix="" data-publication-date=""><span class="glyphicon"></span> Get Help | Using Sysdig Support</a><ul><li><a href="17795-self-help.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-39aa92d8-58c3-29d4-582f-4561a368c52f" data-permalink="17795-self-help.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Self-Help</a></li><li><a href="17797-contact-support.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-65fd6b5e-1ab7-6714-888b-95192ae78a5d" data-permalink="17797-contact-support.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Contact Support</a></li><li><a href="17802-terms-of-use.html" class="topic-link section original-topic lang-en original-topic" data-origin-id="UUID-b854f38e-12bc-b1af-1c03-372f7a4234d1" data-permalink="17802-terms-of-use.html" data-topic-level="1" data-relative-prefix="" data-publication-date="">Terms of Use</a></li></ul></li></ul></li></ul></aside><div class="site-content"><h1 class="publication-title">SP (Sysdig Platform)</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="17666-expanded-upgrade-kubernetes-installations-version-2-3-0.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="17668-expanded-upgrade-kubernetes-installations-version-2304--2266,-2172-.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <span class="current-category">SP (Sysdig Platform)</span></li><li class="breadcrumb-link"><a href="17625-sysdig-platform.html">Sysdig Platform</a></li><li class="breadcrumb-link"><a href="17626-on-premises-deployments.html">On-Premises Deployments</a></li><li class="breadcrumb-link"><a href="17660-on-premises-upgrades.html">On-Premises Upgrades</a></li><li class="breadcrumb-node">Expanded Upgrade Kubernetes Installations for Sysdig Platform v. 1765</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-103bf8ff-053a-66d5-34fc-b79463c50c72" data-permalink="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-06ebb487-d368-384d-836b-17682b6295ff"><div class="titlepage"><div><div class="title"><h1 class="title" style="clear: both">Expanded Upgrade Kubernetes Installations for Sysdig Platform v. 1765</h1></div></div></div><p>Sysdig platform on-premises releases are listed <a class="link" href="https://github.com/draios/sysdigcloud-kubernetes/releases" target="_blank">here</a>. Each release has a version number and specific release notes.</p><p>The v. 1765 release of Sysdig Platform includes a scanning feature in Sysdig Secure which requires some additional upgrade steps.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p> <span class="bold bold"><strong>If you are running only Sysdig Monitor, and do not want to use Sysdig Secure, you can perform a simpler upgrade.</strong></span> </p><p>In this case, you would:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Apply at minimum the mandatory releases, as listed here: <a class="link" href="17660-on-premises-upgrades.html" title="On-Premises Upgrades">On-Premises Upgrades</a>.</p></li><li class="step"><p>Run the <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Platform/pages/319782952/Migration+Tool+for+MySQL+to+MariaDB+Connector+Switch+prereq+for+upgrading+to+3+1+19" target="_blank">Migration Tool</a>.</p></li><li class="step"><p>Run the <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Platform/pages/236421227/Upgrade+Kubernetes+Installations" target="_blank">basic Kubernetes Upgrade</a>.</p></li></ol></div></div><div dir="ltr" class="warning warning"><h3 class="title">Warning</h3><p> <span class="bold bold"><strong>If you are running Sysdig Secure on OpenShift,</strong></span> contact Sysdig Support for assistance upgrading to v. 1765.</p></div><p>If you are running both Sysdig Monitor and Sysdig Secure (aka Sysdig Platform), use the instructions on this page.</p><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Overview" class="bridgehead">Overview</h6><p>The 1765 release of the Sysdig Platform supports the Sysdig Secure image scanning feature. Upgrading to this release requires adding components and changing existing components in your current Sysdig Platform implementation.</p><p>These are the major changes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>All ingress now uses an ingress controller.</p></li><li class="listitem"><p>An additional database on the existing mysql deployment is required if you are using Sysdig Secure.</p></li><li class="listitem"><p>There are additional Kubernetes services, deployments, and statefulsets.</p></li><li class="listitem"><p>The “<code class="code">sysdigcloud-config</code>” configmap has added many new key/values.</p></li><li class="listitem"><p>There are new Kubernetes secrets that are referenced by some components.</p></li></ul></div><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-BeforeYouUpgrade" class="bridgehead">Before You Upgrade</h6><p>Before upgrading to v. 1765, you must:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Apply at minimum the mandatory releases, as listed here: <a class="link" href="17660-on-premises-upgrades.html" title="On-Premises Upgrades">On-Premises Upgrades</a>.</p></li><li class="step"><p>Run a <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Platform/pages/319782952/Migration+Tool+for+MySQL+to+MariaDB+Connector+Switch+prereq+for+upgrading+to+3+1+19" target="_blank">Migration Tool</a>.</p></li><li class="step"><p>Complete all the installation steps on this page.</p></li></ol></div><div dir="ltr" class="warning warning"><h3 class="title">Warning</h3><p>It is highly recommended to follow upgrade best practices:</p><div class="itemizedlist"><ul style="list-style-type: disc; " class="itemizedlist"><li class="listitem"><p>Keep upgrades current</p></li><li class="listitem"><p>Upgrade progressively without skipping versions, and</p></li><li class="listitem"><p>Test upgrades in a non-mission-critical or staging environment before rolling into production.</p></li></ul></div></div><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Steps" class="bridgehead">Steps</h6><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step1Downloadthesysdigcloud-kubernetesrelease" class="bridgehead">Step 1 Download the sysdigcloud-kubernetes release</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Download the latest release of the sysdigcloud-kubernetes repo from<a class="link" href="https://github.com/draios/sysdigcloud-kubernetes/releases/latest" target="_blank">https://github.com/draios/sysdigcloud-kubernetes/releases/latest</a> </p></li><li class="listitem"><p>Unpack the .<code class="code">tar</code> file.</p></li></ul></div><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step2Updateexistingconfigmapsandaddsecrets" class="bridgehead">Step 2 Update existing configmaps and add secrets</h6><p>Edit the <code class="code">sysdigcloud-config </code>configmap and copy in the new <code class="code">Scanning and Anchore</code> section from <code class="code">sysdigcloud/config.yaml: </code> </p><pre class="programlisting">kubectl -n sysdigcloud edit configmap sysdigcloud-config</pre><p>Create the scanning and anchore secrets:</p><pre class="programlisting">kubectl -n sysdigcloud apply -f ./sysdigcloud/scanning-secrets.yaml
kubectl -n sysdigcloud apply -f ./sysdigcloud/anchore-secrets.yaml</pre><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step3AddadatabasetoMySQLdeployment" class="bridgehead">Step 3 Add a database to MySQL deployment</h6><p>You must manually create a new database on your existing MySQL endpoint and create a user and password for it. This database will be used by the scanning feature.</p><p>Log in to your existing MySQL RDBMS and connect via the <code class="code">mysql cli</code> program with the <code class="code">root</code> user:</p><pre class="programlisting">kubectl -n sysdigcloud get pods
kubectl -n sysdigcloud exec -it &lt;any-mysql-pod&gt; bash
mysql --user=root --password=change_me
   CREATE DATABASE IF NOT EXISTS `sysdig_scanning` ;
   CREATE USER 'scanninguser'@'%' IDENTIFIED BY 'change_me' ;
   GRANT ALL ON `sysdig_scanning`.* TO 'scanninguser'@'%' ;
   FLUSH PRIVILEGES ;
</pre><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step4AddPostgresstatefulsetandservice" class="bridgehead">Step 4 Add Postgres statefulset and service</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Define the storage class that Postgres will use by editing the<code class="code">./datastores/as_kubernetes_pods/manifests/postgres/postgres-statefulset.yaml</code>file, and changing the <code class="code">storageClassName</code>” setting to the desired storage class.</p></li><li class="step"><p>Create the Postgres statefulset and service:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./datastores/as_kubernetes_pods/manifests/postgres/postgres-statefulset.yaml
kubectl -n sysdigcloud create -f ./datastores/as_kubernetes_pods/manifests/postgres/postgres-service.yaml</pre></li><li class="step"><p>Wait for the Postgres statefulset to be running before proceeding.</p></li></ol></div><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step5Addanchorecoreandworkerdeploymentsandservices" class="bridgehead">Step 5 Add anchore core and worker deployments and services</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Create the anchore configmaps:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./sysdigcloud/anchore-core-config.yaml
kubectl -n sysdigcloud create -f ./sysdigcloud/anchore-worker-config.yaml</pre></li><li class="step"><p>Create the anchore core deployment:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./sysdigcloud/anchore-core-deployment.yaml</pre><p>Wait for the anchore core pod to be running before proceeding.</p></li><li class="step"><p>Create the remaining anchore kubernetes objects:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./sysdigcloud/anchore-worker-deployment.yaml
kubectl -n sysdigcloud create -f ./sysdigcloud/anchore-service.yaml</pre></li></ol></div><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step6Addthescanningdeploymentsandservice" class="bridgehead">Step 6 Add the scanning deployments and service</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Create the scanning api deployment:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./sysdigcloud/scanning-api-deployment.yaml</pre><p>Wait for the <code class="code">scanning-api</code> pod to be running before proceeding.</p></li><li class="step"><p>Create the remaining scanning kubernetes objects:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./sysdigcloud/scanning-alertmgr-deployment.yaml
kubectl -n sysdigcloud create -f ./sysdigcloud/scanning-service.yaml</pre></li></ol></div><h6 id="UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step7AddtheingresscontrollerandredirectincomingAPIUItraffictoit" class="bridgehead">Step 7 Add the ingress controller and redirect incoming API/ UI traffic to it</h6><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>There will be a disruption in running agents during this upgrade while services are modified.</p></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Remove the following services:</p><pre class="programlisting">kubectl -n sysdigcloud delete service sysdigcloud-api
kubectl -n sysdigcloud delete service sysdigcloud-collector</pre></li><li class="step"><p>Create the <code class="code"> <a class="link" href="https://github.com/draios/sysdigcloud-kubernetes/blob/onprem-2019-02/sysdigcloud/api-headless-service.yaml" target="_blank">api-headless-service</a> </code> service:</p><pre class="programlisting">kubectl -n sysdigcloud create -f ./sysdigcloud/api-headless-service.yaml</pre></li><li class="step"><p>Create the ingress controller:</p><ol type="a" class="substeps"><li class="step"><p>Define <code class="code">&lt;namespace&gt;</code> in <code class="code">ingress-clusterrolebinding.yaml</code>. (In this document, we use <code class="code">sysdigcloud</code>).</p><pre class="programlisting">subjects:  
- kind: ServiceAccount    
  name: ingress-controller    
  namespace: &lt;namespace&gt;</pre></li><li class="step"><p>Edit the DNS entries in <code class="code">api-ingress-with-secure.yaml</code> for your environment:</p><pre class="programlisting">spec:
  rules:
    - host: &lt;EXTERNAL-DNS-NAME&gt;
      http:
        paths:
          - backend:
              serviceName: sysdigcloud-api
              servicePort: 8080 
            path: /
  tls:
    - hosts:
        - &lt;EXTERNAL-DNS-NAME&gt;</pre></li><li class="step"><p>Deploy the ingress yaml files:</p><pre class="programlisting">kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-clusterrole.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-clusterrolebinding.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-role.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-rolebinding.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-serviceaccount.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/default-backend-service.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/default-backend-deployment.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-configmap.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-tcp-services-configmap.yaml
kubectl -n sysdigcloud create -f sysdigcloud/ingress_controller/ingress-daemonset.yaml
kubectl -n sysdigcloud create -f sysdigcloud/api-ingress-with-secure.yaml</pre></li></ol></li></ol></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Overview" title="Overview">Overview</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-BeforeYouUpgrade" title="Before You Upgrade">Before You Upgrade </a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Steps" title="Steps">Steps</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step1Downloadthesysdigcloud-kubernetesrelease" title="Step 1 Download the sysdigcloud-kubernetes release">Step 1 Download the sysdigcloud-kubernetes release</a> </p></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step2Updateexistingconfigmapsandaddsecrets" title="Step 2 Update existing configmaps and add secrets">Step 2 Update existing configmaps and add secrets</a> </p></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step3AddadatabasetoMySQLdeployment" title="Step 3 Add a database to MySQL deployment">Step 3 Add a database to MySQL deployment</a> </p></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step4AddPostgresstatefulsetandservice" title="Step 4 Add Postgres statefulset and service">Step 4 Add Postgres statefulset and service</a> </p></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step5Addanchorecoreandworkerdeploymentsandservices" title="Step 5 Add anchore core and worker deployments and services">Step 5 Add anchore core and worker deployments and services</a> </p></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step6Addthescanningdeploymentsandservice" title="Step 6 Add the scanning deployments and service">Step 6 Add the scanning deployments and service</a> </p></li><li class="listitem"><p> <a class="link" href="17667-expanded-upgrade-kubernetes-installations-for-sysdig-platform-v--1765.html#UUID-06ebb487-d368-384d-836b-17682b6295ff_id_ExpandedUpgradeKubernetesInstallationsforSysdigPlatformv1765-Step7AddtheingresscontrollerandredirectincomingAPIUItraffictoit" title="Step 7 Add the ingress controller and redirect incoming API/ UI traffic to it">Step 7 Add the ingress controller and redirect incoming API/ UI traffic to it</a> </p></li></ul></div></li></ul></div></section><div class="footer-content"><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div class="voting-title">Was this helpful?</div><div class="btn-group btn-group-toggle" data-toggle="buttons"><button id="feedback-yes-btn" class="btn toggle-yes">Yes</button><button id="feedback-no-btn" class="btn">No</button></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="17666-expanded-upgrade-kubernetes-installations-version-2-3-0.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="17668-expanded-upgrade-kubernetes-installations-version-2304--2266,-2172-.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
