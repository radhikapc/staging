<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta charset="UTF-8"></meta><meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700|Material+Icons" rel="stylesheet"></link><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>**Image Scanning and Vulnerability Management**</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/5d40bfcded91c.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/fuse.min.js" type="text/javascript"></script><script src="../js/hilitor.js" type="text/javascript"></script><script src="../js/html5.fuse.search.js" type="text/javascript"></script><script src="js/fuzzydata.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta xmlns:xlink="http://www.w3.org/1999/xlink" name="generator" content="Paligo"></meta><link rel="prev" href="26547-12910-empty-or-missing-topic.html" title="Empty or missing topic"></link><link rel="next" href="26547-12923-compliance.html" title="Compliance"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script>
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				$('.materialboxed').materialbox();
				});
			</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/googlecode.min.css"></link><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script><script type="text/javascript">
				$(document).ready(function(){
				var lang = hljs.listLanguages();
				$('pre:not(.embedcode)').each(function(){
				if ($(this).data('language') && $.inArray($(this).data('language'), lang) > -1) {
					var code = hljs.highlight($(this).data('language'), $(this).text());
						$(this).empty().append(code.value).addClass("hljs").addClass(code.language);
					} else {
						hljs.highlightBlock(this);
					}
				});
			});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="https://478h5m1yrfsa3bbe262u7muv-wpengine.netdna-ssl.com/wp-content/themes/sysdig/assets/images/logo-sysdig-black.svg" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="https://478h5m1yrfsa3bbe262u7muv-wpengine.netdna-ssl.com/wp-content/themes/sysdig/assets/images/logo-sysdig-black.svg" target="_blank"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Sysdig Documentation</h1><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="top-nav-menu sm sm-simple"></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="26547-12910-empty-or-missing-topic.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="26547-12923-compliance.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link">Â <span class="current-category">Sysdig Documentation</span></li><li class="breadcrumb-link"><a href="26547-11020-sysdig-secure.html">Sysdig Secure</a></li><li class="breadcrumb-link"><a href="26547-12907-image-scanning.html">Image Scanning</a></li><li class="breadcrumb-node">**Image Scanning and Vulnerability Management**</li></ul></div><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-ec42cd90-0a32-d922-5541-3906277f03bc" data-permalink="26547-12911---image-scanning-and-vulnerability-management--.html" data-topic-level="1" data-relative-prefix="" data-publication-date="" id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc"><div class="titlepage"><div><div class="title"><h4 class="title">**Image Scanning and Vulnerability Management**</h4></div></div></div><p>Image scanning allows you to scan container images for vulnerabilities, secrets, license violations, and more. It can be used as part of a development build process as well as for scanning your container registry.</p><p>The <code class="code">Runtime</code> panel provides a continuously updated report on the images in your environment.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-80949041-49ff-3420-cab1-f0f6cee6c3b3-en.png" style="max-width: 600px; " alt="341803058.png"></img></td></tr></table></div><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-Contents"><div class="titlepage"><div><div class="title"><h5 class="title">Contents</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-HowitWorks" title="How it Works">How it Works</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-UseCases" title="Use Cases">Use Cases </a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>  Scanning During Container Development (DevOps) </p></li><li class="listitem"><p>  Scanning Running Containers (Security Personnel)  </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-GetStarted" title="Get Started">Get Started</a> </p></li></ul></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-HowitWorks"><div class="titlepage"><div><div class="title"><h5 class="title">How it Works</h5></div></div></div><p>The basic set up for image scanning is simple: provide registry information where your images are stored, trigger a scan, and review the results.</p><p>Behind the scenes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Image contents are analyzed.</p></li><li class="listitem"><p>The contents report is evaluated against multiple vulnerability databases.</p></li><li class="listitem"><p>It is then compared against default or user-defined policies.</p></li><li class="listitem"><p>Results are reported, both in Sysdig Secure and (if applicable) in a developer's external CI tool.</p></li></ul></div><h6 id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-ImageContentsReported" class="bridgehead">Image Contents Reported</h6><p>The analysis generates a detailed report of the image contents, including:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Official OS packages</p></li><li class="listitem"><p>Unofficial OS packages</p></li><li class="listitem"><p>Configuration files</p></li><li class="listitem"><p>Credentials files</p></li><li class="listitem"><p>Localization modules and software-specific installers:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Javascript with NPM</p></li><li class="listitem"><p>Python PiP</p></li><li class="listitem"><p>Ruby with GEM</p></li><li class="listitem"><p>Java/JVM with .jar archives</p></li></ul></div></li><li class="listitem"><p>Image metadata and configuration attributes</p></li></ul></div><h6 id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-VulnerabilityDatabasesUsed" class="bridgehead">Vulnerability Databases Used</h6><p>Sysdig Secure continuously checks against a wide range of vulnerability databases, updating the Runtime scan results with any newly detected CVEs.</p><p>The current database list includes:</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows" style="width: 68.92%;"><colgroup><col></col></colgroup><tbody><tr><td class="td"><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;"><tr style="height: 150px"><td><img src="image/uuid-941a3ffb-6f47-9213-752a-869e71ac92a7-en.png" style="max-height: 150px; " alt="340623391.png"></img></td></tr></table></div><p> <a class="link" href="https://www.cvedetails.com/vulnerability-list/vendor_id-10167/product_id-18131/Centos-Centos.html" target="_blank"> Centos</a> <a class="link" href="https://security-tracker.debian.org/tracker/" target="_blank">Debian</a> <a class="link" href="https://www.ruby-lang.org/en/security/" target="_blank">Ruby</a> <a class="link" href="https://www.redhat.com/security/data/metrics/" target="_blank">Red Hat</a> <a class="link" href="https://people.canonical.com/~ubuntu-security/cve/" target="_blank">Ubuntu</a> <a class="link" href="https://www.cvedetails.com/vulnerability-list/vendor_id-10210/product_id-18230/Python-Python.html" target="_blank">Python</a> </p><p> <a class="link" href="https://www.cvedetails.com/" target="_blank">CVE</a> <a class="link" href="https://nvd.nist.gov/" target="_blank">NIST</a> <a class="link" href="https://www.npmjs.com/advisories" target="_blank">NPM</a> <a class="link" href="https://www.cvedetails.com/vulnerability-list/vendor_id-16697/product_id-38838/Alpinelinux-Alpine-Linux.html" target="_blank">Alpine</a> <a class="link" href="https://nvd.nist.gov/" target="_blank">NVD</a> </p></td></tr></tbody></table></div><h6 id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-PolicyandAlertRefinements" class="bridgehead">Policy and Alert Refinements</h6><p>Vulnerabilities are compared against the default scanning policies included with Sysdig Secure.</p><p>Users can also:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>add and edit policies</p></li><li class="listitem"><p>assign policies to particular registries, images, or tags</p></li><li class="listitem"><p>whitelist or blacklist particular CVEs or images</p></li><li class="listitem"><p>configure scanning alerts</p></li><li class="listitem"><p>trigger auto-scans.</p></li></ul></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-UseCases"><div class="titlepage"><div><div class="title"><h5 class="title">Use Cases</h5></div></div></div><p>As an organization, you define what is an acceptable, secure, reliable image running in your environment. Image scanning for the development pipeline follows a somewhat different flow than for security personnel.</p><h6 id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-ScanningDuringContainerDevelopmentDevOps" class="bridgehead">Scanning During Container Development (DevOps)</h6><p> <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/340656202/Integrate+Image+Scanning+into+Development+Pipeline" target="_blank">Use image scanning as part of your development pipeline,</a> to check for best practices, vulnerabilities, and sensitive content.</p><p>To begin:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <span class="bold bold"><strong>Add Registry: </strong></span>Add a registry where your images are stored, along with the credentials necessary to access them.</p></li><li class="listitem"><p> <span class="bold bold"><strong>Integrate CI Tool: </strong></span>Integrate image scanning with an external CI tool, using the Jenkins plugin or building your own integration from a SysdigLabs solution.</p></li><li class="listitem"><p> <span class="bold bold"><strong>Scan Image(s): </strong></span>The plugin or CLI integration triggers the image scanning process. Failed builds will be stopped, if so configured.</p></li><li class="listitem"><p> <span class="bold bold"><strong>Review Results (in CI tool): </strong></span>Developers can analyze the results in the integrated CI tool (Jenkins).</p><p>(Optionally: add policies or refine the default policies to suit your needs, assign policies to particular images or tags, and configure alerts and notifications.)</p></li></ul></div><h6 id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-ScanningRunningContainersSecurityPersonnel" class="bridgehead">Scanning Running Containers (Security Personnel)</h6><p>Security personnel use image scanning to monitor which containers are running, their scan status, and whether new vulnerabilities are present in their images.</p><p>To begin:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <span class="bold bold"><strong>Add Registry: </strong></span>Add a registry where your images are stored, along with the credentials necessary to access them.</p></li><li class="listitem"><p> <span class="bold bold"><strong>Scan Image(s): </strong></span>Trigger an image scan (manually or by configuring an alert to auto-scan).</p></li><li class="listitem"><p> <span class="bold bold"><strong>Review Results (in Sysdig Secure): </strong></span>Security personnel can analyze scan results in the Sysdig Secure image scanning UI.</p><p>(Optionally: add policies or refine the default policies to suit your needs, assign policies to particular images or tags, and configure alerts and notifications.)</p></li></ul></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-GetStarted"><div class="titlepage"><div><div class="title"><h5 class="title">Get Started</h5></div></div></div><p>Refer to the pages in this section to begin scanning the container images in your environment.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88" title="**Integrate Image Scanning into Development Pipeline**">**Integrate Image Scanning into Development Pipeline**</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da" title="**Manage Registry Credentials**">**Manage Registry Credentials**</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-67620761-4915-e657-1b0b-aa0f82bd4333" title="**Scan Images**">**Scan Images**</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae" title="**Manage Scanning Policies**">**Manage Scanning Policies**</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23" title="**Manage Scanning Alerts**">**Manage Scanning Alerts**</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-daebbc6b-24fa-d149-4429-b831262d8657" title="**Review Scan Results**">**Review Scan Results**</a> </p></li></ul></div></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-c759bfb5-c565-4f18-72d7-a5789684d14b" data-publication-date="" id="UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88"><div class="titlepage"><div><div class="title"><h5 class="title">**Integrate Image Scanning into Development Pipeline**</h5></div></div></div><p>You have the option to use image scanning as part of your development pipeline, to check for best practices, vulnerabilities, and sensitive content.</p><h6 id="UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-IntegratewithJenkins" title="Integrate with Jenkins"> Integrate with Jenkins</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-InstallandConfiguretheJenkinsPlugin" title="Install and Configure the Jenkins Plugin"> Install and Configure the Jenkins Plugin </a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-ObtainScanResultsinJenkins" title="Obtain Scan Results in Jenkins"> Obtain Scan Results in Jenkins</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-AdditionalSolutionsforotherCICDTools" title="Additional Solutions for other CI/CD Tools"> Additional Solutions for other CI/CD Tools </a> </p></li></ul></div><h6 id="UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-IntegratewithJenkins" class="bridgehead">Integrate with Jenkins</h6><p>Sysdig has a plugin to integrate Sysdig image scanning into a Jenkins-based build process.</p><h6 id="UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-InstallandConfiguretheJenkinsPlugin" class="bridgehead">Install and Configure the Jenkins Plugin</h6><p>The <a class="link" href="https://wiki.jenkins.io/display/JENKINS/Sysdig+Secure+Jenkins+Plugin" target="_blank">Sysdig Secure Jenkins Plugin</a> documentation (at j<code class="code">enkins.io</code>) describes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Prerequisites</p></li><li class="listitem"><p>Obtaining the plugin</p></li><li class="listitem"><p>Necessary system configuration steps in the Jenkins UI</p></li><li class="listitem"><p>Adding Sysdig Secure Image Scanning as build step (in the Jenkins UI)</p></li><li class="listitem"><p>Configuring the actions to take on scanned builds (e.g. when to fail a build or issue a warning).</p></li></ul></div><p> <a class="link" href="https://wiki.jenkins.io/display/JENKINS/Sysdig+Secure+Jenkins+Plugin" target="_blank"><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 363px"><td><img src="image/uuid-c3a63879-06f6-080b-722d-d0c024eff638-en.png" style="max-width: 600px; max-height: 363px; " alt="344588335.png"></img></td></tr></table></div></a> </p><h6 id="UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-ObtainScanResultsinJenkins" class="bridgehead">Obtain Scan Results in Jenkins</h6><p>The Sysdig plugin generates a scan report listed in the Jenkins build list: GET AN IMAGE</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="443px"><tr style="height: 250px"><td><img src="image/uuid-9dd4a92d-006a-3c0b-4e18-52b9097bf8c4-en.png" style="max-width: 443px; max-height: 250px; " alt="5ce6e1ee35a83.png"></img></td></tr></table></div><p>Click on the Sysdig Scanning Report to view the summary information and a list of policy checks and results. GET AN IMAGE</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-3d31d21f-1700-0b11-c69c-c894e9937c14-en.png" style="max-width: 600px; " alt="5ce6e1f31cf9c.png"></img></td></tr></table></div><h6 id="UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88_id_id-IntegrateImageScanningintoDevelopmentPipeline-AdditionalSolutionsforotherCICDTools" class="bridgehead">Additional Solutions for other CI/CD Tools</h6><p>Sysdig has also developed reference code for integrating into the build process using other CI/CD tools, such as Bamboo or GitLab.</p><p>These are not fully supported plugins, but rather examples and articles from which to build. They may be promoted as part of <a class="link" href="https://github.com/sysdiglabs/secure-image-scanning" target="_blank">SysdigLabs</a>.</p><p> <a class="link" href="https://sysdig.com/blog/bamboo-sysdig-secure/" target="_blank">This blog</a> describes an integration solution with Atlassian Bamboo:</p><p> <a class="link" href="https://sysdig.com/blog/bamboo-sysdig-secure/" target="_blank"><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-3cfa53de-dc21-f72b-ed52-9d350719f546-en.png" style="max-width: 600px; " alt="344588373.png"></img></td></tr></table></div></a> </p></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-0cdf5df6-0c42-93d2-ecfb-41db27fb9b53" data-publication-date="" id="UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da"><div class="titlepage"><div><div class="title"><h5 class="title">**Manage Registry Credentials**</h5></div></div></div><p>Registry credentials are required for Sysdig Secure to pull and analyze images. Each of the registry types has unique input fields for the credentials required (e.g., <code class="code">username/password</code> for docker.io; <code class="code">JSON key</code> for Google Container Registry).</p><h6 id="UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-AddaNewRegistry" title="Add a New Registry">Add a New Registry</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-EditaRegistry" title="Edit a Registry">Edit a Registry</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-DeleteaRegistry" title="Delete a Registry">Delete a Registry</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-NextSteps" title="Next Steps">Next Steps </a> </p></li></ul></div><h6 id="UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-AddaNewRegistry" class="bridgehead">Add a New Registry</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Registry Credentials</code>.</p></li><li class="step"><p>Click <code class="code">Add Registry</code>.</p><p>The New Registry page is displayed.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="800px"><tr><td><img src="image/uuid-fee2da9c-c655-a7b4-f934-844c8ea2a044-en.png" style="max-width: 800px; " alt="344457217.png"></img></td></tr></table></div></li><li class="step"><p>Enter the <code class="code">Path</code> to the registry. E.g. <code class="code">docker.io</code>.</p></li><li class="step"><p>Select the registry <code class="code">Type</code> from the drop-down menu.</p></li><li class="step"><p>Configure the registry-specific <code class="code">credentials</code> (based on the <code class="code">Type</code> chosen):<code class="code"></code> </p><ol type="a" class="substeps"><li class="step"><p> <span class="bold bold"><strong>Docker V2</strong></span>There are many Docker V2 registries, and the credential requirements may differ.</p><p>For example, for Azure Container Registry:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Admin Account</p><p> <code class="code">Username</code>: in the <code class="code">'az acr credentials show --name &lt;registry name&gt;'</code> command result</p><p> <code class="code">Password</code>: The password or password2 value from the <code class="code">'az acr credentials show'</code> command result</p></li><li class="step"><p>Service Principal</p><p> <code class="code">Username</code>: The service principal app id</p><p> <code class="code">Password</code>: The service principal password</p></li></ol></div></li><li class="step"><p> <span class="bold bold"><strong>AWS ECR:</strong></span> </p><ol type="i" class="substeps"><li class="step"><p>AWS access key</p></li><li class="step"><p>AWS secret key</p></li></ol></li><li class="step"><p> <span class="bold bold"><strong>Google Container Registry:</strong></span> </p><ol type="i" class="substeps"><li class="step"><p>JSON Key</p></li></ol></li></ol></li><li class="step"><p> <span class="bold bold"><strong>(Primarily for OpenShift clusters):</strong></span> Add an <code class="code">internal registry address</code>.</p><p>The recommended way to run an image registry for an OpenShift cluster is to run it locally. The Sysdig agent will detect the internal registry names, but for the Anchore engine to pull and scan the image it needs access to the internal registry itself.</p><p> <span class="bold bold"><strong>Example: </strong></span> </p><p>External name: <code class="code">mytestregistry.example.com</code> </p><p> <span class="bold bold"><strong>Internal name: </strong></span> <code class="code">docker-registry.default.svc:5000</code> </p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>Sysdig maps the internal registry name to the external registry name, so the <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/343015457/Review+Scan+Results" target="_blank"> <code class="code">Runtime</code> and <code class="code">Repository</code> lists</a> will show only the external names.</p></div></li><li class="step"><p>Optional: Toggle the switch to <code class="code">Allow Self-Signed</code> certificates.</p><p>By default, the UI will only pull images from a TLS/SSL-enabled registry.</p><p>Toggle <code class="code">Allow Self-Signed</code> to instruct the UI <span class="bold bold"><strong>not</strong></span> to validate the certificate (if the registry is protected with a self-signed certificate or a cert from an unknown certificate authority).</p></li><li class="step"><p>Optional: Toggle the <code class="code">Test Credentials </code>switch to validate your entries.</p><p>When enabled, Sysdig will attempt to pull the image using the entered credentials. If it succeeds, the registry will be saved. If it fails, you will receive an error and can correct the credentials or image details.</p><p>If enabled, then enter the <code class="code">test registry path</code> in the format :</p><pre class="programlisting">registry/repo:tag  </pre><p>E.g. <span class="bold bold"><strong> <code class="code">quay.io/sysdig/agent:0.89</code> </strong></span> </p></li><li class="step"><p>Click <code class="code">Save</code>.</p></li></ol></div><h6 id="UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-EditaRegistry" class="bridgehead">Edit a Registry</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Registry Credentials</code>.</p></li><li class="step"><p>Select an existing registry to open the <code class="code">Edit</code> window.</p></li><li class="step"><p>Update the parameters as necessary and click <code class="code">Save</code>.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The registry Type cannot be edited.</p></div></li></ol></div><h6 id="UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-DeleteaRegistry" class="bridgehead">Delete a Registry</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Registry Credentials</code>.</p></li><li class="step"><p>Select the existing registry to open the <code class="code">Edit</code> window.</p></li><li class="step"><p>Click <code class="code">Delete Registry </code>and click <code class="code">Yes</code> to confirm the change.</p></li></ol></div><h6 id="UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da_id_id-ManageRegistryCredentials-NextSteps" class="bridgehead">Next Steps</h6><p>When at least one registry has been added successfully, it is possible to <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/341901356/Scan+Images" target="_blank">scan images</a> and <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/343015457/Review+Scan+Results" target="_blank">review scan results</a>, taking advantage of the Default scanning policy provided.</p></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-8ef64ca6-53fb-4c76-00e6-7c40c9e7681b" data-publication-date="" id="UUID-67620761-4915-e657-1b0b-aa0f82bd4333"><div class="titlepage"><div><div class="title"><h5 class="title">**Scan Images**</h5></div></div></div><p>Once you have <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/341770245/Manage+Registry+Credentials" target="_blank">configured registry credentials</a> where images are stored, you can trigger image scans manually or automatically.</p><h6 id="UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-ManuallyScananImage" title="Manually Scan an Image">Manually Scan an Image</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-FromtheRuntimeTab" title="From the Runtime Tab">From the Runtime Tab</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-FromtheRepositoriesTab" title="From the Repositories Tab">From the Repositories Tab</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-AutomaticallyScanImages" title="Automatically Scan Images">Automatically Scan Images</a> </p></li></ul></div><h6 id="UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-ManuallyScananImage" class="bridgehead">Manually Scan an Image</h6><p>When a new image is added to a running environment, it may need to be scanned manually. This can be done from either the <code class="code">Runtime</code> tab, or the <code class="code">Repositories</code> tab.</p><h6 id="UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-FromtheRuntimeTab" class="bridgehead">From the Runtime Tab</h6><p>To manually scan an image from the <code class="code">Runtime</code> tab:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, choose the <code class="code">Runtime</code> tab.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-2292e6c3-4a42-e03d-3168-86dabc7c230a-en.png" style="max-width: 600px; " alt="342982862.png"></img></td></tr></table></div></li><li class="step"><p>Select an image from the list of unscanned images.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-14a00378-4452-ece2-8330-f03b6747d2d4-en.png" style="max-width: 600px; " alt="343015603.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">Scan Now</code>.</p></li></ol></div><h6 id="UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-FromtheRepositoriesTab" class="bridgehead">From the Repositories Tab</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, choose the <code class="code">Repositories</code> tab.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-31ebb482-b880-cc73-ef6d-79c65728e3bc-en.png" style="max-width: 600px; " alt="343048325.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">Scan Image</code>.</p></li><li class="step"><p>Define the path to the image, and click <code class="code">Scan</code>.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-79169b18-d899-3f0f-c9b4-f2387b9eecff-en.png" style="max-width: 600px; " alt="341835816.png"></img></td></tr></table></div></li></ol></div><h6 id="UUID-67620761-4915-e657-1b0b-aa0f82bd4333_id_id-ScanImages-AutomaticallyScanImages" class="bridgehead">Automatically Scan Images</h6><p>Configure a scanning alert to trigger image scanning automatically when an unscanned image is found, by setting the <span class="bold bold"><strong> <code class="code">Unscanned Image</code> </strong></span> trigger drop-down menu to <code class="code">Scan Image.</code> </p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-01ce0630-900f-c87d-9d8e-140b4efb543f-en.png" style="max-width: 600px; " alt="341835820.png"></img></td></tr></table></div><p>See also <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23" title="**Manage Scanning Alerts**">**Manage Scanning Alerts**</a>.</p></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-2c995d98-24ad-f299-18bc-a7b9f635473a" data-publication-date="" id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae"><div class="titlepage"><div><div class="title"><h5 class="title">**Manage Scanning Policies**</h5></div></div></div><p>Image scanning policies define the scenarios in which:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The build process may be stopped, or</p></li><li class="listitem"><p>Administrators may be alerted to potential risks within container images.</p></li></ul></div><p>Each scanning policy is comprised of <span class="italic italic">rules</span> built of <span class="italic italic">gates</span> and <span class="italic italic">triggers</span>. Sysdig includes default policies that can be used to run scans as soon as <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/341770245/Manage+Registry+Credentials" target="_blank">registry credentials</a> have been configured. Users can create additional rules or policies from the available <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a" title="**Scanning Policy Gates and Triggers**">**Scanning Policy Gates and Triggers**</a>.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredPolicies" title="Preconfigured Policies">Preconfigured Policies </a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DefaultPolicy" title="Default Policy">Default Policy</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredCompliancePolicies" title="Preconfigured Compliance Policies">Preconfigured Compliance Policies</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ConfigurationPolicy-DockerfileBestPractices" title="Configuration Policy - Dockerfile Best Practices"> Configuration Policy - Dockerfile Best Practices </a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-NIST800-190" title="Audit Policy - NIST 800-190">Audit Policy - NIST 800-190</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-PCI" title="Audit Policy - PCI">Audit Policy - PCI </a> </p></li></ul></div></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CustomizedPolicies" title="Customized Policies">Customized Policies </a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CreateaNewPolicy" title="Create a New Policy">Create a New Policy</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-EditanExistingPolicy" title="Edit an Existing Policy">Edit an Existing Policy</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DeleteanExistingPolicy" title="Delete an Existing Policy">Delete an Existing Policy</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-WhitelistBlacklist" title="Whitelist/Blacklist">Whitelist/Blacklist</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ManagePolicyAssignments" title="Manage Policy Assignments">Manage Policy Assignments</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AssignaPolicy" title="Assign a Policy">Assign a Policy</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ExampleUseCases" title="Example Use Cases">Example Use Cases</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-UsingPriorities" title="Using Priorities">Using Priorities</a> </p></li></ul></div></li></ul></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredPolicies" class="bridgehead">Preconfigured Policies</h6><p>Sysdig provides four baseline policies that can be used as-is or as templates on which to build.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="700px"><tr><td><img src="image/uuid-77f54c9f-be26-0753-180e-80ae44084881-en.png" style="max-width: 700px; " alt="342327309.png"></img></td></tr></table></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DefaultPolicy" class="bridgehead">Default Policy</h6><p>This policy covers the most common image scanning cases, such as:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>checking for medium and high vulnerabilities</p></li><li class="listitem"><p>checking configuration items (e.g., ensuring health checks in an image or disallowing exposed ports)</p></li><li class="listitem"><p>validating that the vulnerability feed data is up-to-date.</p></li></ul></div><p>This policy is a basic catch-all that cannot be deleted. If no other policy assignments are made, the Default policy is automatically used.</p><div dir="ltr" class="tip tip"><h3 class="title">Tip</h3><p>You can edit the Default policy and edits will be retained even when you upgrade Sysdig Secure.</p></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-PreconfiguredCompliancePolicies" class="bridgehead">Preconfigured Compliance Policies</h6><p>The three other preconfigured policies deal with compliance rules. To use them, you must <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ManagePolicyAssignments" title="Manage Policy Assignments">add them to the Policy Assignments list</a>.</p><div dir="ltr" class="warning warning"><h3 class="title">Warning</h3><p>If you want to edit a preconfigured compliance policy, create a new policy with matching rules and edit that.</p><p>Otherwise, your customizations may be overwritten and lost during Sysdig Secure upgrades.</p></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ConfigurationPolicy-DockerfileBestPractices" class="bridgehead">Configuration Policy - Dockerfile Best Practices</h6><p>This policy provides out-of-the-box rules around <a class="link" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/" target="_blank">Dockerfile best practices</a>, such as disallowing:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>secrets baked in as environment variables</p></li><li class="listitem"><p> <code class="code">root</code> user configuration</p></li><li class="listitem"><p>exposed ports</p></li><li class="listitem"><p>run instructions that include <code class="code">.yum</code> upgrades.</p></li></ul></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-NIST800-190" class="bridgehead">Audit Policy - NIST 800-190</h6><p>This policy maps <a class="link" href="https://www.nist.gov/publications/application-container-security-guide" target="_blank">NIST 800-190</a> controls to a Sysdig Secure scanning policy, such as disallowing:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>non-official node or Ruby packages</p></li><li class="listitem"><p> <code class="code">add</code> instructions in a Docker file</p></li><li class="listitem"><p>the use of base distributions outside of expected values.</p></li></ul></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AuditPolicy-PCI" class="bridgehead">Audit Policy - PCI</h6><p>This policy maps <a class="link" href="https://www.pcisecuritystandards.org/pci_security/maintaining_payment_security" target="_blank">PCI</a> (Payment Card Industry) controls to a Sysdig Secure scanning policy, such as disallowing vulnerabilities or credentials to be included in the image.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CustomizedPolicies" class="bridgehead">Customized Policies</h6><p>Remember not to edit preconfigured compliance scanning policies directly. Create a matching policy and edit that one.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-CreateaNewPolicy" class="bridgehead">Create a New Policy</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Scanning Policies</code> and click <code class="code">Add Policy(+)</code>.</p><p>The New Policy page is displayed.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d69ac321-d5f8-508a-83ea-e90d62e7dc33-en.png" style="max-width: 600px; " alt="342261767.png"></img></td></tr></table></div></li><li class="step"><p>Define a <code class="code">Name</code> and an optional <code class="code">Description </code>for the new policy.</p></li><li class="step"><p>Add a <code class="code">Rule</code>:</p><ol type="a" class="substeps"><li class="step"><p>Select the <code class="code">Gate</code> and then the <code class="code">Trigger </code>from the drop-down menus.</p></li><li class="step"><p>Configure relevant parameters. (Some triggers do not require parameters to be set.)</p><p>See <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a" title="**Scanning Policy Gates and Triggers**">**Scanning Policy Gates and Triggers**</a> for details on each option.</p><p>The example below uses the <code class="code"> <a class="link" href="">vulnerabilities</a> </code> gate with the <code class="code"> <a class="link" href="">package</a> </code> trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-9badfb97-ee63-9ade-7537-87f7da550081-en.png" style="max-width: 600px; " alt="341770259.png"></img></td></tr></table></div></li></ol></li></ol></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p> <span class="bold bold"><strong>Optional:</strong></span> Repeat step 5 to add rules as necessary.</p></li><li class="step"><p>Click <code class="code">Save</code>.</p></li></ol></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-EditanExistingPolicy" class="bridgehead">Edit an Existing Policy</h6><p>To edit an existing scanning policy:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Select the desired policy from the list.</p></li><li class="step"><p>Edit the policy rules as required, and click <code class="code">Save Policy</code>.</p></li></ol></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-DeleteanExistingPolicy" class="bridgehead">Delete an Existing Policy</h6><p>To delete an existing scanning policy:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Select the desired policy from the list.</p></li><li class="step"><p>Click the <code class="code">Delete</code> (trash can) icon and choose <code class="code">Yes</code> to confirm the change.</p></li></ol></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-WhitelistBlacklist" class="bridgehead">Whitelist/Blacklist</h6><p>You can globally whitelist or blacklist particular images or CVEs, if desired. See <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc" title="**Whitelist | Blacklist CVEs and Images**">**Whitelist | Blacklist CVEs and Images**</a>. This does not affect the policy evaluation order.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ManagePolicyAssignments" class="bridgehead">Manage Policy Assignments</h6><p>Unless you use a very simple, single-policy approach to scanning, you will probably assign particular policies to particular registries, repos, or tags. Use the Policy Assignments page to do so.</p><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-AssignaPolicy" class="bridgehead">Assign a Policy</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, select <span class="bold bold"><strong> <code class="code">Scanning Policies</code> </strong></span> and choose <span class="bold bold"><strong> <code class="code">Policy Assignments</code> </strong></span>.</p><p>The previously defined assignments are listed in priority order.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 177px"><td><img src="image/uuid-cf1c7545-206f-c307-f983-8dcbc2dfddeb-en.png" style="max-width: 600px; max-height: 177px; " alt="342196241.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">+Add Policy Assignment</code>.</p><p>A new entry line appears at the top of the Assignment page. Enter the desired assignment details:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p> <span class="bold bold"><strong> <code class="code">Priority</code>: </strong></span>Priority is the order of evaluation against the assigned policy. Each new assignment is auto-placed at Priority 1. Once a policy assignment is created and saved, you can change its priority order by dragging it into a new position on the list. See also <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-UsingPriorities" title="Using Priorities">Using Priorities</a>.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Registry</code>:</strong></span>Any registry domain (e.g. quay.io). Wildcards are supported; an asterisk * specifies any registry.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Repository</code>:</strong></span>Any repository (typically = name of the image). Wildcards are supported; an asterisk * specifies any repository.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Tag</code>:</strong></span> Any tag. Wildcards are supported; an asterisk * specifies any tag.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Assigned Policy</code>:</strong></span> Name of policy to use for evaluation. Select from the drop-down menu.</p></li></ol></div></li><li class="step"><p>Click <code class="code">Save</code>.</p></li><li class="step"><p> <span class="bold bold"><strong>Optional: </strong></span>Reorganize the Priority order by clicking the drag handle (the four dots to the left of a line) and dragging the assignment to a different spot on the list.</p></li></ol></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-ExampleUseCases" class="bridgehead">Example Use Cases</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>To prevent developers from pulling unknown images from a Docker hub, you may want to design a rule for the <code class="code"> <a class="link" href="http://docker.io" target="_blank">docker.io</a> registry,</code> (including all repos and tags), and assign an appropriate policy. &lt;Which gate/ trigger/policuy checks for unknown images?&gt;</p><pre class="programlisting">
registry = docker.io repository = * tags = * assigned policy = ?</pre></li><li class="step"><p>Organizations commonly tag images as <code class="code">dev</code> or <code class="code">prod</code>. You can apply a tag assignment to <code class="code">dev</code> images by using wildcard.wildcard.dev.</p></li></ol></div><h6 id="UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae_id_id-ManageScanningPolicies-UsingPriorities" class="bridgehead">Using Priorities</h6><p>When you use more than one scanning policy, the Anchore engine evaluates them in top-down order, starting from Priority 1 in the Policy Assignment list. The first policy assignment rule that matches an input image will be evaluated, and all subsequent rules ignored. Therefore, the priority order is important.</p><div dir="ltr" class="tip tip"><h3 class="title">Tip</h3><p>For example, imagine a list with two defined policy assignments:</p><p> <code class="code">Priority 1 Registry = <a class="link" href="http://quay.io" target="_blank">quay.io</a> Repository = sysdig/* </code> </p><p> <code class="code">Priority 2 Registry = <a class="link" href="http://quay.io" target="_blank">quay.io</a> Repository = sysdig/myrepo</code> </p><p>Since the first rule uses a wild card, the evaluation applies to all repos beginning with <code class="code">sysdig/</code> and will stop before evaluating <code class="code">sysdig/myrepo</code>.</p><p>Reverse the priority order to get the behavior you want.</p></div><p>There is a catch-all entry at the bottom of the Policy Assignment list that cannot be removed. It has the format :</p><pre class="programlisting">
registry = * repository = * tag = * assigned policy = default </pre><p> <code class="code"></code>(You can change the <code class="code">assigned policy</code>, but other fields cannot be edited.)</p><p>The purpose of this row is to ensure that any registries that do not fall under another policy evaluation will at least be evaluated against the system-configured Default policy.</p><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-d9882b5d-bb6f-bb77-986a-4f1de0b707cf" data-publication-date="" id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc"><div class="titlepage"><div><div class="title"><h6 class="title">**Whitelist | Blacklist CVEs and Images**</h6></div></div></div><p>Sysdig Secure allows users to define <span class="bold bold"><strong>CVEs and images as globally trusted or blacklisted.</strong></span> For example, a low-risk CVE can be globally approved to prevent it from impacting builds that include more critical fixes. Alternatively, specific images can be marked as globally approved or not to ensure they always/never pass a scan.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>Blacklist options for other entities, such as users, ports, packages, etc., are listed in <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a" title="**Scanning Policy Gates and Triggers**">**Scanning Policy Gates and Triggers**</a>.</p></div><h7 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-Contents" class="bridgehead">Contents</h7><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-ReviewtheWhitelistedBlacklistedCVEsandImages" title="Review the Whitelisted/Blacklisted CVEs and Images"> Review the Whitelisted/Blacklisted CVEs and Images</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistaCVE" title="Whitelist a CVE">Whitelist a CVE</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistBlacklistanImage" title="Whitelist / Blacklist an Image"> Whitelist / Blacklist an Image</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-RemoveaCVEorImagefromtheWhitelistBlacklist" title="Remove a CVE or Image from the Whitelist/Blacklist"> Remove a CVE or Image from the Whitelist/Blacklist</a> </p></li></ul></div><h7 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-ReviewtheWhitelistedBlacklistedCVEsandImages" class="bridgehead">Review the Whitelisted/Blacklisted CVEs and Images</h7><p>To review the current list of whitelisted/blacklisted CVEs and images:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Click the <code class="code">Whitelists and Blacklists</code> button.</p></li><li class="step"><p>Choose the relevant tab (<span class="bold bold"><strong> <code class="code">CVE Whitelist</code> </strong></span>, <span class="bold bold"><strong> <code class="code">Global Trusted Images</code> </strong></span>, or <span class="bold bold"><strong> <code class="code">Global Blacklisted Images</code> </strong></span>).</p></li></ol></div><h7 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistaCVE" class="bridgehead">Whitelist a CVE</h7><p>There are two ways to whitelist a CVE - from the <code class="code">Scanning Policies</code> tab, and from the <code class="code">Repositories</code> tab.</p><p> <span class="bold bold"><strong>From the Scanning Policies Tab:</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-e022fb91-de24-7daf-6751-5d62773a2961-en.png" style="max-width: 600px; " alt="341966907.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">Whitelists and Blacklists</code>.</p></li><li class="step"><p>Click <code class="code">Add CVE,</code> add each CVE in a comma-separated list, then click <code class="code">Ok</code> to save.</p><p>Each item in the list must follow the CVE naming format (<code class="code">CVE-YEAR-ID</code>).</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="400px"><tr><td><img src="image/uuid-10f0337d-c6b9-4656-37de-5485d448cede-en.png" style="max-width: 400px; " alt="341966904.png"></img></td></tr></table></div></li></ol></div><p> <span class="bold bold"><strong>From the Repositories Tab</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, choose <code class="code">Repositories</code> and select one of the listed repos.</p><p>If there is a policy result related to a vulnerability, you can whitelist that CVE.</p></li><li class="step"><p>Click the <code class="code">More Options</code> (<span class="bold bold"><strong>+</strong></span>) icon beside the relevant CVE.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-07b957e8-93ab-22f4-662c-448b6a20be01-en.png" style="max-width: 600px; " alt="343638168.png"></img></td></tr></table></div></li><li class="step"><p>Select <code class="code">Add CVE to Global Whitelist</code>.</p></li></ol></div><p>The CVE will now be listed in the <code class="code">CVE Whitelist</code> tab.</p><h7 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-WhitelistBlacklistanImage" class="bridgehead">Whitelist / Blacklist an Image</h7><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>If an image is added both in the "Trusted Images" list and in the "Blacklisted Image" list, the blacklisted one takes precedence.</p></div><p>There are two ways to whitelist or blacklist an image - from the <code class="code">Scanning Policies</code> tab, and from the <code class="code">Repositories</code> tab.</p><p> <span class="bold bold"><strong>From the <code class="code">Scanning Policies</code> tab:</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Click <code class="code">Whitelists and Blacklists</code>.</p></li><li class="step"><p>Choose the relevant tab (<span class="bold bold"><strong> <code class="code">Global Trusted Images</code> </strong></span>, or <span class="bold bold"><strong> <code class="code">Global Blacklisted Images</code> </strong></span>) and click the <code class="code">Add Image</code> button.</p></li><li class="step"><p>Add each image in a comma-separated list, then click <code class="code">Ok</code>.</p><p>A tag name must be valid ASCII and may contain lowercase and uppercase letters, digits, underscores, periods and dashes.</p><p>A tag name may not start with a period or a dash and may contain a maximum of 128 characters.</p></li></ol></div><p> <span class="bold bold"><strong>From the <code class="code">Repositories</code> tab:</strong></span> </p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, choose the <code class="code">Repositories</code> tab.</p></li><li class="step"><p>Select the relevant repository from the list and open the relevant image.</p></li><li class="step"><p>Click the <code class="code">More Options</code> (<span class="bold bold"><strong>+</strong></span>) icon at the top of the page:</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 222px"><td><img src="image/uuid-b2b10bb1-1440-2a98-126b-b6c14c110ba1-en.png" style="max-width: 600px; max-height: 222px; " alt="343441579.png"></img></td></tr></table></div></li><li class="step"><p>Select either <code class="code">Add Image to Trusted Images</code> or <code class="code">Add Image to Blacklisted Images</code> as needed.</p></li></ol></div><p>The CVE will now be listed in the <code class="code">Global Trusted Images</code> tab or <code class="code">Global Blacklisted Images</code> tab, as appropriate.</p><h7 id="UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc_id_id-WhitelistBlacklistCVEsandImages-RemoveaCVEorImagefromtheWhitelistBlacklist" class="bridgehead">Remove a CVE or Image from the Whitelist/Blacklist</h7><p>To remove one or more CVEs or Images from the various lists:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the I<code class="code">mage Scanning</code> module, select <code class="code">Scanning Policies</code>.</p></li><li class="step"><p>Click <code class="code">Whitelists and Blacklists</code>.</p></li><li class="step"><p>Navigate to the relevant tab (<span class="bold bold"><strong> <code class="code">CVE Whitelist</code> </strong></span>, <span class="bold bold"><strong> <code class="code">Global Trusted Images</code> </strong></span>, or <span class="bold bold"><strong> <code class="code">Global Blacklisted Images</code> </strong></span>).</p></li><li class="step"><p>Click the <code class="code">Delete</code> <span class="bold bold"><strong>(X</strong></span>) icon beside the relevant CVEs/images</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 127px"><td><img src="image/uuid-bf17c1da-715c-86dd-1789-1aa071d14a9a-en.png" style="max-width: 600px; max-height: 127px; " alt="341966898.png"></img></td></tr></table></div></li><li class="step"><p>Click <code class="code">Save</code> .</p></li></ol></div></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-2b331aa9-b0bf-6ec6-8a68-06e060c80ee9" data-publication-date="" id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a"><div class="titlepage"><div><div class="title"><h6 class="title">**Scanning Policy Gates and Triggers**</h6></div></div></div><p>This document described the current <span class="bold bold"><strong>gates</strong></span> and their respective <span class="bold bold"><strong>triggers</strong></span>/parameters in Sysdig Secure scanning policies.</p><p>These policy gates, triggers, and parameters can be used to build in-depth scanning policies, from whitelisting / blacklisting partial file names to defining what login shells are approved.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>This information can also be obtained using the CLI:</p><pre class="programlisting">
user@host:~$ anchore-cli policy describe (--gate &lt;gatename&gt; (--trigger &lt;triggername))</pre></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Contents" class="bridgehead">Contents</h7><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Always" title="Always">Always</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-always" title="always">always</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Dockerfile" title="Dockerfile">Dockerfile</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-effective_user" title="effective_user">effective_user</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-exposed_ports" title="exposed_ports">exposed_ports</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-instruction" title="instruction">instruction</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-no_dockerfile_provided" title="no_dockerfile_provided">no_dockerfile_provided</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Files" title="Files">Files</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_match" title="content_regex_match">content_regex_match</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-name_match" title="name_match">name_match</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-suid_or_guid_set" title="suid_or_guid_set">suid_or_guid_set</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Licenses" title="Licenses">Licenses</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_exact_match" title="blacklist_exact_match">blacklist_exact_match</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_partial_match" title="blacklist_partial_match">blacklist_partial_match</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Metadata" title="Metadata">Metadata</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-attribute" title="attribute">attribute</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-NPMs" title="NPMs">NPMs</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklisted_name_version" title="blacklisted_name_version">blacklisted_name_version</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable" title="feed_data_unavailable">feed_data_unavailable</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_in_feed" title="newer_version_in_feed">newer_version_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-unknown_in_feeds" title="unknown_in_feeds">unknown_in_feeds</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_in_feeds" title="version_not_in_feeds">version_not_in_feeds</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Packages" title="Packages">Packages</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist" title="blacklist">blacklist</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-required_package" title="required_package">required_package</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-verify" title="verify">verify</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-PasswdFile" title="Passwd File">Passwd File</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_full_entry" title="blacklist_full_entry">blacklist_full_entry</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_groupids" title="blacklist_groupids">blacklist_groupids</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_shells" title="blacklist_shells">blacklist_shells</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_userids" title="blacklist_userids">blacklist_userids</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_usernames" title="blacklist_usernames">blacklist_usernames</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_not_available" title="content_not_available">content_not_available</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-RubyGems" title="Ruby Gems">Ruby Gems</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist1" title="blacklist">blacklist</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable1" title="feed_data_unavailable">feed_data_unavailable</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_found_in_feed" title="newer_version_found_in_feed"> newer_version_found_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-not_found_in_feed" title="not_found_in_feed">not_found_in_feed</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_found_in_feed" title="version_not_found_in_feed">version_not_found_in_feed</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-SecretScans" title="Secret Scans">Secret Scans</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_checks" title="content_regex_checks">content_regex_checks</a> </p></li></ul></div></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Vulnerabilities" title="Vulnerabilities">Vulnerabilities</a> </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-package" title="package">package</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-stale_feed_data" title="stale_feed_data">stale_feed_data</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-vulnerability_data_unavailable" title="vulnerability_data_unavailable"> vulnerability_data_unavailable</a> </p></li></ul></div></li></ul></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Always" class="bridgehead">Always</h7><p>This gate provides users with a valuable testing resource, as it will be triggered unconditionally.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-always" class="bridgehead">always</h7><p>The <code class="code">always</code> trigger / gate will trip if it is present in the policy.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The Always gate is useful for testing whether the image blacklist/whitelist is working as expected.</p></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-95d4a924-546a-0dd1-e84c-b86717864a7a-en.png" style="max-width: 600px; " alt="342196463.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Dockerfile" class="bridgehead">Dockerfile</h7><p>The dockerfile gate reviews the contents of a dockerfile, or the assumed contents of a dockerfile if one is not provided, for exposed ports and instructions that do not follow best practices.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The gate assumes what the contents would be based on the docker layer history.</p></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-effective_user" class="bridgehead">effective_user</h7><p>This trigger reviews whether the effective user matches the user provided, and will fire based on the configured type.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">type</code> </p></td><td class="td"><p>Determines whether the user should be whitelisted or blacklisted.</p></td><td class="td"><p>N/A</p></td></tr><tr><td class="td"><p> <code class="code">user</code> </p></td><td class="td"><p>The name of the user.</p></td><td class="td"><p>root,docker</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-745ce90d-feec-952a-c93d-7119abd75fc5-en.png" style="max-width: 600px; " alt="342196460.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-exposed_ports" class="bridgehead">exposed_ports</h7><p>This trigger evaluates the set of exposed ports to determine whether they should be whitelisted or blacklisted.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">actual_dockerfile_only</code> </p></td><td class="td"><p>Defines whether the evaluation should skip inferred or guessed dockerfiles, and only evaluate user-provided dockerfiles. The default value is <code class="code">false</code>.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">ports</code> </p></td><td class="td"><p>A comma-separated list of port numbers.</p></td><td class="td"><p>80,8080,8088</p></td></tr><tr><td class="td"><p> <code class="code">type</code> </p></td><td class="td"><p>Defines whether the ports should be whitelisted or blacklisted.</p></td><td class="td"><p>N/A</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 250px"><td><img src="image/uuid-ef50bc39-5dc7-f679-74d5-907ac369e0e2-en.png" style="max-width: 600px; max-height: 250px; " alt="342196457.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-instruction" class="bridgehead">instruction</h7><p>This trigger evaluates whether any directives / instructions in the list match the conditions in the dockerfile.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">actual_dockerfile_only</code> </p></td><td class="td"><p>Defines whether the evaluation should skip inferred or guessed dockerfiles, and only evaluate user-provided dockerfiles. The default value is <code class="code">false</code>.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>The type of check to perform.</p></td><td class="td"><p>=</p></td></tr><tr><td class="td"><p> <code class="code">instruction</code> </p></td><td class="td"><p>The dockerfile instruction to check.</p></td><td class="td"><p>FROM</p></td></tr><tr><td class="td"><p> <code class="code">value</code> </p></td><td class="td"><p>The value to check the dockerfile instruction against.</p></td><td class="td"><p>scratch</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-04248785-c9cb-abc7-c887-0af96600cada-en.png" style="max-width: 600px; " alt="342196454.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-no_dockerfile_provided" class="bridgehead">no_dockerfile_provided</h7><p>This trigger will trip if there is no dockerfile supplied with the image. No parameters are required for this trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-5fc18f7d-5c8a-0414-690c-abbf0ef0d916-en.png" style="max-width: 600px; " alt="342196451.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Files" class="bridgehead">Files</h7><p>The Files gate reviews files within the analyzed image. This evaluation covers file content, names, and filesystem attributes.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_match" class="bridgehead">content_regex_match</h7><p>This trigger is tripped for each file where a match has been found using the configured regex in the <code class="code">analyzer_config.yaml</code> <code class="code">content_search</code> section.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>For more information regarding the regex values, refer to the <code class="code">analyzer_config.yaml</code> file.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">regex_name</code> </p></td><td class="td"><p>The regex string that appears in the <code class="code">FILECHECK_CONTENTMATCH</code> analyzer parameter.</p></td><td class="td"><p>.*password.*</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-56b12c39-36af-0ee5-b8f0-03f1379e6824-en.png" style="max-width: 600px; " alt="342196448.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-name_match" class="bridgehead">name_match</h7><p>This trigger is tripped if the name of a file in the container matches the provided regex.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>This trigger has a performance impact on policy evaluation.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">regex</code> </p></td><td class="td"><p>The regex to search for.</p></td><td class="td"><p>.*\.pem</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0078968e-2da9-07d9-9d5e-d379786c2f7b-en.png" style="max-width: 600px; " alt="342196445.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-suid_or_guid_set" class="bridgehead">suid_or_guid_set</h7><p>This trigger is tripped for each file that has a set-user identification (SUID) or set-group identification (SGID) configured. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-581b7b6b-c2d8-040f-7359-c54ffe0b5608-en.png" style="max-width: 600px; " alt="342196442.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Licenses" class="bridgehead">Licenses</h7><p>This gate is used to review software licenses found in the container image, to ensure, for example, that packages that violate internal company policy are not being used.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_exact_match" class="bridgehead">blacklist_exact_match</h7><p>This trigger will be tripped if the image contains packages distributed under the exact license specified.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">licenses</code> </p></td><td class="td"><p>A comma-separated list of license names to blacklist.</p></td><td class="td"><p>GPLv2+,GPL-3+,BSD-2-clause</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-1cef9d9c-4a9b-64cd-bbdc-689489c0a7c8-en.png" style="max-width: 600px; " alt="342196439.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_partial_match" class="bridgehead">blacklist_partial_match</h7><p>This trigger will be tripped if the image contains packages distributed under a license that includes the partial strings provided.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">licenses</code> </p></td><td class="td"><p>A comma-separated list of strings to blacklist for licenses.</p></td><td class="td"><p>LGPL,BSD</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-e08f734a-e8ef-1743-eef5-e15e6098375b-en.png" style="max-width: 600px; " alt="342196436.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Metadata" class="bridgehead">Metadata</h7><p>This gate reviews image metadata, including the size, operating system, and architecture.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-attribute" class="bridgehead">attribute</h7><p>The attribute trigger is tripped if a named image metadata value matches the given condition.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">attribute</code> </p></td><td class="td"><p>The attribute name to check.</p></td><td class="td"><p>size</p></td></tr><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>The operation to perform for the evaluation.</p></td><td class="td"><p>&gt;</p></td></tr><tr><td class="td"><p> <code class="code">value</code> </p></td><td class="td"><p>The value used for the evaluation.</p></td><td class="td"><p>1073741824</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-807afe45-e133-ee27-231b-6eae9260a3e3-en.png" style="max-width: 600px; " alt="342196433.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-NPMs" class="bridgehead">NPMs</h7><p>The NPMs gate reviews any images that have <a class="link" href="https://docs.npmjs.com/cli/npm" target="_blank">NPM</a> packages installed.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklisted_name_version" class="bridgehead">blacklisted_name_version</h7><p>This trigger is tripped if the evaluated image has an NPM package installed that has been blacklisted, either by name or optionally by name and version.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the blacklisted NPM package.</p></td><td class="td"><p>time_diff</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The specific version of the NPM package to blacklist.</p></td><td class="td"><p>0.2.9</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-6c4f1ff8-fd1c-a671-48b7-b20744335639-en.png" style="max-width: 600px; " alt="342196430.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable" class="bridgehead">feed_data_unavailable</h7><p>This trigger is tripped if the engine does not have access to the NPM data feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-85d6a16e-aa84-71fb-8f48-7fb83daf76a7-en.png" style="max-width: 600px; " alt="342196427.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_in_feed" class="bridgehead">newer_version_in_feed</h7><p>This trigger is tripped if the NPM data feed lists a newer version of the package. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-b0ed070c-e70f-248a-b020-6fc985bce929-en.png" style="max-width: 600px; " alt="342196424.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-unknown_in_feeds" class="bridgehead">unknown_in_feeds</h7><p>This trigger is tripped if the NPM installed is not in the official NPM database. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-18beb41f-be18-63d9-1abd-29ced2ae8e35-en.png" style="max-width: 600px; " alt="342196418.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_in_feeds" class="bridgehead">version_not_in_feeds</h7><p>This trigger is tripped if the NPM version is not listed as a valid version in the official NPM feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7fada5cc-fa05-be8d-60a2-7e14587326ec-en.png" style="max-width: 600px; " alt="342196415.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Packages" class="bridgehead">Packages</h7><p>The Packages gate reviews all packages within the image, verifying names, versions, and whitelisted / blacklisted packages.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist" class="bridgehead">blacklist</h7><p>This trigger is tripped if the image contains packages that have been blacklisted by either name, or name and version.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of blacklisted package/s.</p></td><td class="td"><p>openssh-server</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The exact version of the package that should be blacklisted.</p></td><td class="td"><p>1.0.1</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d57f3d6d-fa0f-caa3-0f77-fcf3e247eacd-en.png" style="max-width: 600px; " alt="342196412.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-required_package" class="bridgehead">required_package</h7><p>The <code class="code">required_package</code> trigger is tripped if the specified package / version is not found in the image.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the required package.</p></td><td class="td"><p>libssl</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The required package version.</p></td><td class="td"><p>1.10.3rc3</p></td></tr><tr><td class="td"><p> <code class="code">version_match_type</code> </p></td><td class="td"><p>Defines whether the trigger should require the exact package and version (exact), or just a version of the package (minimum). This is only relevant if the version is defined.</p></td><td class="td"><p>exact</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-7ebe4e0e-6a2a-cd28-4324-b34948a1049e-en.png" style="max-width: 600px; " alt="342196409.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-verify" class="bridgehead">verify</h7><p>This trigger reviews the package integrity against the package database in the image, and is tripped for change or removal of content in either all or a defined list of directories provided.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">check</code> </p></td><td class="td"><p>Defines whether the check should focus on missing packages, changed packages, or all.</p></td><td class="td"><p>changed</p></td></tr><tr><td class="td"><p> <code class="code">only_directories</code> </p></td><td class="td"><p>Defines the list of directories the check should be limited to.</p></td><td class="td"><p>/usr,/var/lib</p></td></tr><tr><td class="td"><p> <code class="code">only_packages</code> </p></td><td class="td"><p>Defines the list of packages that should be verified.</p></td><td class="td"><p>libssl,openssl</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-d63dcd2c-a625-1f33-f552-6c20edd6c367-en.png" style="max-width: 600px; " alt="342196406.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-PasswdFile" class="bridgehead">Passwd File</h7><p>This gate reviews <code class="code">/etc/passwd</code> for blacklisted users, groups, and shells.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_full_entry" class="bridgehead">blacklist_full_entry</h7><p>This trigger trips if the whole password is found in the <code class="code">/etc/password</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">entry</code> </p></td><td class="td"><p>The full entry to match in <code class="code">/etc/passwd</code>.</p></td><td class="td"><p>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-9084ffef-adbc-ee51-031a-73441a629c92-en.png" style="max-width: 600px; " alt="342196481.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_groupids" class="bridgehead">blacklist_groupids</h7><p>This trigger is tripped if the designated group id/s are found in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">group_ids</code> </p></td><td class="td"><p>A numeric, comma separated list of group ids that will cause the trigger to trip.</p></td><td class="td"><p>999,20</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-180ccfac-484c-b0fb-e937-bf203a6b45b3-en.png" style="max-width: 600px; " alt="342196478.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_shells" class="bridgehead">blacklist_shells</h7><p>This trigger will trip if a designated login shell is found under any user in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">shells</code> </p></td><td class="td"><p>The list of shell commands to blacklist.</p></td><td class="td"><p>/bin/bash,/bin/zsh</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-95f842b5-74bf-f177-979a-4aad4d2e3b3e-en.png" style="max-width: 600px; " alt="342196475.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_userids" class="bridgehead">blacklist_userids</h7><p>This trigger will be tripped if the specified user ID is present in /<code class="code">etc/passwd</code>.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">user_ids</code> </p></td><td class="td"><p>The numerical, comma-separated list of user IDs to blacklist.</p></td><td class="td"><p>0,1</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-8f2836a4-ab10-431f-b7a7-72e93d435392-en.png" style="max-width: 600px; " alt="342196472.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist_usernames" class="bridgehead">blacklist_usernames</h7><p>The <code class="code">blacklist_usernames</code> trigger will trip if the specified username is found in the <code class="code">/etc/passwd</code> file.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">user_names</code> </p></td><td class="td"><p>A comma-separated list of usernames to blacklist.</p></td><td class="td"><p>daemon,ftp</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-83666e00-67cb-4a7c-f43a-724628eb8079-en.png" style="max-width: 600px; " alt="342196469.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_not_available" class="bridgehead">content_not_available</h7><p>The <code class="code">content_not_available</code> trigger will trip if the <code class="code">/etc/passwd</code> file is not present in the image. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-149246aa-2fa8-74e0-3448-8fb86d5117f7-en.png" style="max-width: 600px; " alt="342196466.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-RubyGems" class="bridgehead">Ruby Gems</h7><p>The Ruby Gems gate ensures that developers are using official packages from the official GEM database, and are not using versions of packages that are no longer supported.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-blacklist1" class="bridgehead">blacklist</h7><p>The <code class="code">blacklist</code> trigger trips if a GEM package that matches the configured name and version is found in the evaluated image.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">name</code> </p></td><td class="td"><p>The name of the gem.</p></td><td class="td"><p>time_diff</p></td></tr><tr><td class="td"><p> <code class="code">version</code> </p></td><td class="td"><p>The version of the gem to blacklist.</p></td><td class="td"><p>0.2.9</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-6b9fd69f-a720-3ef0-aa86-6620cba90025-en.png" style="max-width: 600px; " alt="342196496.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-feed_data_unavailable1" class="bridgehead">feed_data_unavailable</h7><p>This trigger will trip if Sysdig does not have access to the GEM data feed. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ee8523d6-f1b3-e411-9298-d547caf60396-en.png" style="max-width: 600px; " alt="342196493.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-newer_version_found_in_feed" class="bridgehead">newer_version_found_in_feed</h7><p>This trigger will trip if an installed GEM package is not the latest version. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-4b52bc8c-5cc9-0d2a-d7bb-d3aafd3fa85f-en.png" style="max-width: 600px; " alt="342196490.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-not_found_in_feed" class="bridgehead">not_found_in_feed</h7><p>This trigger will trip if an installed GEM is not in the official GEM database. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ec5aa454-1dcf-6e18-8837-5c0a81b9a565-en.png" style="max-width: 600px; " alt="342196487.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-version_not_found_in_feed" class="bridgehead">version_not_found_in_feed</h7><p>This trigger will trip if the GEM is not listed in the official GEM feed as a valid / supported version. No parameters are required.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-0c9bd2e4-b0cb-4169-3dd8-8a921bd299c9-en.png" style="max-width: 600px; " alt="342196484.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-SecretScans" class="bridgehead">Secret Scans</h7><p>Secret scans determine, based on configured regex, whether secrets that could be available if an image was compromised have been baked into the image.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-content_regex_checks" class="bridgehead">content_regex_checks</h7><p>The <code class="code">content_regex_checks</code> trigger trips if the content search analyzer finds a match with the configured and named regexes. Matches are filtered by the <code class="code">content_regex_name</code>, and the <code class="code">filename_regex</code>, if either are set.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The <code class="code">content_regex_name</code> should be a value from the secret_search section of <code class="code">analyzer_config.yaml</code>.</p></div><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">content_regex_name</code> </p></td><td class="td"><p>The name of the variable / content. If found in the image, this should trip the trigger.</p><div dir="ltr" class="note note"><h3 class="title">Note</h3><p>The names available by default are <code class="code">AWS_ACCESS_KEY</code>, <code class="code">AWS_SECRET_KEY</code>, <code class="code">PRIV_KEY</code>, <code class="code">DOCKER_AUTH</code>, and <code class="code">API_KEY</code>.</p></div></td><td class="td"><p>AWS_ACCESS_KEY</p></td></tr><tr><td class="td"><p> <code class="code">filename_regex</code> </p></td><td class="td"><p>Filters the files that should be analyzed for the presence of the <code class="code">content_regex_name</code>.</p></td><td class="td"><p>/etc/.*</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-358de109-329d-0289-f1cd-514b496bb380-en.png" style="max-width: 600px; " alt="342196499.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-Vulnerabilities" class="bridgehead">Vulnerabilities</h7><p>CVE / vulnerability checks can be used to ensure the included packages don't have vulnerabilities above a set level, are older than a designated period, or if data is unavailable.</p><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-package" class="bridgehead">package</h7><p>The package trigger is tripped if a vulnerability in an image matches the configured comparison criteria. The table below outlines the available parameters and criteria:</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">fix_available</code> </p></td><td class="td"><p>If present, the fix availability for the vulnerability record must match the value of the parameter.</p></td><td class="td"><p>true</p></td></tr><tr><td class="td"><p> <code class="code">package_type</code> </p></td><td class="td"><p>The specific type of package.</p></td><td class="td"><p>all</p></td></tr><tr><td class="td"><p> <code class="code">severity</code> </p></td><td class="td"><p>The vulnerability severity.</p></td><td class="td"><p>high</p></td></tr><tr><td class="td"><p> <code class="code">severity_comparison</code> </p></td><td class="td"><p>The type of comparison to perform for the security evaluation.</p></td><td class="td"><p>&gt;</p></td></tr><tr><td class="td"><p> <code class="code">vendor_only</code> </p></td><td class="td"><p>If true, an available fix for this CVE must not be explicitly marked as "Won't be addressed by the vendor".</p></td><td class="td"><p>true</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-19be8723-5fd0-245a-5252-69a58642aa83-en.png" style="max-width: 600px; " alt="342196502.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-stale_feed_data" class="bridgehead">stale_feed_data</h7><p>The <code class="code">stale_feed_data</code> trigger will be tripped if the CVE data is older than the window specified.</p><div class="informaltable table-responsive"><table class="informaltable frame-void rules-rows"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th class="th"><p>Parameter</p></th><th class="th"><p>Description</p></th><th class="th"><p>Example</p></th></tr></thead><tbody><tr><td class="td"><p> <code class="code">max_days_since_sync</code> </p></td><td class="td"><p>Determines how old in days sync data can be before the trigger is tripped.</p></td><td class="td"><p>10</p></td></tr></tbody></table></div><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-5458ae20-5dbd-e997-3f95-67daf88ed5fb-en.png" style="max-width: 600px; " alt="342196505.png"></img></td></tr></table></div><h7 id="UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a_id_id-ScanningPolicyGatesandTriggers-vulnerability_data_unavailable" class="bridgehead">vulnerability_data_unavailable</h7><p>If no vulnerability data is available, the <code class="code">vulnerability_data_unavailable</code> trigger will trip. No parameters are required for this trigger.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr style="height: 175px"><td><img src="image/uuid-f1d69621-01ba-2178-21e3-955bfa26dafc-en.png" style="max-width: 600px; max-height: 175px; " alt="342196508.png"></img></td></tr></table></div></section></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-dba5229a-a2fc-75b5-33d4-32e3aa41e9b0" data-publication-date="" id="UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23"><div class="titlepage"><div><div class="title"><h5 class="title">**Manage Scanning Alerts**</h5></div></div></div><p>Image scanning alerts, like all Sysdig alerts, can be configured to notify users when an issue in the infrastructure arises. Image scanning alerts focus on two issues: when an image has failed a scanning policy evaluation, or when an unscanned image has been added to the environment.</p><h6 id="UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-Contents" class="bridgehead">Contents</h6><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-CreateanAlert" title="Create an Alert">Create an Alert</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-EditanExistingAlert" title="Edit an Existing Alert">Edit an Existing Alert</a> </p></li><li class="listitem"><p> <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-DeleteanAlert" title="Delete an Alert">Delete an Alert</a> </p></li></ul></div><h6 id="UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-CreateanAlert" class="bridgehead">Create an Alert</h6><p>To create a new alert:</p><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, choose the <code class="code">Alerts</code> tab and click <code class="code">Add Alert. </code>The New Alert panel is displayed.</p><p> <code class="code"></code> </p></li><li class="step"><p>Enter the alert parameters:</p><ol type="a" class="substeps"><li class="step"><p> <code class="code">Name </code>and optional <code class="code">Description</code> </p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Scope:</code> </strong></span> Use <code class="code">Entire Infrastructure</code> or define a narrower scope.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Triggers: </code> <code class="code">Unscanned Image:</code> </strong></span>Check the box and choose <code class="code">Scan</code> to automatically scan any detected image within the scope.</p><p>See also <a class="link" href="26547-12911---image-scanning-and-vulnerability-management--.html#UUID-67620761-4915-e657-1b0b-aa0f82bd4333" title="**Scan Images**">**Scan Images**</a>.</p><p> <code class="code">Failed Policy Result: </code>Looks to see if there is a running image in the scope that has failed its policy evaluation. If checked and a notification channel is configured, an alert will be sent. If no channel is set up, nothing will happen.</p></li><li class="step"><p> <span class="bold bold"><strong> <code class="code">Notification Channel:</code> </strong></span>Click <span class="bold bold"><strong> <code class="code">+ Add Channel </code> </strong></span>to select a configured notification channel (e.g. email) to be used for alert notifications.</p><p>If no notification channels have been defined for your Sysdig Secure environment yet, see <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Platform/pages/298582050/Set+Up+Notification+Channels" target="_blank">Set Up Notification Channels</a>.</p></li></ol></li><li class="step"><p>Click <code class="code">Save Alert.</code> </p></li></ol></div><h6 id="UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-EditanExistingAlert" class="bridgehead">Edit an Existing Alert</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, choose the <code class="code">Alerts</code> tab.</p></li><li class="step"><p>Select the desired alert from the list.</p></li><li class="step"><p>Edit the alert trigger, scope, and notification channels as necessary, and click the <code class="code">Save Alert</code> button.</p></li></ol></div><h6 id="UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23_id_id-ManageScanningAlerts-DeleteanAlert" class="bridgehead">Delete an Alert</h6><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>From the <code class="code">Image Scanning</code> module, choose the <code class="code">Alerts</code> tab.</p></li><li class="step"><p>Select the desired alert from the list.</p></li><li class="step"><p>Click the <code class="code">Delete</code> (trash can) icon and click <code class="code">Yes</code> to confirm the change.</p></li></ol></div></section><section xml:lang="en" dir="ltr" class="section original-topic lang-en original-topic" data-origin-id="UUID-20860cb0-d60b-8d6d-7b2f-1e7b3de0d639" data-publication-date="" id="UUID-daebbc6b-24fa-d149-4429-b831262d8657"><div class="titlepage"><div><div class="title"><h5 class="title">**Review Scan Results**</h5></div></div></div><p>When you have set up your build environment for scanning (if applicable), added the desired registries, and either triggered a scan manually or configured an alert to scan automatically, then an image scanning report is generated.</p><p>There are different ways to access scan results:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <span class="bold bold"><strong>Externally</strong></span> (for developers): From an <a class="link" href="https://sysdigdocs.atlassian.net/wiki/spaces/Secure/pages/340656202/Integrate+Image+Scanning+into+Development+Pipeline" target="_blank">external Continuous Integration (CI) tool</a> such as Jenkins.</p></li><li class="listitem"><p> <span class="bold bold"><strong>Internally </strong></span>(for security personnel): From the <span class="bold bold"><strong>Runtime</strong></span> tab or the <span class="bold bold"><strong>Repositories</strong></span> tab in the Image Scanning module of Sysdig Secure.</p></li></ul></div><h6 id="UUID-daebbc6b-24fa-d149-4429-b831262d8657_id_id-ReviewScanResults-RuntimeView" class="bridgehead">Runtime View</h6><p>Runtime provides an always-updated report on images that have been running in your environment over the past 1 hour.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-ef2d8de4-724a-e44d-c77a-30fb58d41566-en.png" style="max-width: 600px; " alt="343048227.png"></img></td></tr></table></div><p>In the left column, view the Entire Infrastructure or drill down to a namespace.</p><p>The report in the right column lists Unscanned and Scanned images. You can drill down for details.</p><h6 id="UUID-daebbc6b-24fa-d149-4429-b831262d8657_id_id-ReviewScanResults-UnscannedImages" class="bridgehead">Unscanned Images</h6><p>Select an unscanned image to manually trigger a scan.</p><h6 id="UUID-daebbc6b-24fa-d149-4429-b831262d8657_id_id-ReviewScanResults-ScannedImages" class="bridgehead">Scanned Images</h6><p>Select a scanned image to drill down into the details: an <code class="code">Overview</code> page, <code class="code">Policy</code> details, <code class="code">Vulnerability</code> details, and <code class="code">Content</code> violations (e.g., licenses).</p><h6 id="UUID-daebbc6b-24fa-d149-4429-b831262d8657_id_id-ReviewScanResults-SampleFailedScandetails" class="bridgehead">Sample Failed Scan details</h6><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-11669f9b-238e-42ca-175c-086859c69361-en.png" style="max-width: 600px; " alt="343277619.png"></img></td></tr></table></div><h6 id="UUID-daebbc6b-24fa-d149-4429-b831262d8657_id_id-ReviewScanResults-SamplePassedScandetails" class="bridgehead">Sample Passed Scan details</h6><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-11db582d-dff6-db35-ee9f-c381e3bb114c-en.png" style="max-width: 600px; " alt="343343176.png"></img></td></tr></table></div><h6 id="UUID-daebbc6b-24fa-d149-4429-b831262d8657_id_id-ReviewScanResults-RepositoriesView" class="bridgehead">Repositories View</h6><p>Use the Repositories list to view all scans that have ever been done, or to search for a specific image, including those that are not running.</p><div class="mediaobject"><table border="0" class="image-viewport" style="cellpadding: 0; cellspacing: 0;" width="600px"><tr><td><img src="image/uuid-8d0b0077-fb0f-ebfb-dfa7-7497140816eb-en.png" style="max-width: 600px; " alt="343375930.png"></img></td></tr></table></div><p>Once you drill down into scanned images on the list, the detail view is the same as from the Runtime panel.</p></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc">**Image Scanning and Vulnerability Management**</a></li><li><a href="#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-Contents">Contents</a></li><li><a href="#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-HowitWorks">How it Works</a></li><li><a href="#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-UseCases">Use Cases</a></li><li><a href="#UUID-49e0d87e-b86a-3b5b-5ac7-a5b3761b2bdc_id_id-ImageScanningandVulnerabilityManagement-GetStarted">Get Started</a></li><li><a href="#UUID-6a7f9bf8-5a7f-2a54-9a3b-757858129e88">**Integrate Image Scanning into Development Pipeline**</a></li><li><a href="#UUID-b5a8250f-a52c-5ab9-c6f0-ac1665dcb0da">**Manage Registry Credentials**</a></li><li><a href="#UUID-67620761-4915-e657-1b0b-aa0f82bd4333">**Scan Images**</a></li><li><a href="#UUID-3e9f9b98-0038-b891-7af6-ce37ab3e11ae">**Manage Scanning Policies**</a><ul class="nav"><li><a href="#UUID-8ca423b3-486c-bbdb-601d-dbd8e92db4fc">**Whitelist | Blacklist CVEs and Images**</a></li><li><a href="#UUID-47e6c1b9-ca84-0824-b0e0-bd2c6db8e48a">**Scanning Policy Gates and Triggers**</a></li></ul></li><li><a href="#UUID-70e84b03-5ceb-6a50-dcfa-24effc89ee23">**Manage Scanning Alerts**</a></li><li><a href="#UUID-daebbc6b-24fa-d149-4429-b831262d8657">**Review Scan Results**</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="26547-12910-empty-or-missing-topic.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="26547-12923-compliance.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> Â© 2019 Sysdig </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
